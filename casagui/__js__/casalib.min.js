"use strict";(()=>{var Qt=Object.create;var dt=Object.defineProperty;var ei=Object.getOwnPropertyDescriptor;var ti=Object.getOwnPropertyNames;var ii=Object.getPrototypeOf,ni=Object.prototype.hasOwnProperty;var ut=Math.pow;var B=(o,e)=>()=>(e||o((e={exports:{}}).exports,e),e.exports);var ri=(o,e,i,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of ti(e))!ni.call(o,n)&&n!==i&&dt(o,n,{get:()=>e[n],enumerable:!(t=ei(e,n))||t.enumerable});return o};var si=(o,e,i)=>(i=o!=null?Qt(ii(o)):{},ri(e||!o||!o.__esModule?dt(i,"default",{value:o,enumerable:!0}):i,o));var de=B(Se=>{"use strict";Object.defineProperty(Se,"__esModule",{value:!0});Se.Point2D=void 0;var De=class{getX(){return this.x}setX(e){this.x=e}getY(){return this.y}setY(e){this.y=e}setLocation(e,i){this.x=e,this.y=i}constructor(e,i){if((typeof e=="number"||e===null)&&(typeof i=="number"||i===null)){let t=arguments;this.x===void 0&&(this.x=0),this.y===void 0&&(this.y=0),this.x=e,this.y=i}else if(e===void 0&&i===void 0){let t=arguments;this.x===void 0&&(this.x=0),this.y===void 0&&(this.y=0),this.x=0,this.y=0}else throw new Error("invalid overload")}};Se.Point2D=De;De.__class="coordtxl.geom.Point2D"});var bt=B(Ae=>{"use strict";Object.defineProperty(Ae,"__esModule",{value:!0});Ae.MapKeywordProvider=void 0;var _e=class{constructor(e){this.wcsMap===void 0&&(this.wcsMap=null),this.wcsMap={};{let i=Object.keys(e);for(let t=0;t<i.length;t++){let n=i[t];if(((r,s)=>r[s]===void 0?null:r[s])(e,n)!=null&&((r,s)=>r[s]===void 0?null:r[s])(e,n)instanceof Array){let r=((a,f)=>a[f]===void 0?null:a[f])(e,n);this.wcsMap[n]=(a=>{if(a.clone!=null)return a.clone();{let f=Object.create(a);for(let l in a)a.hasOwnProperty(l)&&(f[l]=a[l]);return f}})(r);let s=1;for(let a=0;a<r.length;a++){let f=r[a];this.wcsMap[n+s]=f,s+=1}}else this.wcsMap[n]=((r,s)=>r[s]===void 0?null:r[s])(e,n)}}}findKey(e){return this.wcsMap.hasOwnProperty(e)}getStringValue$java_lang_String(e){return this.getStringValue$java_lang_String$java_lang_String(e,null)}getStringValue$java_lang_String$java_lang_String(e,i){return this.wcsMap.hasOwnProperty(e)?((t,n)=>t[n]===void 0?null:t[n])(this.wcsMap,e).toString():i}getStringValue(e,i){if((typeof e=="string"||e===null)&&(typeof i=="string"||i===null))return this.getStringValue$java_lang_String$java_lang_String(e,i);if((typeof e=="string"||e===null)&&i===void 0)return this.getStringValue$java_lang_String(e);throw new Error("invalid overload")}getDoubleValue$java_lang_String(e){return this.getDoubleValue$java_lang_String$double(e,0)}getDoubleValue$java_lang_String$double(e,i){if(!this.wcsMap.hasOwnProperty(e))return i;let t=((n,r)=>n[r]===void 0?null:n[r])(this.wcsMap,e);return typeof t=="number"?t:i}getDoubleValue(e,i){if((typeof e=="string"||e===null)&&(typeof i=="number"||i===null))return this.getDoubleValue$java_lang_String$double(e,i);if((typeof e=="string"||e===null)&&i===void 0)return this.getDoubleValue$java_lang_String(e);throw new Error("invalid overload")}getFloatValue$java_lang_String(e){return this.getFloatValue$java_lang_String$float(e,Math.fround(0))}getFloatValue$java_lang_String$float(e,i){if(!this.wcsMap.hasOwnProperty(e))return i;let t=((n,r)=>n[r]===void 0?null:n[r])(this.wcsMap,e);return typeof t=="number"?t:i}getFloatValue(e,i){if((typeof e=="string"||e===null)&&(typeof i=="number"||i===null))return this.getFloatValue$java_lang_String$float(e,i);if((typeof e=="string"||e===null)&&i===void 0)return this.getFloatValue$java_lang_String(e);throw new Error("invalid overload")}getIntValue$java_lang_String(e){return this.getIntValue$java_lang_String$int(e,0)}getIntValue$java_lang_String$int(e,i){if(!this.wcsMap.hasOwnProperty(e))return i;let t=((n,r)=>n[r]===void 0?null:n[r])(this.wcsMap,e);return typeof t=="number"?t|0:i}getIntValue(e,i){if((typeof e=="string"||e===null)&&(typeof i=="number"||i===null))return this.getIntValue$java_lang_String$int(e,i);if((typeof e=="string"||e===null)&&i===void 0)return this.getIntValue$java_lang_String(e);throw new Error("invalid overload")}toString(){let e=!1,i={str:"{ ",toString:function(){return this.str}};{let t=Object.keys(this.wcsMap);for(let n=0;n<t.length;n++){let r=t[n];{e?(a=>(a.str+=", ",a))(i):e=!0,(a=>(a.str+=r,a))(i),(a=>(a.str+="=",a))(i);let s=((a,f)=>a[f]===void 0?null:a[f])(this.wcsMap,r);if(typeof s=="string")(a=>(a.str+='"',a))(i),(a=>(a.str+=s,a))(i),(a=>(a.str+='"',a))(i);else if(s!=null&&s instanceof Array){let a=s,f="[";for(let l=0;l<a.length;++l){l!==0&&(f+=", ");let u=a[l];typeof u=="string"?f+='"'+u+'"':f+=u}f+="]",(l=>(l.str+=f,l))(i)}else(a=>(a.str+=s,a))(i)}}}return(t=>(t.str+=" }",t))(i),i.str}};Ae.MapKeywordProvider=_e;_e.__class="coordtxl.coords.MapKeywordProvider";_e.__interfaces=["coordtxl.coords.WCSKeywordProvider"]});var Mt=B(Ee=>{"use strict";Object.defineProperty(Ee,"__esModule",{value:!0});Ee.slasubs=void 0;var ai=de(),te=class{static slaDcs2c(e,i){let t=Math.cos(i),n=[0,0,0];return n[0]=Math.cos(e)*t,n[1]=Math.sin(e)*t,n[2]=Math.sin(i),n}static slaDmxv(e,i){let t,n,r,s=[0,0,0],a=[0,0,0];for(n=0;n<3;n++){for(r=0,t=0;t<3;t++)r+=e[n][t]*i[t];s[n]=r}for(n=0;n<3;n++)a[n]=s[n];return a}static slaDcc2s(e){let i,t,n,r;i=e[0],t=e[1],n=e[2],r=Math.sqrt(i*i+t*t);let s=new ai.Point2D;return s.x=r!==0?Math.atan2(t,i):0,s.y=n!==0?Math.atan2(n,r):0,s}static slaDranrm(e){let i;return i=((t,n)=>{let r=Math.abs(t%n);return isNaN(r)||r==n||r<=Math.abs(n)/2?r:(t>0?1:-1)*(r-n)})(e,te.D2PI),i>=0?i:i+te.D2PI}static slaDeuler(e,i,t,n){let r,s,a,f,l,u=function(m){let D=function(v){if(v.length===0)return 0;{let S=[];for(let I=0;I<v[0];I++)S.push(D(v.slice(1)));return S}};return D(m)}([3,3]),c=function(m){let D=function(v){if(v.length===0)return 0;{let S=[];for(let I=0;I<v[0];I++)S.push(D(v.slice(1)));return S}};return D(m)}([3,3]),h,g,d,_,x=function(m){let D=function(v){if(v.length===0)return 0;{let S=[];for(let I=0;I<v[0];I++)S.push(D(v.slice(1)));return S}};return D(m)}([3,3]),y;for(r=0;r<3;r++)for(s=0;s<3;s++)u[s][r]=s===r?1:0;for(a=e.length,f=0;f<3;f++)if(f<=a){for(r=0;r<3;r++)for(s=0;s<3;s++)c[s][r]=s===r?1:0;switch(f){case 0:default:h=i;break;case 1:h=t;break;case 2:h=n;break}for(g=Math.sin(h),d=Math.cos(h),y=e.charAt(f),(m=>m.charCodeAt==null?m:m.charCodeAt(0))(y)=="X".charCodeAt(0)||(m=>m.charCodeAt==null?m:m.charCodeAt(0))(y)=="x".charCodeAt(0)||(m=>m.charCodeAt==null?m:m.charCodeAt(0))(y)=="1".charCodeAt(0)?(c[1][1]=d,c[1][2]=g,c[2][1]=-g,c[2][2]=d):(m=>m.charCodeAt==null?m:m.charCodeAt(0))(y)=="Y".charCodeAt(0)||(m=>m.charCodeAt==null?m:m.charCodeAt(0))(y)=="y".charCodeAt(0)||(m=>m.charCodeAt==null?m:m.charCodeAt(0))(y)=="2".charCodeAt(0)?(c[0][0]=d,c[0][2]=-g,c[2][0]=g,c[2][2]=d):(m=>m.charCodeAt==null?m:m.charCodeAt(0))(y)=="Z".charCodeAt(0)||(m=>m.charCodeAt==null?m:m.charCodeAt(0))(y)=="z".charCodeAt(0)||(m=>m.charCodeAt==null?m:m.charCodeAt(0))(y)=="3".charCodeAt(0)?(c[0][0]=d,c[0][1]=g,c[1][0]=-g,c[1][1]=d):a=0,s=0;s<3;s++)for(r=0;r<3;r++){for(_=0,l=0;l<3;l++)_+=c[s][l]*u[l][r];x[s][r]=_}for(r=0;r<3;r++)for(s=0;s<3;s++)u[s][r]=x[s][r]}return u}static slDE2H(e,i,t){let n=[0,0],r=Math.sin(e),s=Math.cos(e),a=Math.sin(i),f=Math.cos(i),l=Math.sin(t),u=Math.cos(t),c=-s*f*l+a*u,h=-r*f,g=s*f*u+a*l,d=Math.sqrt(c*c+h*h),_;return d===0?_=0:_=Math.atan2(h,c),_<0&&(_=_+2*Math.PI),n[0]=_,n[1]=Math.atan2(g,d),n}static slDVTP(e,i){let t,n=e[0],r=e[1],s=e[2],a=i[0],f=i[1],l=i[2],u=a*a+f*f,c=Math.sqrt(u);c===0&&(c=1e-20,a=c);let h=n*a+r*f,g=h+s*l;g>te.TINY?t=0:g>=0?(t=1,g=te.TINY):g>-te.TINY?(t=2,g=-te.TINY):t=3,g=g*c;let d=(r*a-n*f)/g,_=(s*u-l*h)/g;return t!==0&&console.info("ERROR: From slDVTP, J = "+t),[d,_]}};Ee.slasubs=te;te.TINY=1e-6;te.D2PI=6.283185307179586;te.__class="coordtxl.coords.slasubs"});var vt=B(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});je.wcscon=void 0;var z=de(),b=class{static a_$LI$(){return b.a==null&&(b.a=[-162557e-11,-31919e-11,-13843e-11]),b.a}static ad_$LI$(){return b.ad==null&&(b.ad=[.001245,-.00158,-659e-6]),b.ad}static emi_$LI$(){return b.emi==null&&(b.emi=[[.99992567949991,-.011181482788805,-.004859004008828,-.000541640798032,-.237963047085011,.436218238658637],[.011181482840782,.999937484898031,-27155744957e-15,.237912530551179,-.00266070648897,-.008537588719453],[.004859003889183,-27177143501e-15,.999988194601879,-.436101961325347,.012258830424865,.002119065556992],[-2423898405e-15,27105439e-15,11777422e-15,.999904322043106,-.011181451601069,-.004858519608686],[-27105439e-15,-2423927017e-15,65851e-15,.011181451608968,.999916125340107,-27162614355e-15],[-11777422e-15,65846e-15,-2424049954e-15,.004858519590501,-27165866691e-15,.999966838131419]]),b.emi}static fk524(e){let i=new z.Point2D(0,0);return b.fk524m(e,i)}static fk524e(e,i){let t=new z.Point2D(0,0),n=b.fk524m(e,t);return n.x=n.x+t.x*(i-1950),n.y=n.y+t.y*(i-1950),n}static fk524m(e,i){let t,n,r,s,a,f,l,u,c,h,g,d,_,x,y,m,D,v,S=[0,0,0,0,0,0],I=[0,0,0,0,0,0],$,W,O,C,E,V,P,p,M=6.283185307179586,A,k=1e-30,j=0;for(A=100*60*60*360/M,t=T.WCSTransform.degrad(e.x),n=T.WCSTransform.degrad(e.y),r=T.WCSTransform.degrad(i.x),s=T.WCSTransform.degrad(i.y),c=r*A,h=s*A,g=Math.sin(t),d=Math.cos(t),_=Math.sin(n),x=Math.cos(n),y=d*x,m=g*x,D=_,S[0]=y,S[1]=m,S[2]=D,c!==j||h!==j?(S[3]=-(c*m)-d*_*h,S[4]=c*y-g*_*h,S[5]=x*h):(S[3]=j,S[4]=j,S[5]=j),P=0;P<6;P++){for(v=j,p=0;p<6;p++)v=v+b.emi_$LI$()[p][P]*S[p];I[P]=v}return y=I[0],m=I[1],D=I[2],$=I[3],W=I[4],O=I[5],C=Math.sqrt(y*y+m*m+D*D),y=y+b.a_$LI$()[0]*C,m=m+b.a_$LI$()[1]*C,D=D+b.a_$LI$()[2]*C,$=$+b.ad_$LI$()[0]*C,W=W+b.ad_$LI$()[1]*C,O=O+b.ad_$LI$()[2]*C,E=y*y+m*m,V=Math.sqrt(E),y===j&&m===j?a=j:(a=Math.atan2(m,y),a<j&&(a=a+M)),f=Math.atan2(D,V),V>k&&(c=(y*W-m*$)/E,h=(O*E-D*(y*$+m*W))/((E+D*D)*V)),l=c/A,u=h/A,e.x=T.WCSTransform.raddeg(a),e.y=T.WCSTransform.raddeg(f),i.x=T.WCSTransform.raddeg(l),i.y=T.WCSTransform.raddeg(u),e}static em_$LI$(){return b.em==null&&(b.em=[[.999925678186902,.011182059571766,.004857946721186,-.000541652366951,.237917612131583,-.43611127603927],[-.011182059642247,.999937478448132,-27147426498e-15,-.237968129744288,-.002660763319071,.012259092261564],[-.00485794655896,-27176441185e-15,.99998819973877,.436227555856097,-.008537771074048,.002119110818172],[2423950176e-15,27106627e-15,11776559e-15,.999947035154614,.011182506007242,.00485766994865],[-27106627e-15,2423978783e-15,-65816e-15,-.011182506121805,.999958833818833,-27137309539e-15],[-11776558e-15,-65874e-15,2424101735e-15,-.004857669684959,-27184471371e-15,1.000009560363559]]),b.em}static fk425(e){let i=new z.Point2D(0,0);return b.fk425m(e,i)}static fk425e(e,i){let t=new z.Point2D(0,0),n=b.fk425m(e,t);return n.x=n.x+t.x*(i-2e3),n.y=n.y+t.y*(i-2e3),n}static fk425m(e,i){let t,n,r,s,a,f,l,u,c,h,g,d,_,x,y,m,D,v,S,I,$,W,O,C,E,V,P,p,M=[0,0,0],A=[0,0,0],k=[0,0,0,0,0,0],j=[0,0,0,0,0,0],L=6.283185307179586,R,ie=1e-30,ee=0;for(R=100*60*60*360/L,t=T.WCSTransform.degrad(e.x),n=T.WCSTransform.degrad(e.y),r=T.WCSTransform.degrad(i.x),s=T.WCSTransform.degrad(i.y),c=r*R,h=s*R,g=Math.sin(t),d=Math.cos(t),_=Math.sin(n),x=Math.cos(n),M[0]=d*x,M[1]=g*x,M[2]=_,A[0]=-g*x*c-d*_*h,A[1]=d*x*c-g*_*h,A[2]=x*h,y=M[0]*b.a_$LI$()[0]+M[1]*b.a_$LI$()[1]+M[2]*b.a_$LI$()[2],m=M[0]*b.ad_$LI$()[0]+M[1]*b.ad_$LI$()[1]+M[2]*b.ad_$LI$()[2],P=0;P<3;P++)k[P]=M[P]-b.a_$LI$()[P]+y*M[P],k[P+3]=A[P]-b.ad_$LI$()[P]+m*M[P];for(P=0;P<6;P++){for(y=ee,p=0;p<6;p++)y=y+b.em_$LI$()[p][P]*k[p];j[P]=y}return D=j[0],v=j[1],S=j[2],I=j[3],$=j[4],W=j[5],O=D*D+v*v,C=O+S*S,E=Math.sqrt(O),V=D*I+v*$,D===ee&&v===ee?a=ee:(a=Math.atan2(v,D),a<ee&&(a=a+L)),f=Math.atan2(S,E),E>ie&&(c=(D*$-v*I)/O,h=(W*O-S*V)/(C*E)),l=c/R,u=h/R,e.x=T.WCSTransform.raddeg(a),e.y=T.WCSTransform.raddeg(f),i.x=T.WCSTransform.raddeg(l),i.y=T.WCSTransform.raddeg(u),e}static bgal_$LI$(){return b.bgal==null&&(b.bgal=[[-.066988739415,-.872755765852,-.483538914632],[.492728466075,-.45034695802,.744584633283],[-.867600811151,-.188374601723,.460199784784]]),b.bgal}static fk42gal(e){let i=[0,0,0],t=[0,0,0],n,r,s,a,f,l,u;f=e.x,l=e.y,s=T.WCSTransform.degrad(f),a=T.WCSTransform.degrad(l);let c=new z.Point2D,h=new z.Point2D;for(b.jpcop(s,a,1,c,h),i[0]=c.x,i[1]=c.y,i[2]=h.x,u=0;u<3;u++)t[u]=i[0]*b.bgal_$LI$()[u][0]+i[1]*b.bgal_$LI$()[u][1]+i[2]*b.bgal_$LI$()[u][2];let g=new z.Point2D,d=new z.Point2D;return b.jpcon(t,g,d),n=T.WCSTransform.raddeg(g.x),r=T.WCSTransform.raddeg(g.y),e.x=n,e.y=r,b.idg>0,e}static gal2fk4(e){let i=[0,0,0],t=[0,0,0],n,r,s,a,f,l,u;n=e.x,r=e.y,s=T.WCSTransform.degrad(n),a=T.WCSTransform.degrad(r);let c=new z.Point2D,h=new z.Point2D;for(b.jpcop(s,a,1,c,h),i[0]=c.x,i[1]=c.y,i[2]=h.x,u=0;u<3;u++)t[u]=i[0]*b.bgal_$LI$()[0][u]+i[1]*b.bgal_$LI$()[1][u]+i[2]*b.bgal_$LI$()[2][u];let g=new z.Point2D,d=new z.Point2D;return b.jpcon(t,g,d),f=T.WCSTransform.raddeg(g.x),l=T.WCSTransform.raddeg(g.y),e.x=f,e.y=l,b.idg>0,e}static jgal_$LI$(){return b.jgal==null&&(b.jgal=[[-.054875539726,-.87343710801,-.483834985808],[.494109453312,-.444829589425,.74698225181],[-.867666135858,-.198076386122,.455983795705]]),b.jgal}static fk52gal(e){let i=[0,0,0],t=[0,0,0],n,r,s,a,f,l,u;f=e.x,l=e.y,s=T.WCSTransform.degrad(f),a=T.WCSTransform.degrad(l);let c=new z.Point2D,h=new z.Point2D;for(b.jpcop(s,a,1,c,h),i[0]=c.x,i[1]=c.y,i[2]=h.x,u=0;u<3;u++)t[u]=i[0]*b.jgal_$LI$()[u][0]+i[1]*b.jgal_$LI$()[u][1]+i[2]*b.jgal_$LI$()[u][2];let g=new z.Point2D,d=new z.Point2D;return b.jpcon(t,g,d),n=T.WCSTransform.raddeg(g.x),r=T.WCSTransform.raddeg(g.y),e.x=n,e.y=r,b.idg>0,e}static gal2fk5(e){let i=[0,0,0],t=[0,0,0],n,r,s,a,f,l,u;n=e.x,r=e.y,s=T.WCSTransform.degrad(n),a=T.WCSTransform.degrad(r);let c=new z.Point2D,h=new z.Point2D;for(b.jpcop(s,a,1,c,h),i[0]=c.x,i[1]=c.y,i[2]=h.x,u=0;u<3;u++)t[u]=i[0]*b.jgal_$LI$()[0][u]+i[1]*b.jgal_$LI$()[1][u]+i[2]*b.jgal_$LI$()[2][u];let g=new z.Point2D,d=new z.Point2D;return b.jpcon(t,g,d),f=T.WCSTransform.raddeg(g.x),l=T.WCSTransform.raddeg(g.y),e.x=f,e.y=l,b.idg>0,e}static jpcon(e,i,t){let n,r,s,a,f,l;n=e[0],r=e[1],s=e[2],i.x=Math.atan2(r,n),i.x<0&&(i.x=i.x+6.283185307179586),f=n*n+r*r,a=Math.sqrt(f),i.y=Math.atan2(s,a),l=s*s,t.x=Math.sqrt(f+l)}static jpcop(e,i,t,n,r){n.x=t*Math.cos(e)*Math.cos(i),n.y=t*Math.sin(e)*Math.cos(i),r.x=t*Math.sin(i)}static fk4prec(e,i,t){let n=T.WCSTransform.degrad(t.x),r=T.WCSTransform.degrad(t.y),s=b.mprecfk4(e,i),a=re.slasubs.slaDcs2c(n,r),f=re.slasubs.slaDmxv(s,a),l=re.slasubs.slaDcc2s(f);return n=l.x,r=l.y,n=re.slasubs.slaDranrm(n),t.x=T.WCSTransform.raddeg(n),t.y=T.WCSTransform.raddeg(r),t}static fk5prec(e,i,t){let n=T.WCSTransform.degrad(t.x),r=T.WCSTransform.degrad(t.y),s=b.mprecfk5(e,i),a=re.slasubs.slaDcs2c(n,r),f=re.slasubs.slaDmxv(s,a),l=re.slasubs.slaDcc2s(f);return n=l.x,r=l.y,n=re.slasubs.slaDranrm(n),t.x=T.WCSTransform.raddeg(n),t.y=T.WCSTransform.raddeg(r),t}static mprecfk4(e,i){let t,n,r,s,a,f,l;return t=(e-1850)/100,n=(i-e)/100,r=n*b.DAS2R,s=2303.5548+(1.3972+59e-6*t)*t,a=(s+(.30242-269e-6*t+.017996*n)*n)*r,f=(s+(1.09478+387e-6*t+.018324*n)*n)*r,l=(2005.1125+(-.85294-365e-6*t)*t+(-.42647-365e-6*t-.041802*n)*n)*r,re.slasubs.slaDeuler("ZYZ",-a,l,-f)}static mprecfk5(e,i){let t,n,r,s,a,f,l;return t=(e-2e3)/100,n=(i-e)/100,r=n*b.DAS2R,s=2306.2181+(1.39656-139e-6*t)*t,a=(s+(.30188-344e-6*t+.017998*n)*n)*r,f=(s+(1.09468+66e-6*t+.018203*n)*n)*r,l=(2004.3109+(-.8533-217e-6*t)*t+(-.42665-217e-6*t-.041833*n)*n)*r,re.slasubs.slaDeuler("ZYZ",-a,l,-f)}};je.wcscon=b;b.idg=0;b.DAS2R=484813681109536e-20;b.__class="coordtxl.coords.wcscon";var re=Mt(),T=$e()});var Ct=B(Ie=>{"use strict";Object.defineProperty(Ie,"__esModule",{value:!0});Ie.worldpos=void 0;var Be=de(),Pe=class{static getPosition(e,i,t){let n,r,s,a,f,l,u,c,h=0,g=0,d,_,x,y,m,D,v,S,I,$,W,O,C,E,V,P=.01745329252,p=6.28318530717959,M=1e-5,A,k,j,L,R,ie,ee,Me=t.pcode,ce,ve;if(A=t.xref,k=t.yref,j=t.xrefpix,L=t.yrefpix,R=t.xinc,ie=t.yinc,ee=w.WCSTransform.degrad(t.rot),n=Math.cos(ee),r=Math.sin(ee),s=e-j,a=i-L,t.rotmat>0)l=s*t.cd11+a*t.cd12,a=s*t.cd21+a*t.cd22,s=l;else{if(R===0||ie===0)return null;s=s*R,a=a*ie,ee!==0&&(l=s*n-a*r,a=s*r+a*n,s=l)}if(ce=A+s,ve=k+a,Me<0)return new Be.Point2D(ce,ve);switch(t.coorflip>0?(I=w.WCSTransform.degrad(A),$=w.WCSTransform.degrad(k),l=s,s=a,a=l):($=w.WCSTransform.degrad(A),I=w.WCSTransform.degrad(k)),_=w.WCSTransform.degrad(s),x=w.WCSTransform.degrad(a),u=_*_+x*x,v=Math.cos(I),S=Math.sin(I),Me){case-1:case 0:g=$+_,h=I+x;break;case 1:if(c=Math.sqrt(1-u),d=S*c+v*x,d>1||d<-1||(h=Math.asin(d),g=v*c-S*x,g===0&&_===0))return null;g=Math.atan2(_,g)+$;break;case 2:if(h=v-x*S,h===0)return null;g=$+Math.atan2(_,h),h=Math.atan(Math.cos(g-$)*(x*v+S)/h);break;case 3:if(u>=p*p/4||(u=Math.sqrt(u),c=Math.cos(u),u!==0?u=Math.sin(u)/u:u=1,d=x*v*u+S*c,d>1||d<-1)||(h=Math.asin(d),m=c-d*S,d=_*u*v,m===0&&d===0))return null;g=$+Math.atan2(d,m);break;case 4:if(h=v-x*S,h===0||(g=$+Math.atan2(_,h),d=Math.cos(g-$),d===0)||(h=h/d,h>1||h<-1))return null;h=Math.acos(h),I<0&&(h=-h);break;case 5:if(h=I+x,Math.abs(h)>p/4||(c=Math.cos(h),Math.abs(_)>p*c/2))return null;g=$,c>M&&(g=g+_/c);break;case 6:if(d=ie*n+R*r,d===0&&(d=1),a=w.WCSTransform.degrad(k/2+45),s=a+d/2*P,a=Math.log(Math.tan(a)),s=Math.log(Math.tan(s)),E=w.WCSTransform.degrad(d)/(s-a),V=E*a,C=Math.cos(w.WCSTransform.degrad(k)),C<=0&&(C=1),g=_/C+$,Math.abs(g-$)>p)return null;d=0,E!==0&&(d=(x+V)/E),d=Math.exp(d),h=2*Math.atan(d)-p/4;break;case 7:if(d=ie*n+R*r,d===0&&(d=1),d=w.WCSTransform.degrad(d),a=w.WCSTransform.degrad(k),s=Math.sin(a+d)/Math.sqrt((1+Math.cos(a+d))/2)-Math.sin(a)/Math.sqrt((1+Math.cos(a))/2),s===0&&(s=1),E=d/s,d=R*n-ie*r,d===0&&(d=1),d=w.WCSTransform.degrad(d),s=2*Math.cos(a)*Math.sin(d/2),s===0&&(s=1),C=d*Math.sqrt((1+Math.cos(a)*Math.cos(d/2))/2)/s,V=E*Math.sin(a)/Math.sqrt((1+Math.cos(a))/2),g=$,h=I,_===0&&x===0)break;if(f=4-_*_/(4*C*C)-(x+V)/E*((x+V)/E),f>4||f<2||(f=.5*Math.sqrt(f),D=(x+V)*f/E,Math.abs(D)>1)||(D=Math.asin(D),Math.abs(Math.cos(D))<M)||(m=_*f/(2*C*Math.cos(D)),Math.abs(m)>1))return null;m=Math.asin(m),g=$+2*m,h=D;break;case 8:if(f=(4-u)/(4+u),Math.abs(f)>1||(h=f*S+x*v*(1+f)/2,Math.abs(h)>1)||(h=Math.asin(h),g=Math.cos(h),Math.abs(g)<M)||(g=_*(1+f)/(2*g),Math.abs(g)>1)||(g=Math.asin(g),y=1+Math.sin(h)*S+Math.cos(h)*v*Math.cos(g),Math.abs(y)<M))return null;y=2*(Math.sin(h)*v-Math.cos(h)*S*Math.cos(g))/y,Math.abs(y-x)>M&&(g=p/2-g),g=$+g;break}return O=g,W=h,O-$>p/2&&(O=O-p),O-$<-p/2&&(O=O+p),O<0&&(O+=p),ce=w.WCSTransform.raddeg(O),ve=w.WCSTransform.raddeg(W),new Be.Point2D(ce,ve)}static getPixels(e,i,t){let n,r,s=0,a=0,f=0,l=0,u=0,c=0,h,g,d,_=0,x=0,y=0,m,D,v,S,I,$,W=.01745329252,O=1e-5,C=6.28318530717959,E,V,P,p,M,A,k,j;switch(E=t.xref,V=t.yref,P=t.xrefpix,p=t.yrefpix,M=t.xinc,A=t.yinc,k=w.WCSTransform.degrad(t.rot),I=Math.cos(k),S=Math.sin(k),j=t.pcode,j>0&&j<9&&(t.coorflip>0?(a=w.WCSTransform.degrad(E),s=w.WCSTransform.degrad(V),h=e-V):(s=w.WCSTransform.degrad(E),a=w.WCSTransform.degrad(V),h=e-E),j>=0&&(h>180&&(e-=360),h<-180&&(e+=360)),f=w.WCSTransform.degrad(e),l=w.WCSTransform.degrad(i),u=Math.cos(l),c=Math.sin(l),x=Math.sin(f-s)*u,_=c*Math.sin(a)+u*Math.cos(a)*Math.cos(f-s)),j){case 1:if(_<0)return null;y=c*Math.cos(a)-u*Math.sin(a)*Math.cos(f-s);break;case 2:if(_<=0)return null;y=c*Math.sin(a)+u*Math.cos(a)*Math.cos(f-s),x=x/y,y=(c*Math.cos(a)-u*Math.sin(a)*Math.cos(f-s))/y;break;case 3:y=c*Math.sin(a)+u*Math.cos(a)*Math.cos(f-s),y<-1&&(y=-1),y>1&&(y=1),y=Math.acos(y),y!==0?y=y/Math.sin(y):y=1,x=x*y,y=(c*Math.cos(a)-u*Math.sin(a)*Math.cos(f-s))*y;break;case 4:if(a===0)return null;y=(Math.cos(a)-u*Math.cos(f-s))/Math.sin(a);break;case 5:if(h=f-s,Math.abs(l)>C/4||Math.abs(a)>C/4)return null;y=l-a,x=h*u;break;case 6:if(h=A*I+M*S,h===0&&(h=1),r=w.WCSTransform.degrad(V/2+45),n=r+h/2*W,r=Math.log(Math.tan(r)),n=Math.log(Math.tan(n)),D=w.WCSTransform.degrad(h)/(n-r),v=D*r,m=Math.cos(w.WCSTransform.degrad(V)),m<=0&&(m=1),h=f-s,x=m*h,h=l/2+C/8,h=Math.tan(h),h<O)return null;y=D*Math.log(h)-v;break;case 7:if(g=(f-s)/2,Math.abs(g)>C/4||(h=A*I+M*S,h===0&&(h=1),h=w.WCSTransform.degrad(h),r=w.WCSTransform.degrad(V),n=Math.sin(r+h)/Math.sqrt((1+Math.cos(r+h))/2)-Math.sin(r)/Math.sqrt((1+Math.cos(r))/2),n===0&&(n=1),D=h/n,h=M*I-A*S,h===0&&(h=1),h=w.WCSTransform.degrad(h),n=2*Math.cos(r)*Math.sin(h/2),n===0&&(n=1),m=h*Math.sqrt((1+Math.cos(r)*Math.cos(h/2))/2)/n,v=D*Math.sin(r)/Math.sqrt((1+Math.cos(r))/2),h=Math.sqrt((1+Math.cos(l)*Math.cos(g))/2),Math.abs(h)<O))return null;x=2*m*Math.cos(l)*Math.sin(g)/h,y=D*Math.sin(l)/h-v;break;case 8:if(g=f-s,Math.abs(l)>C/4||(d=1+c*Math.sin(a)+u*Math.cos(a)*Math.cos(g),Math.abs(d)<O))return null;d=2/d,x=x*d,y=d*(c*Math.cos(a)-u*Math.sin(a)*Math.cos(g));break}j>0&&j<9?(n=w.WCSTransform.raddeg(x),r=w.WCSTransform.raddeg(y)):(n=e-E,r=i-V),t.coorflip>0&&($=n,n=r,r=$),t.rotmat>0?($=n*t.dc11+r*t.dc12,r=n*t.dc21+r*t.dc22,n=$):(k!==0&&($=n*I+r*S,r=r*I-n*S,n=$),M!==0&&(n=n/M),A!==0&&(r=r/A));let L=n+P,R=r+p;return new Be.Point2D(L,R)}};Ie.worldpos=Pe;Pe.__class="coordtxl.coords.worldpos";var w=$e()});var St=B(Te=>{"use strict";Object.defineProperty(Te,"__esModule",{value:!0});Te.platepos=void 0;var Dt=de(),K=class{static getPosition(e,i,t){let n,r,s,a,f,l,u,c,h,g,d,_,x,y,m,D,v,S;return n=e+t.x_pixel_offset-1+.5,r=i+t.y_pixel_offset-1+.5,s=(t.ppo_coeff[2]-n*t.x_pixel_size)/1e3,a=(r*t.y_pixel_size-t.ppo_coeff[5])/1e3,f=s*s,l=a*a,u=s*f,c=a*l,h=f+l,g=t.amd_x_coeff[0]*s+t.amd_x_coeff[1]*a+t.amd_x_coeff[2]+t.amd_x_coeff[3]*f+t.amd_x_coeff[4]*s*a+t.amd_x_coeff[5]*l+t.amd_x_coeff[6]*h+t.amd_x_coeff[7]*u+t.amd_x_coeff[8]*f*a+t.amd_x_coeff[9]*s*l+t.amd_x_coeff[10]*c+t.amd_x_coeff[11]*s*h+t.amd_x_coeff[12]*s*h*h,_=t.amd_y_coeff[0]*a+t.amd_y_coeff[1]*s+t.amd_y_coeff[2]+t.amd_y_coeff[3]*l+t.amd_y_coeff[4]*s*a+t.amd_y_coeff[5]*f+t.amd_y_coeff[6]*h+t.amd_y_coeff[7]*c+t.amd_y_coeff[8]*l*s+t.amd_y_coeff[9]*a*f+t.amd_y_coeff[10]*u+t.amd_y_coeff[11]*a*h+t.amd_y_coeff[12]*a*h*h,d=g/K.CONS2R,x=_/K.CONS2R,v=Math.tan(t.plate_dec),S=Math.cos(t.plate_dec),y=Math.atan2(d/S,1-x*v),m=y+t.plate_ra,m<0&&(m=m+K.TWOPI),D=Math.atan(Math.cos(y)/((1-x*v)/(x+v))),new Dt.Point2D(m/K.COND2R,D/K.COND2R)}static getPixels(e,i,t){let n,r,s,a,f,l,u,c,h,g,d,_,x,y,m,D,v,S,I,$,W,O,C,E,V,P,p,M,A,k,j,L,R,ie,ee;for(ie=e*K.COND2R,ee=i*K.COND2R,I=Math.sin(ee),$=Math.cos(ee),W=Math.sin(t.plate_dec),O=Math.cos(t.plate_dec),C=Math.sin(ie-t.plate_ra),E=Math.cos(ie-t.plate_ra),n=I*W+$*O*E,r=$*C*K.CONR2S/n,s=(I*O-$*W*E)*K.CONR2S/n,j=r/t.plate_scale,L=s/t.plate_scale,R=0;R<K.MAX_ITERATIONS&&(l=j*L,u=j*j,c=L*L,h=u*L,g=c*j,m=u+c,D=m*m,d=u*j,_=c*L,x=u*u,y=c*c,V=t.amd_x_coeff[0]*j+t.amd_x_coeff[1]*L+t.amd_x_coeff[2]+t.amd_x_coeff[3]*u+t.amd_x_coeff[4]*l+t.amd_x_coeff[5]*c+t.amd_x_coeff[6]*m+t.amd_x_coeff[7]*d+t.amd_x_coeff[8]*h+t.amd_x_coeff[9]*g+t.amd_x_coeff[10]*_+t.amd_x_coeff[11]*j*m+t.amd_x_coeff[12]*j*D,P=t.amd_x_coeff[0]+t.amd_x_coeff[3]*2*j+t.amd_x_coeff[4]*L+t.amd_x_coeff[6]*2*j+t.amd_x_coeff[7]*3*u+t.amd_x_coeff[8]*2*l+t.amd_x_coeff[9]*c+t.amd_x_coeff[11]*(3*u+c)+t.amd_x_coeff[12]*(5*x+6*u*c+y),p=t.amd_x_coeff[1]+t.amd_x_coeff[4]*j+t.amd_x_coeff[5]*2*L+t.amd_x_coeff[6]*2*L+t.amd_x_coeff[8]*u+t.amd_x_coeff[9]*2*l+t.amd_x_coeff[10]*3*c+t.amd_x_coeff[11]*2*l+t.amd_x_coeff[12]*4*l*m,M=t.amd_y_coeff[0]*L+t.amd_y_coeff[1]*j+t.amd_y_coeff[2]+t.amd_y_coeff[3]*c+t.amd_y_coeff[4]*l+t.amd_y_coeff[5]*u+t.amd_y_coeff[6]*m+t.amd_y_coeff[7]*_+t.amd_y_coeff[8]*g+t.amd_y_coeff[9]*h+t.amd_y_coeff[10]*d+t.amd_y_coeff[11]*L*m+t.amd_y_coeff[12]*L*D,A=t.amd_y_coeff[1]+t.amd_y_coeff[4]*L+t.amd_y_coeff[5]*2*j+t.amd_y_coeff[6]*2*j+t.amd_y_coeff[8]*c+t.amd_y_coeff[9]*2*l+t.amd_y_coeff[10]*3*u+t.amd_y_coeff[11]*2*l+t.amd_y_coeff[12]*4*l*m,k=t.amd_y_coeff[0]+t.amd_y_coeff[3]*2*L+t.amd_y_coeff[4]*j+t.amd_y_coeff[6]*2*L+t.amd_y_coeff[7]*3*c+t.amd_y_coeff[8]*2*l+t.amd_y_coeff[9]*u+t.amd_y_coeff[11]*(u+3*c)+t.amd_y_coeff[12]*(5*y+6*u*c+x),V=V-r,M=M-s,v=(-V*k+M*p)/(P*k-p*A),S=(-M*P+V*A)/(P*k-p*A),j=j+v,L=L+S,!(Math.abs(v)<K.TOLERANCE&&Math.abs(S)<K.TOLERANCE));R++);a=(t.ppo_coeff[2]-j*1e3)/t.x_pixel_size,f=(t.ppo_coeff[5]+L*1e3)/t.y_pixel_size;let Me=a-t.x_pixel_offset+1-.5,ce=f-t.y_pixel_offset+1-.5;return new Dt.Point2D(Me,ce)}};Te.platepos=K;K.COND2R=.01745329252;K.CONS2R=206264.8062470964;K.TWOPI=6.28318530717959;K.MAX_ITERATIONS=50;K.TOLERANCE=5e-7;K.CONR2S=206264.8062470964;K.__class="coordtxl.coords.platepos"});var $e=B(Ve=>{"use strict";Object.defineProperty(Ve,"__esModule",{value:!0});Ve.WCSTransform=void 0;var Oe=de(),N=class{static degrad(e){return e*Math.PI/180}static raddeg(e){return e*180/Math.PI}static hrdeg(e){return e*15}static deghr(e){return e/15}static hrrad(e){return N.degrad(N.hrdeg(e))}static radhr(e){return N.deghr(N.raddeg(e))}constructor(e,i,t,n,r,s,a,f,l,u,c,h){if((typeof e=="number"||e===null)&&(typeof i=="number"||i===null)&&(typeof t=="number"||t===null)&&(typeof n=="number"||n===null)&&(typeof r=="number"||r===null)&&(typeof s=="number"||s===null)&&(typeof a=="number"||a===null)&&(typeof f=="number"||f===null)&&(typeof l=="number"||l===null)&&(typeof u=="number"||u===null)&&(typeof c=="number"||c===null)&&(typeof h=="string"||h===null)){let g=arguments;this.xref===void 0&&(this.xref=0),this.yref===void 0&&(this.yref=0),this.xrefpix===void 0&&(this.xrefpix=0),this.yrefpix===void 0&&(this.yrefpix=0),this.xinc===void 0&&(this.xinc=0),this.yinc===void 0&&(this.yinc=0),this.rot===void 0&&(this.rot=0),this.crot===void 0&&(this.crot=0),this.srot===void 0&&(this.srot=0),this.cd11===void 0&&(this.cd11=0),this.cd12===void 0&&(this.cd12=0),this.cd21===void 0&&(this.cd21=0),this.cd22===void 0&&(this.cd22=0),this.dc11===void 0&&(this.dc11=0),this.dc12===void 0&&(this.dc12=0),this.dc21===void 0&&(this.dc21=0),this.dc22===void 0&&(this.dc22=0),this.mrot===void 0&&(this.mrot=0),this.cmrot===void 0&&(this.cmrot=0),this.smrot===void 0&&(this.smrot=0),this.xmpix===void 0&&(this.xmpix=0),this.ympix===void 0&&(this.ympix=0),this.equinox===void 0&&(this.equinox=0),this.epoch===void 0&&(this.epoch=0),this.nxpix===void 0&&(this.nxpix=0),this.nypix===void 0&&(this.nypix=0),this.plate_ra===void 0&&(this.plate_ra=0),this.plate_dec===void 0&&(this.plate_dec=0),this.plate_scale===void 0&&(this.plate_scale=0),this.x_pixel_offset===void 0&&(this.x_pixel_offset=0),this.y_pixel_offset===void 0&&(this.y_pixel_offset=0),this.x_pixel_size===void 0&&(this.x_pixel_size=0),this.y_pixel_size===void 0&&(this.y_pixel_size=0),this.xpix===void 0&&(this.xpix=0),this.ypix===void 0&&(this.ypix=0),this.xpos===void 0&&(this.xpos=0),this.ypos===void 0&&(this.ypos=0),this.pcode===void 0&&(this.pcode=0),this.changesys===void 0&&(this.changesys=0),this.printsys===void 0&&(this.printsys=0),this.ndec===void 0&&(this.ndec=0),this.degout===void 0&&(this.degout=0),this.tabsys===void 0&&(this.tabsys=0),this.rotmat===void 0&&(this.rotmat=0),this.coorflip===void 0&&(this.coorflip=0),this.offscl===void 0&&(this.offscl=0),this.plate_fit===void 0&&(this.plate_fit=0),this.wcson===void 0&&(this.wcson=0),this.detector===void 0&&(this.detector=0),this.fCenterRa===void 0&&(this.fCenterRa=0),this.fCenterDec===void 0&&(this.fCenterDec=0),this.fHalfWidthRa===void 0&&(this.fHalfWidthRa=0),this.fHalfWidthDec===void 0&&(this.fHalfWidthDec=0),this.fWidthDeg===void 0&&(this.fWidthDeg=0),this.fHeightDeg===void 0&&(this.fHeightDeg=0),this.degPerPixel===void 0&&(this.degPerPixel=null),this.ppo_coeff=[0,0,0,0,0,0],this.amd_x_coeff=(d=>{let _=[];for(;d-- >0;)_.push(0);return _})(20),this.amd_y_coeff=(d=>{let _=[];for(;d-- >0;)_.push(0);return _})(20),this.instrument="",this.c1type="",this.c2type="",this.ctypes=["-SIN","-TAN","-ARC","-NCP","-GLS","-MER","-AIT","-STG"],this.ptype="",this.radecsys="",this.sysout="",this.center="",this.plate_fit=0,this.nxpix=a,this.nypix=f,this.xinc=t/3600,this.yinc=n/3600,this.xrefpix=r,this.yrefpix=s,this.xref=e,this.yref=i,this.c1type="RA-",this.c2type="DEC",this.ptype=h,this.pcode=1,this.coorflip=0,this.rot=l,this.rotmat=0,this.cd11=0,this.cd21=0,this.cd12=0,this.cd22=0,this.dc11=0,this.dc21=0,this.dc12=0,this.dc22=0,this.equinox=u,u>1980?this.radecsys="FK5":this.radecsys="FK4",c>0?this.epoch=c:this.epoch=0,this.wcson=1,this.sysout=this.radecsys,this.changesys=0,this.printsys=1,this.tabsys=0,this.pcode=0;for(let d=0;d<8;d++)((_,x,y=0)=>_.substr(y,x.length)===x)(this.ptype,this.ctypes[d])&&(this.pcode=d+1);this.wcsfull()}else if((e!=null&&e.constructor!=null&&e.constructor.__interfaces!=null&&e.constructor.__interfaces.indexOf("coordtxl.coords.WCSKeywordProvider")>=0||e===null)&&i===void 0&&t===void 0&&n===void 0&&r===void 0&&s===void 0&&a===void 0&&f===void 0&&l===void 0&&u===void 0&&c===void 0&&h===void 0){let d=arguments[0];this.xref===void 0&&(this.xref=0),this.yref===void 0&&(this.yref=0),this.xrefpix===void 0&&(this.xrefpix=0),this.yrefpix===void 0&&(this.yrefpix=0),this.xinc===void 0&&(this.xinc=0),this.yinc===void 0&&(this.yinc=0),this.rot===void 0&&(this.rot=0),this.crot===void 0&&(this.crot=0),this.srot===void 0&&(this.srot=0),this.cd11===void 0&&(this.cd11=0),this.cd12===void 0&&(this.cd12=0),this.cd21===void 0&&(this.cd21=0),this.cd22===void 0&&(this.cd22=0),this.dc11===void 0&&(this.dc11=0),this.dc12===void 0&&(this.dc12=0),this.dc21===void 0&&(this.dc21=0),this.dc22===void 0&&(this.dc22=0),this.mrot===void 0&&(this.mrot=0),this.cmrot===void 0&&(this.cmrot=0),this.smrot===void 0&&(this.smrot=0),this.xmpix===void 0&&(this.xmpix=0),this.ympix===void 0&&(this.ympix=0),this.equinox===void 0&&(this.equinox=0),this.epoch===void 0&&(this.epoch=0),this.nxpix===void 0&&(this.nxpix=0),this.nypix===void 0&&(this.nypix=0),this.plate_ra===void 0&&(this.plate_ra=0),this.plate_dec===void 0&&(this.plate_dec=0),this.plate_scale===void 0&&(this.plate_scale=0),this.x_pixel_offset===void 0&&(this.x_pixel_offset=0),this.y_pixel_offset===void 0&&(this.y_pixel_offset=0),this.x_pixel_size===void 0&&(this.x_pixel_size=0),this.y_pixel_size===void 0&&(this.y_pixel_size=0),this.xpix===void 0&&(this.xpix=0),this.ypix===void 0&&(this.ypix=0),this.xpos===void 0&&(this.xpos=0),this.ypos===void 0&&(this.ypos=0),this.pcode===void 0&&(this.pcode=0),this.changesys===void 0&&(this.changesys=0),this.printsys===void 0&&(this.printsys=0),this.ndec===void 0&&(this.ndec=0),this.degout===void 0&&(this.degout=0),this.tabsys===void 0&&(this.tabsys=0),this.rotmat===void 0&&(this.rotmat=0),this.coorflip===void 0&&(this.coorflip=0),this.offscl===void 0&&(this.offscl=0),this.plate_fit===void 0&&(this.plate_fit=0),this.wcson===void 0&&(this.wcson=0),this.detector===void 0&&(this.detector=0),this.fCenterRa===void 0&&(this.fCenterRa=0),this.fCenterDec===void 0&&(this.fCenterDec=0),this.fHalfWidthRa===void 0&&(this.fHalfWidthRa=0),this.fHalfWidthDec===void 0&&(this.fHalfWidthDec=0),this.fWidthDeg===void 0&&(this.fWidthDeg=0),this.fHeightDeg===void 0&&(this.fHeightDeg=0),this.degPerPixel===void 0&&(this.degPerPixel=null),this.ppo_coeff=[0,0,0,0,0,0],this.amd_x_coeff=(P=>{let p=[];for(;P-- >0;)p.push(0);return p})(20),this.amd_y_coeff=(P=>{let p=[];for(;P-- >0;)p.push(0);return p})(20),this.instrument="",this.c1type="",this.c2type="",this.ctypes=["-SIN","-TAN","-ARC","-NCP","-GLS","-MER","-AIT","-STG"],this.ptype="",this.radecsys="",this.sysout="",this.center="";let _,x,y,m,D,v,S,I,$,W,O,C,E,V;if(this.plate_fit=0,this.nxpix=d.getDoubleValue$java_lang_String("NAXIS1"),this.nypix=d.getDoubleValue$java_lang_String("NAXIS2"),this.xmpix=.5*this.nxpix,this.ympix=.5*this.nypix,this.mrot=0,this.equinox=d.getDoubleValue$java_lang_String("EQUINOX"),d.findKey("PLTRAH")){this.plate_fit=1,y=d.getDoubleValue$java_lang_String("PLTRAH"),m=d.getDoubleValue$java_lang_String("PLTRAM"),D=d.getDoubleValue$java_lang_String("PLTRAS"),O=y+m/60+D/3600,this.plate_ra=N.hrrad(O),x="+";let P=d.getStringValue$java_lang_String("PLTDECSN");P!=null&&(x=P.charAt(0)),(p=>p.charCodeAt==null?p:p.charCodeAt(0))(x)=="-".charCodeAt(0)?v=-1:v=1,S=d.getDoubleValue$java_lang_String("PLTDECD"),I=d.getDoubleValue$java_lang_String("PLTDECM"),$=d.getDoubleValue$java_lang_String("PLTDECS"),W=v*(S+I/60+$/3600),this.plate_dec=N.degrad(W),V=this.equinox|0,V===1950?this.radecsys="FK4":this.radecsys="FK5",this.epoch=this.equinox,d.findKey("EPOCH")&&(this.epoch=d.getDoubleValue$java_lang_String("EPOCH")),this.plate_scale=d.getDoubleValue$java_lang_String("PLTSCALE"),this.x_pixel_size=d.getDoubleValue$java_lang_String("XPIXELSZ"),this.y_pixel_size=d.getDoubleValue$java_lang_String("YPIXELSZ"),this.x_pixel_offset=d.getDoubleValue$java_lang_String("CNPIX1"),this.y_pixel_offset=d.getDoubleValue$java_lang_String("CNPIX2"),this.ppo_coeff[0]=d.getDoubleValue$java_lang_String("PPO1"),this.ppo_coeff[1]=d.getDoubleValue$java_lang_String("PPO2"),this.ppo_coeff[2]=d.getDoubleValue$java_lang_String("PPO3"),this.ppo_coeff[3]=d.getDoubleValue$java_lang_String("PPO4"),this.ppo_coeff[4]=d.getDoubleValue$java_lang_String("PPO5"),this.ppo_coeff[5]=d.getDoubleValue$java_lang_String("PPO6"),this.amd_x_coeff[0]=d.getDoubleValue$java_lang_String("AMDX1"),this.amd_x_coeff[1]=d.getDoubleValue$java_lang_String("AMDX2"),this.amd_x_coeff[2]=d.getDoubleValue$java_lang_String("AMDX3"),this.amd_x_coeff[3]=d.getDoubleValue$java_lang_String("AMDX4"),this.amd_x_coeff[4]=d.getDoubleValue$java_lang_String("AMDX5"),this.amd_x_coeff[5]=d.getDoubleValue$java_lang_String("AMDX6"),this.amd_x_coeff[6]=d.getDoubleValue$java_lang_String("AMDX7"),this.amd_x_coeff[7]=d.getDoubleValue$java_lang_String("AMDX8"),this.amd_x_coeff[8]=d.getDoubleValue$java_lang_String("AMDX9"),this.amd_x_coeff[9]=d.getDoubleValue$java_lang_String("AMDX10"),this.amd_x_coeff[10]=d.getDoubleValue$java_lang_String("AMDX11"),this.amd_x_coeff[11]=d.getDoubleValue$java_lang_String("AMDX12"),this.amd_x_coeff[12]=d.getDoubleValue$java_lang_String("AMDX13"),this.amd_x_coeff[13]=d.getDoubleValue$java_lang_String("AMDX14"),this.amd_x_coeff[14]=d.getDoubleValue$java_lang_String("AMDX15"),this.amd_x_coeff[15]=d.getDoubleValue$java_lang_String("AMDX16"),this.amd_x_coeff[16]=d.getDoubleValue$java_lang_String("AMDX17"),this.amd_x_coeff[17]=d.getDoubleValue$java_lang_String("AMDX18"),this.amd_x_coeff[18]=d.getDoubleValue$java_lang_String("AMDX19"),this.amd_x_coeff[19]=d.getDoubleValue$java_lang_String("AMDX20"),this.amd_y_coeff[0]=d.getDoubleValue$java_lang_String("AMDY1"),this.amd_y_coeff[1]=d.getDoubleValue$java_lang_String("AMDY2"),this.amd_y_coeff[2]=d.getDoubleValue$java_lang_String("AMDY3"),this.amd_y_coeff[3]=d.getDoubleValue$java_lang_String("AMDY4"),this.amd_y_coeff[4]=d.getDoubleValue$java_lang_String("AMDY5"),this.amd_y_coeff[5]=d.getDoubleValue$java_lang_String("AMDY6"),this.amd_y_coeff[6]=d.getDoubleValue$java_lang_String("AMDY7"),this.amd_y_coeff[7]=d.getDoubleValue$java_lang_String("AMDY8"),this.amd_y_coeff[8]=d.getDoubleValue$java_lang_String("AMDY9"),this.amd_y_coeff[9]=d.getDoubleValue$java_lang_String("AMDY10"),this.amd_y_coeff[10]=d.getDoubleValue$java_lang_String("AMDY11"),this.amd_y_coeff[11]=d.getDoubleValue$java_lang_String("AMDY12"),this.amd_y_coeff[12]=d.getDoubleValue$java_lang_String("AMDY13"),this.amd_y_coeff[13]=d.getDoubleValue$java_lang_String("AMDY14"),this.amd_y_coeff[14]=d.getDoubleValue$java_lang_String("AMDY15"),this.amd_y_coeff[15]=d.getDoubleValue$java_lang_String("AMDY16"),this.amd_y_coeff[16]=d.getDoubleValue$java_lang_String("AMDY17"),this.amd_y_coeff[17]=d.getDoubleValue$java_lang_String("AMDY18"),this.amd_y_coeff[18]=d.getDoubleValue$java_lang_String("AMDY19"),this.amd_y_coeff[19]=d.getDoubleValue$java_lang_String("AMDY20"),this.wcson=1,this.c1type="RA-",this.c2type="DEC",this.ptype="PLATE",this.degout=0,this.ndec=3}else if((_=d.getStringValue$java_lang_String("CTYPE1"))!=null){let P=_.length;if(((p,M,A=0)=>p.substr(A,M.length)===M)(_,"LINEAR"))this.pcode=0,this.c1type=_,this.ptype=_;else if(((p,M,A=0)=>p.substr(A,M.length)===M)(_,"PIXEL"))this.pcode=-1,this.c1type=_,this.ptype=_;else if(P>1&&((p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(0))=="R".charCodeAt(0)||(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(0))=="D".charCodeAt(0)||(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(0))=="A".charCodeAt(0)||(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(1))=="L".charCodeAt(0))){this.c1type=_.substring(0,2),P>2&&(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(2))!="-".charCodeAt(0)&&(this.c1type+=_.charAt(2)),P>3&&(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(3))!="-".charCodeAt(0)&&(this.c1type+=_.charAt(3)),P>4&&(this.ptype=_.substring(3,7)),this.pcode=0;for(let p=0;p<8;p++)if(((M,A,k=0)=>M.substr(k,A.length)===A)(this.ptype,this.ctypes[p])){this.pcode=p+1;break}}else throw console.error("WCSINIT: CTYPE1 not sky coordinates or LINEAR -> no WCS"),Object.defineProperty(new Error,"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});if((_=d.getStringValue$java_lang_String("CTYPE2"))==null)throw console.error("WCSINIT: No CTYPE2 -> no WCS"),Object.defineProperty(new Error(N.NO_WCS_IN_HEADER_MESSAGE),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});if(P=_.length,((p,M,A=0)=>p.substr(A,M.length)===M)(_,"LINEAR"))this.pcode=0,this.c2type=_;else if(((p,M,A=0)=>p.substr(A,M.length)===M)(_,"PIXEL"))this.pcode=-1,this.c2type=_;else if(P>1&&((p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(0))=="R".charCodeAt(0)||(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(0))=="D".charCodeAt(0)||(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(0))=="A".charCodeAt(0)||(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(1))=="L".charCodeAt(0)))this.c2type=_.substring(0,2),P>2&&(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(2))!="-".charCodeAt(0)&&(this.c2type+=_.charAt(2)),P>3&&(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(3))!="-".charCodeAt(0)&&(this.c2type+=_.charAt(3)),((p,M,A=0)=>p.substr(A,M.length)===M)(this.c1type,"DEC")||((p,M,A=0)=>p.substr(A,M.length)===M)(this.c1type,"GLAT")?this.coorflip=1:this.coorflip=0,(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(1))=="L".charCodeAt(0)||(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(0))=="A".charCodeAt(0)?(this.degout=1,this.ndec=5):(this.degout=0,this.ndec=3);else throw console.error("WCSINIT: CTYPE2 not sky coordinates or LINEAR -> no WCS"),Object.defineProperty(new Error(N.NO_WCS_IN_HEADER_MESSAGE),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});this.xrefpix=d.getDoubleValue$java_lang_String$double("CRPIX1",1),this.yrefpix=d.getDoubleValue$java_lang_String$double("CRPIX2",1),this.xref=d.getDoubleValue$java_lang_String$double("CRVAL1",1),this.yref=d.getDoubleValue$java_lang_String$double("CRVAL2",1),(this.xinc=d.getDoubleValue$java_lang_String("CDELT1"))!==0?(this.yinc=d.getDoubleValue$java_lang_String$double("CDELT2",this.xinc),this.rot=d.getDoubleValue$java_lang_String$double("CROTA1",0),this.rot===0&&(this.rot=d.getDoubleValue$java_lang_String("CROTA2")),this.cd11=0,this.cd21=0,this.cd12=0,this.cd22=0,this.rotmat=0):(this.cd11=d.getDoubleValue$java_lang_String("CD1_1"))!==0?(this.rotmat=1,this.cd12=d.getDoubleValue$java_lang_String$double("CD1_2",0),this.cd21=d.getDoubleValue$java_lang_String$double("CD2_1",0),this.cd22=d.getDoubleValue$java_lang_String$double("CD2_2",this.cd11),E=this.cd11*this.cd22-this.cd12*this.cd21,E!==0&&(this.dc11=this.cd22/E,this.dc12=-this.cd12/E,this.dc21=-this.cd21/E,this.dc22=this.cd11/E),this.xinc=Math.sqrt(this.cd11*this.cd11+this.cd21*this.cd21),this.yinc=Math.sqrt(this.cd12*this.cd12+this.cd22*this.cd22),this.cd11*this.cd11-this.cd12*this.cd12<0?((((p,M,A=0)=>p.substr(A,M.length)===M)(this.c1type,"RA")||((p,M,A=0)=>p.substr(A,M.length)===M)(this.c1type,"GLON"))&&(this.xinc=-this.xinc),(((p,M,A=0)=>p.substr(A,M.length)===M)(this.c2type,"RA")||((p,M,A=0)=>p.substr(A,M.length)===M)(this.c2type,"GLON"))&&(this.yinc=-this.yinc),this.rot=N.raddeg(Math.atan2(-this.cd12,this.cd22))):this.rot=N.raddeg(Math.atan2(this.cd12,this.cd22))):(this.xinc=1,this.yinc=1,console.error("WCSINIT: setting CDELT to 1")),this.xmpix=d.getDoubleValue$java_lang_String("CCPIX1"),this.ympix=d.getDoubleValue$java_lang_String("CCPIX2"),this.mrot=d.getDoubleValue$java_lang_String("CCROT1"),((p,M,A=0)=>p.substr(A,M.length)===M)(this.ptype,"LINEAR")&&((p,M,A=0)=>p.substr(A,M.length)===M)(this.ptype,"PIXEL")?this.degout=-1:this.wcseq(d),this.wcson=1}else if(d.findKey("SECPIX")||d.findKey("PIXSCAL1")||d.findKey("SECPIX1")){if(C=d.getDoubleValue$java_lang_String$double("SECPIX",0),C===0?(C=d.getDoubleValue$java_lang_String$double("SECPIX1",0),C!==0?(this.xinc=-C/3600,C=d.getDoubleValue$java_lang_String$double("SECPIX2",0),this.yinc=C/3600):(C=d.getDoubleValue$java_lang_String$double("PIXSCAL1",0),this.xinc=-C/3600,C=d.getDoubleValue$java_lang_String$double("PIXSCAL2",0),this.yinc=C/3600)):(this.yinc=C/3600,this.xinc=-this.yinc),this.xrefpix=d.getDoubleValue$java_lang_String$double("CRPIX1",this.nxpix*.5),this.yrefpix=d.getDoubleValue$java_lang_String$double("CRPIX2",this.nypix*.5),this.xref=0,(this.xref=d.getDoubleValue$java_lang_String$double("RA",0))===0)throw console.error("WCSINIT: No RA with SECPIX, no WCS"),Object.defineProperty(new Error(N.NO_WCS_IN_HEADER_MESSAGE),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});if(this.yref=0,(this.yref=d.getDoubleValue$java_lang_String$double("DEC",0))===0)throw console.error("WCSINIT: No DEC with SECPIX, no WCS"),Object.defineProperty(new Error(N.NO_WCS_IN_HEADER_MESSAGE),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});this.c1type="RA--TAN",this.c2type="DEC-TAN",this.ptype="-TAN",this.pcode=1,this.coorflip=0,this.degout=0,this.ndec=3,this.rot=d.getDoubleValue$java_lang_String$double("CROTA1",0),this.rot===0&&(this.rot=d.getDoubleValue$java_lang_String$double("CROTA2",0)),this.cd11=0,this.cd21=0,this.cd12=0,this.cd22=0,this.dc11=0,this.dc21=0,this.dc12=0,this.dc22=0,this.rotmat=0,this.xmpix=d.getDoubleValue$java_lang_String("CCPIX1"),this.ympix=d.getDoubleValue$java_lang_String("CCPIX2"),this.mrot=d.getDoubleValue$java_lang_String("CCROT1"),this.wcseq(d),(this.epoch=d.getDoubleValue$java_lang_String$double("DATE-OBS",0))===0&&(this.epoch=d.getDoubleValue$java_lang_String$double("EPOCH",0))===0&&(this.epoch=this.equinox),this.wcson=1}else throw Object.defineProperty(new Error(N.NO_WCS_IN_HEADER_MESSAGE),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});this.sysout=this.radecsys,this.changesys=0,this.printsys=1,this.tabsys=0,this.wcsfull()}else throw new Error("invalid overload")}getEquinox(){return this.equinox}getWCSCenter(){if(this.isValid())return new Oe.Point2D(this.fCenterRa,this.fCenterDec);throw Object.defineProperty(new Error("No WCS information."),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}getImageCenter(){return new Oe.Point2D(.5*this.nxpix,.5*this.nypix)}isWCS(){return this.isValid()}imageToWorldCoords(e,i){if(!!this.isValid())if(i)e.x=Math.abs(e.x*this.degPerPixel.x),e.y=Math.abs(e.y*this.degPerPixel.y);else{let t=this.pix2wcs(e.x,e.y);if(t!=null)e.setLocation(t.x,t.y);else throw Object.defineProperty(new Error("Image coordinates out of WCS range: "+e),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}}worldToImageCoords(e,i){if(!!this.isValid())if(i)e.x=Math.abs(e.x/this.degPerPixel.x),e.y=Math.abs(e.y/this.degPerPixel.y);else{let t=this.wcs2pix(e.x,e.y);if(t!=null)e.setLocation(t.x,t.y);else throw Object.defineProperty(new Error("World coordinates out of range: "+e),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}}getWidthInDeg(){return this.fWidthDeg}getHeightInDeg(){return this.fHeightDeg}getWidth(){return this.nxpix}getHeight(){return this.nypix}wcseq(e){let i=0,t;e.findKey("EQUINOX")?(this.equinox=e.getDoubleValue$java_lang_String("EQUINOX"),i=2e3):e.findKey("EPOCH")?(i=e.getDoubleValue$java_lang_String$double("EPOCH",0)|0,i===0?(i=1950,this.equinox=1950):this.equinox=e.getDoubleValue$java_lang_String("EPOCH")):e.findKey("RADECSYS")&&(t=e.getStringValue$java_lang_String("RADECSYS"),((n,r,s=0)=>n.substr(s,r.length)===r)(t,"FK4")?(this.equinox=1950,i=1950):((n,r,s=0)=>n.substr(s,r.length)===r)(t,"FK5")?(this.equinox=2e3,i=2e3):((n,r,s=0)=>n.substr(s,r.length)===r)(t,"GAL")?(this.equinox=2e3,i=2e3):((n,r,s=0)=>n.substr(s,r.length)===r)(t,"ECL")&&(this.equinox=2e3,i=2e3)),i===0&&(this.equinox=2e3,i=2e3),(this.epoch=e.getDoubleValue$java_lang_String$double("DATE-OBS",0))===0&&(this.epoch=e.getDoubleValue$java_lang_String$double("EPOCH",0))===0&&(this.epoch=this.equinox),this.epoch===0&&(this.epoch=this.equinox),e.findKey("RADECSYS")?((n,r,s=0)=>n.substr(s,r.length)===r)(this.radecsys,"FK4")?this.equinox=1950:((n,r,s=0)=>n.substr(s,r.length)===r)(this.radecsys,"FK5")?this.equinox=2e3:((n,r,s=0)=>n.substr(s,r.length)===r)(this.radecsys,"GAL")&&i===0&&(this.equinox=2e3):(n=>n.charCodeAt==null?n:n.charCodeAt(0))(this.c1type.charAt(0))=="G".charCodeAt(0)?this.radecsys="GALACTIC":(n=>n.charCodeAt==null?n:n.charCodeAt(0))(this.c1type.charAt(0))=="E".charCodeAt(0)?this.radecsys="ECLIPTIC":(n=>n.charCodeAt==null?n:n.charCodeAt(0))(this.c1type.charAt(0))=="S".charCodeAt(0)?this.radecsys="SGALACTC":(n=>n.charCodeAt==null?n:n.charCodeAt(0))(this.c1type.charAt(0))=="H".charCodeAt(0)?this.radecsys="HELIOECL":(n=>n.charCodeAt==null?n:n.charCodeAt(0))(this.c1type.charAt(0))=="A".charCodeAt(0)?this.radecsys="ALTAZ":i>1980?this.radecsys="FK5":this.radecsys="FK4"}isValid(){return this.wcson>0}wcsshift(e,i,t){!this.isValid()||(this.fCenterRa=this.xref=e,this.fCenterDec=this.yref=i,this.radecsys=t,((n,r,s=0)=>n.substr(s,r.length)===r)(t,"FK4")?this.equinox=1950:this.equinox=2e3)}wcssize(){let e,i,t,n;if(this.isValid()){e=.5*this.nxpix,i=.5*this.nypix;let r=this.pix2wcs(e,i);if(r==null)return;this.fCenterRa=r.x,this.fCenterDec=r.y;let s=this.pix2wcs(1,i),a=this.pix2wcs(this.nxpix,i);if(s==null||a==null||(!((f,l,u=0)=>f.substr(u,l.length)===l)(this.ptype,"LINEAR")&&!((f,l,u=0)=>f.substr(u,l.length)===l)(this.ptype,"PIXEL")?(t=this.wcsdist(s.x,s.y,a.x,a.y),this.fHalfWidthRa=t*.5/Math.cos(N.degrad(this.fCenterDec))):this.fHalfWidthRa=Math.sqrt((a.y-s.y)*(a.y-s.y)+(a.x-s.x)*(a.x-s.x)),s=this.pix2wcs(e,1),a=this.pix2wcs(e,this.nypix),s==null||a==null))return;!((f,l,u=0)=>f.substr(u,l.length)===l)(this.ptype,"LINEAR")&&!((f,l,u=0)=>f.substr(u,l.length)===l)(this.ptype,"PIXEL")?(n=this.wcsdist(s.x,s.y,a.x,a.y),this.fHalfWidthDec=n*.5):this.fHalfWidthDec=Math.sqrt((a.y-s.y)*(a.y-s.y)+(a.x-s.x)*(a.x-s.x))}}wcsfull(){let e,i;if(this.isValid()){e=.5*this.nxpix,i=.5*this.nypix;let t=this.pix2wcs(e,i);if(t==null)return;this.fCenterRa=t.x,this.fCenterDec=t.y;let n=this.pix2wcs(0,i),r=this.pix2wcs(this.nxpix,i);if(n==null||r==null||(!((s,a,f=0)=>s.substr(f,a.length)===a)(this.ptype,"LINEAR")&&!((s,a,f=0)=>s.substr(f,a.length)===a)(this.ptype,"PIXEL")?this.fWidthDeg=this.wcsdist(n.x,n.y,r.x,r.y):this.fWidthDeg=Math.sqrt((r.y-n.y)*(r.y-n.y)+(r.x-n.x)*(r.x-n.x)),n=this.pix2wcs(e,0),r=this.pix2wcs(e,this.nypix),n==null||r==null))return;!((s,a,f=0)=>s.substr(f,a.length)===a)(this.ptype,"LINEAR")&&!((s,a,f=0)=>s.substr(f,a.length)===a)(this.ptype,"PIXEL")?this.fHeightDeg=this.wcsdist(n.x,n.y,r.x,r.y):this.fHeightDeg=Math.sqrt((r.y-n.y)*(r.y-n.y)+(r.x-n.x)*(r.x-n.x)),this.degPerPixel=new Oe.Point2D(this.fWidthDeg/this.nxpix,this.fHeightDeg/this.nypix)}}wcsdist(e,i,t,n){let r,s,a,f,l=[0,0,0],u=[0,0,0],c,h,g,d;for(r=N.degrad(e),a=N.degrad(i),g=Math.cos(a),l[0]=Math.cos(r)*g,l[1]=Math.sin(r)*g,l[2]=Math.sin(a),s=N.degrad(t),f=N.degrad(n),g=Math.cos(f),u[0]=Math.cos(s)*g,u[1]=Math.sin(s)*g,u[2]=Math.sin(f),c=0,d=0;d<3;d++)c=c+(l[d]-u[d])*(l[d]-u[d]);return c=c/4,c>1&&(c=1),h=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),h=N.raddeg(h),h}pix2wcs(e,i){let t;return this.isValid()?(this.xpix=e,this.ypix=i,this.offscl=0,this.plate_fit>0?(t=Et.platepos.getPosition(e,i,this))==null&&(this.offscl=1):(t=At.worldpos.getPosition(e,i,this))==null&&(this.offscl=1),this.pcode>0&&(((n,r,s=0)=>n.substr(s,r.length)===r)(this.radecsys,"FK4")?this.equinox!==1950&&(t=se.wcscon.fk4prec(this.equinox,1950,t)):((n,r,s=0)=>n.substr(s,r.length)===r)(this.radecsys,"FK5")&&this.equinox!==2e3&&(t=se.wcscon.fk5prec(this.equinox,2e3,t)),this.changesys===1?t=se.wcscon.fk425e(t,this.epoch):this.changesys===2?t=se.wcscon.fk524e(t,this.epoch):this.changesys===3?t=se.wcscon.fk42gal(t):this.changesys===4&&(t=se.wcscon.fk52gal(t))),this.offscl===0&&t!=null&&(this.xpos=t.x,this.ypos=t.y),t):null}wcs2pix(e,i){let t;if(!this.isValid())return null;this.xpos=e,this.ypos=i;let n=new Oe.Point2D(e,i);return this.changesys===1?n=se.wcscon.fk524e(n,this.epoch):this.changesys===2&&(n=se.wcscon.fk425e(n,this.epoch)),((r,s,a=0)=>r.substr(a,s.length)===s)(this.radecsys,"FK4")?this.equinox!==1950&&(n=se.wcscon.fk4prec(1950,this.equinox,n)):((r,s,a=0)=>r.substr(a,s.length)===s)(this.radecsys,"FK5")&&this.equinox!==2e3&&(n=se.wcscon.fk5prec(2e3,this.equinox,n)),this.plate_fit>0?(t=Et.platepos.getPixels(n.x,n.y,this))==null&&(this.offscl=1):(t=At.worldpos.getPixels(n.x,n.y,this))==null&&(this.offscl=1),t!=null&&(this.xpix=t.x,this.ypix=t.y),t}};Ve.WCSTransform=N;N.NO_WCS_IN_HEADER_MESSAGE="The header does not contain a valid world coordinate system.";N.__class="coordtxl.coords.WCSTransform";N.__interfaces=["coordtxl.coords.WorldCoordinateConverter"];var se=vt(),At=Ct(),Et=St()});var jt=B(we=>{"use strict";Object.defineProperty(we,"__esModule",{value:!0});we.Trigod=void 0;var H=class{static DEG_$LI$(){return H.DEG==null&&(H.DEG=180/Math.PI),H.DEG}static fractionalPart(e){return Math.abs(e-(e|0))}static cosd(e){let i=0,t=H.fractionalPart(e/360);return t>.5&&(t=1-t),t>.25&&(t=.5-t,i=1),t>.125?t=Math.sin(Math.PI*2*(.25-t)):t=Math.cos(Math.PI*2*t),i!==0&&(t=-t),t}static sind(e){let i=H.fractionalPart(e/360),t=e>=0?0:1;return i>.5&&(i=1-i,t^=1),i>.25&&(i=.5-i),i>.125?i=Math.cos(Math.PI*2*(.25-i)):i=Math.sin(Math.PI*2*i),t!==0&&(i=-i),i}static tand(e){let i=H.fractionalPart(e/180);return i===.5?i=H.DOUBLE_MAX:i=Math.tan(Math.PI*i),e>0?i:-i}static atand(e){return H.DEG_$LI$()*Math.atan(e)}static atan2d(e,i){return H.DEG_$LI$()*Math.atan2(e,i)}static acosd(e){return H.DEG_$LI$()*Math.acos(e)}asind(e){return H.DEG_$LI$()*Math.asin(e)}};we.Trigod=H;H.DOUBLE_MAX=17e37;H.__class="coordtxl.coords.Trigod"});var $t=B(Le=>{"use strict";Object.defineProperty(Le,"__esModule",{value:!0});Le.Cotr=void 0;var ne=class{static tr_Euler(e,i){let s;i[0][2]=G.Trigod.cosd(e[0]),i[1][2]=G.Trigod.sind(e[0]),i[2][0]=G.Trigod.cosd(e[2]),i[2][1]=G.Trigod.sind(e[2]),i[2][2]=G.Trigod.cosd(e[1]),s=G.Trigod.sind(e[1]),i[0][0]=i[2][0]*i[2][2]*i[0][2]-i[2][1]*i[1][2],i[1][0]=i[2][0]*i[2][2]*i[1][2]+i[2][1]*i[0][2],i[0][1]=-i[2][1]*i[2][2]*i[0][2]-i[2][0]*i[1][2],i[1][1]=-i[2][1]*i[2][2]*i[1][2]+i[2][0]*i[0][2],i[2][0]=i[2][0]*s,i[2][1]=-i[2][1]*s,i[0][2]=-s*i[0][2],i[1][2]=-s*i[1][2]}static tr_oo(e,i,t){let n=[0,0,0];ne.tr_ou(e,n),ne.tr_uu(n,n,t),ne.tr_uo(n,i)}static tr_oo1(e,i,t){let n=[0,0,0];ne.tr_ou(e,n),ne.tr_uu1(n,n,t),ne.tr_uo(n,i)}static tr_oR(e,i){let t=e[0],n=e[1];i[2][2]=G.Trigod.cosd(n),i[0][2]=G.Trigod.sind(n),i[1][1]=G.Trigod.cosd(t),i[1][0]=-G.Trigod.sind(t),i[1][2]=0,i[0][0]=i[2][2]*i[1][1],i[0][1]=-i[2][2]*i[1][0],i[2][0]=-i[0][2]*i[1][1],i[2][1]=i[0][2]*i[1][0]}static tr_ou(e,i){let t=e[0],n=e[1],r=G.Trigod.cosd(n);i[0]=r*G.Trigod.cosd(t),i[1]=r*G.Trigod.sind(t),i[2]=G.Trigod.sind(n)}static tr_uo(e,i){let t=e[0],n=e[1],r=e[2],s=t*t+n*n;if(i[0]=0,s===0){if(r===0)return;i[1]=r>0?90:-90;return}i[1]=G.Trigod.atand(r/Math.sqrt(s)),i[0]=G.Trigod.atan2d(n,t),i[0]<0&&(i[0]+=360)}static tr_uR(e,i){let t=e[0],n=e[1],r=e[2];i[0][0]=t,i[0][1]=n,i[0][2]=r,i[2][2]=Math.sqrt(t*t+n*n),i[1][0]=0,i[1][1]=1,i[1][2]=0,i[2][2]!==0&&(i[1][1]=t/i[2][2],i[1][0]=-n/i[2][2]),i[2][0]=-i[0][2]*i[1][1],i[2][1]=i[0][2]*i[1][0]}static tr_uu(e,i,t){let n,r,s,a=[0,0,0];for(n=0;n<3;n++){for(s=0,r=0;r<3;r++)s+=t[n][r]*e[r];a[n]=s}for(n=0;n<3;n++)i[n]=a[n]}static tr_uu1(e,i,t){let n,r,s,a=[0,0,0];for(n=0;n<3;n++){for(r=0,s=0;r<3;r++)s+=t[r][n]*e[r];a[n]=s}for(n=0;n<3;n++)i[n]=a[n]}static tr_RR(e,i,t){let n,r,s,a,f=function(l){let u=function(c){if(c.length===0)return 0;{let h=[];for(let g=0;g<c[0];g++)h.push(u(c.slice(1)));return h}};return u(l)}([3,3]);for(n=0;n<3;n++)for(r=0;r<3;r++){for(s=0,a=0;s<3;s++)a+=t[n][s]*e[s][r];f[n][r]=a}for(n=0;n<3;n++)for(r=0;r<3;r++)i[n][r]=f[n][r]}static tr_RR1(e,i,t){let n,r,s,a,f=function(l){let u=function(c){if(c.length===0)return 0;{let h=[];for(let g=0;g<c[0];g++)h.push(u(c.slice(1)));return h}};return u(l)}([3,3]);for(n=0;n<3;n++)for(r=0;r<3;r++){for(s=0,a=0;s<3;s++)a+=t[s][n]*e[s][r];f[n][r]=a}for(n=0;n<3;n++)for(r=0;r<3;r++)i[n][r]=f[n][r]}};Le.Cotr=ne;ne.__class="coordtxl.coords.Cotr";var G=jt()});var Pt=B(Ne=>{"use strict";Object.defineProperty(Ne,"__esModule",{value:!0});Ne.JPrec=void 0;var ue=class{static prej_R(e,i,t){let n,r,s,a=[0,0,0],f=0,l=1,u=2;n=(i-2e3)/100,r=(t-i)/100,s=2306.2181+(1.39656-139e-6*n)*n,a[u]=(s+(.30188-344e-6*n+.017998*r)*r)*r/3600,a[f]=(s+(1.09468+66e-6*n+.018203*r)*r)*r/3600,a[l]=(2004.3109+(-.8533-217e-6*n)*n+(-.42665-217e-6*n-.041833*r)*r)*r/3600,We.Cotr.tr_Euler(a,e)}static prej_q(e,i,t,n){let r=[0,0,0];if(t===n){i[0]=e[0],i[1]=e[1];return}We.Cotr.tr_ou(e,r),ue.prej_u(r,r,t,n),We.Cotr.tr_uo(r,i)}static prej_u(e,i,t,n){let r=[[1,0,0],[0,1,0],[0,0,1]];if(t===n){i[0]=e[0],i[1]=e[1],i[2]=e[2];return}ue.prej_R(r,t,n),We.Cotr.tr_uu(e,i,r)}};Ne.JPrec=ue;ue.__class="coordtxl.coords.JPrec";var We=$t()});var Je=B(qe=>{"use strict";Object.defineProperty(qe,"__esModule",{value:!0});qe.StringUtil=void 0;var ge=class{static replace(e,i,t){return e.split(i).join(t)}static split(e,i){let t=e.indexOf(String.fromCharCode(i));if(t>0){let n;return n=[null,null],n[0]=e.substring(0,t),n[1]=e.substring(t+1),n}return null}static combine(e,i){if(e==null)return"";let t={str:"",toString:function(){return this.str}};for(let n=0;n<e.length;n++)(r=>(r.str+=e[n],r))(t),n+1<e.length&&(r=>(r.str+=i,r))(t);return t.str}static equals(e,i){return e==null&&i==null||!(e==null||i==null)&&e===i}static match(e,i){let t=i.length,n=e.length;for(let r=0;;r++){for(let s=0;;r++,s++){let a=s>=t,f=r>=n||(l=>l.charCodeAt==null?l:l.charCodeAt(0))(e.charAt(r))=="|".charCodeAt(0);if(a&&!f&&(l=>l.charCodeAt==null?l:l.charCodeAt(0))(e.charAt(r))=="*".charCodeAt(0)&&(r===n-1||r<n-1&&(l=>l.charCodeAt==null?l:l.charCodeAt(0))(e.charAt(r+1))=="|".charCodeAt(0))||a&&f)return!0;if(a||f)break;if((l=>l.charCodeAt==null?l:l.charCodeAt(0))(e.charAt(r))=="?".charCodeAt(0))continue;if((l=>l.charCodeAt==null?l:l.charCodeAt(0))(e.charAt(r))=="*".charCodeAt(0)||(l=>l.charCodeAt==null?l:l.charCodeAt(0))(e.charAt(r))=="%".charCodeAt(0)){r++;for(let l=t;l>=s;--l)if(ge.match(e.substring(r),i.substring(l)))return!0;break}if((l=>l.charCodeAt==null?l:l.charCodeAt(0))(e.charAt(r).toUpperCase())!=(l=>l.charCodeAt==null?l:l.charCodeAt(0))(i.charAt(s).toUpperCase()))break}if(r=e.indexOf("|",r),r===-1)return!1}}static pad(e,i,t){let n={str:"",toString:function(){return this.str}};if(t){(s=>(s.str+=e,s))(n);let r=e.length;for(;r++<i;)(s=>(s.str+=" ",s))(n)}else{let r=e.length;for(;r++<i;)(s=>(s.str+=" ",s))(n);(s=>(s.str+=e,s))(n)}return n.str}static arrayContains(e,i){for(let t=0;t<e.length;t++){let n=e[t];if(i===n)return!0}return!1}static capitalize(e){if(e==null||e.length===0)return e;let i={str:"",toString:function(){return this.str}},t=e.split("[\\s]+");for(let n=0;n<t.length;n++){let r=t[n];{let s=r.trim();s.length!==0&&((a=>(a.str+=s.substring(1).toLowerCase(),a))((a=>(a.str+=s.substring(0,1).toUpperCase(),a))(i)),(a=>(a.str+=" ",a))(i))}}return i.str.trim()}};qe.StringUtil=ge;ge.__class="coordtxl.util.StringUtil"});var It=B(ke=>{"use strict";Object.defineProperty(ke,"__esModule",{value:!0});ke.DMS=void 0;var li=Je(),J=class{static fmt_deg_min(e){let i=Math.round(e),t=(""+i).split(".").join("@").split("@");if(t.length<1)return"00";let n="";for(let r=t[0].length;r<2;++r)n+="0";for(let r=t[0].length>2?t[0].length-2:0;r<t[0].length;++r)n+=t[0].charAt(r);return n}static fmt_sec(e){let i=Math.round(e*100)/100,t=(""+i).split(".").join("@").split("@");if(t.length===0)return"00.00";if(t.length<2)return t[0]+".00";let n="";for(let s=t[0].length;s<2;++s)n+="0";for(let s=t[0].length>2?t[0].length-2:0;s<t[0].length;++s)n+=t[0].charAt(s);n+=".";let r=0;for(;r<2&&r<t[1].length;++r)n+=t[1].charAt(r);for(;r<2;++r)n+="0";return n}constructor(e,i,t){if((typeof e=="number"||e===null)&&(typeof i=="number"||i===null)&&(typeof t=="number"||t===null)){let n=arguments;this.degrees===void 0&&(this.degrees=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,this.set(e,i,t)}else if((e!=null&&e instanceof J||e===null)&&i===void 0&&t===void 0){let r=arguments[0];this.degrees===void 0&&(this.degrees=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,this.setVal(r.val)}else if((typeof e=="string"||e===null)&&i===void 0&&t===void 0){let r=arguments[0];this.degrees===void 0&&(this.degrees=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,r=li.StringUtil.replace(r,",",".");let s=[0,0,0],a=r.split(":").join("@").split(" ").join("@").split("@@").join("@").split("@"),f=0;for(;f<3&&f<a.length;)s[f]=parseFloat(a[f]),f+=1;if(f>=2)this.set(s[0],s[1]|0,s[2]);else if(f===1)this.setVal(s[0]);else throw Object.defineProperty(new Error("Expected a string of the form hh:mm:ss.sss, but got: '"+r+"'"),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}else if((typeof e=="number"||e===null)&&i===void 0&&t===void 0){let r=arguments[0];this.degrees===void 0&&(this.degrees=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,this.setVal(r)}else if(e===void 0&&i===void 0&&t===void 0){let n=arguments;this.degrees===void 0&&(this.degrees=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1}else throw new Error("invalid overload")}set(e,i,t){this.degrees=e|0,this.min=i,this.sec=t,this.val=(t/60+i)/60,e<0||e===J.MINUS_ZERO?(this.val=e-this.val,this.degrees=-this.degrees,this.sign=-1):(this.val=this.degrees+this.val,this.sign=1),this.initialized=!0}setVal(e){this.val=e;let i=e;i<0||i===J.MINUS_ZERO?(this.sign=-1,i=-i):this.sign=1;let t=i+1e-10;this.degrees=t|0;let n=(t-this.degrees)*60;this.min=n|0,this.sec=(n-this.min)*60,this.initialized=!0}toString$(){let e=J.fmt_sec(this.sec),i;return this.sign===-1?i="-":i="+",i+J.fmt_deg_min(this.degrees)+":"+J.fmt_deg_min(this.min)+":"+e}toString$boolean(e){if(e)return this.toString$();let i;return this.sign===-1?i="-":i="+",i+J.fmt_deg_min(this.degrees)+":"+J.fmt_deg_min(this.min)}toString(e){if(typeof e=="boolean"||e===null)return this.toString$boolean(e);if(e===void 0)return this.toString$();throw new Error("invalid overload")}isInitialized(){return this.initialized}getDegrees(){return this.degrees}getMin(){return this.min}getSec(){return this.sec}getVal(){return this.val}getSign(){return this.sign}equals(e){return e!=null&&e instanceof J&&this.val===e.val}};ke.DMS=J;J.MINUS_ZERO=-0;J.__class="coordtxl.coords.DMS"});var Ot=B(Ke=>{"use strict";Object.defineProperty(Ke,"__esModule",{value:!0});Ke.HMS=void 0;var Tt=Je(),Q=class{static fmt_hr_min(e){let i=Math.round(e),t=(""+i).split(".").join("@").split("@");if(t.length<1)return"00";let n="";for(let r=t[0].length;r<2;++r)n+="0";for(let r=t[0].length>2?t[0].length-2:0;r<t[0].length;++r)n+=t[0].charAt(r);return n}static fmt_sec(e){let i=Math.round(e*1e3)/1e3,t=(""+i).split(".").join("@").split("@");if(t.length===0)return"00.000";if(t.length<2)return t[0]+".000";let n="";for(let s=t[0].length;s<2;++s)n+="0";for(let s=t[0].length>2?t[0].length-2:0;s<t[0].length;++s)n+=t[0].charAt(s);n+=".";let r=0;for(;r<3&&r<t[1].length;++r)n+=t[1].charAt(r);for(;r<3;++r)n+="0";return n}constructor(e,i,t){if((typeof e=="number"||e===null)&&(typeof i=="number"||i===null)&&(typeof t=="number"||t===null)){let n=arguments;this.hours===void 0&&(this.hours=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,this.set(e,i,t)}else if((typeof e=="string"||e===null)&&(typeof i=="boolean"||i===null)&&t===void 0){let n=arguments,r=n[0],s=n[1];this.hours===void 0&&(this.hours=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,r=Tt.StringUtil.replace(r,",",".");let a=[0,0,0],f=r.split(":").join("@").split(" ").join("@").split("@@").join("@").split("@"),l=0;for(;l<3&&l<f.length;)a[l]=parseFloat(f[l]),l+=1;if(l>=2)this.set(a[0],a[1]|0,a[2]);else if(l===1)!s&&r.indexOf(".")!==-1?this.setVal(a[0]/15):this.setVal(a[0]);else throw Object.defineProperty(new Error("Expected a string of the form hh:mm:ss.sss, but got: '"+r+"'"),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}else if((e!=null&&e instanceof Q||e===null)&&i===void 0&&t===void 0){let r=arguments[0];this.hours===void 0&&(this.hours=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,this.setVal(r.val)}else if((typeof e=="string"||e===null)&&i===void 0&&t===void 0){let r=arguments[0];{let s=arguments,a=!1;this.hours===void 0&&(this.hours=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,r=Tt.StringUtil.replace(r,",",".");let f=[0,0,0],l=r.split(":").join("@").split(" ").join("@").split("@@").join("@").split("@"),u=0;for(;u<3&&u<l.length;)f[u]=parseFloat(l[u]),u+=1;if(u>=2)this.set(f[0],f[1]|0,f[2]);else if(u===1)!a&&r.indexOf(".")!==-1?this.setVal(f[0]/15):this.setVal(f[0]);else throw Object.defineProperty(new Error("Expected a string of the form hh:mm:ss.sss, but got: '"+r+"'"),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}this.hours===void 0&&(this.hours=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1}else if((typeof e=="number"||e===null)&&i===void 0&&t===void 0){let r=arguments[0];this.hours===void 0&&(this.hours=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,this.setVal(r)}else if(e===void 0&&i===void 0&&t===void 0){let n=arguments;this.hours===void 0&&(this.hours=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1}else throw new Error("invalid overload")}set(e,i,t){this.hours=e|0,this.min=i,this.sec=t,this.val=(t/60+i)/60,e<0||e===Q.MINUS_ZERO?(this.val=e-this.val,this.hours=-this.hours,this.sign=-1):(this.val=this.hours+this.val,this.sign=1),this.initialized=!0}setVal(e){this.val=e;let i=e;i<0||i===Q.MINUS_ZERO?(this.sign=-1,i=-i):this.sign=1;let t=i+1e-10;this.hours=t|0;let n=(t-this.hours)*60;this.min=n|0,this.sec=(n-this.min)*60,this.initialized=!0}toString$(){let e=Q.fmt_sec(this.sec),i;return this.sign===-1?i="-":i="",i+Q.fmt_hr_min(this.hours)+":"+Q.fmt_hr_min(this.min)+":"+e}toString$boolean(e){if(e)return this.toString$();let i;return this.sign===-1?i="-":i=" ",i+Q.fmt_hr_min(this.hours)+":"+Q.fmt_hr_min(this.min)}toString(e){if(typeof e=="boolean"||e===null)return this.toString$boolean(e);if(e===void 0)return this.toString$();throw new Error("invalid overload")}isInitialized(){return this.initialized}getHours(){return this.hours}getMin(){return this.min}getSec(){return this.sec}getVal(){return this.val}getSign(){return this.sign}equals(e){return e!=null&&e instanceof Q&&this.val===e.val}};Ke.HMS=Q;Q.MINUS_ZERO=-0;Q.__class="coordtxl.coords.HMS"});var wt=B(Xe=>{"use strict";Object.defineProperty(Xe,"__esModule",{value:!0});Xe.WorldCoords=void 0;var Vt=de(),Y=class{constructor(e,i,t,n,r,s,a){if((typeof e=="number"||e===null)&&(typeof i=="number"||i===null)&&(typeof t=="number"||t===null)&&(typeof n=="number"||n===null)&&(typeof r=="number"||r===null)&&(typeof s=="number"||s===null)&&(typeof a=="number"||a===null)){let f=arguments;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new Z.HMS(e,i,t),this.dec=new U.DMS(n,r,s),this.init(a)}else if((typeof e=="number"||e===null)&&(typeof i=="number"||i===null)&&(typeof t=="number"||t===null)&&(typeof n=="number"||n===null)&&(typeof r=="number"||r===null)&&(typeof s=="number"||s===null)&&a===void 0){let f=arguments;{let l=arguments,u=2e3;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new Z.HMS(e,i,t),this.dec=new U.DMS(n,r,s),this.init(u)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if((typeof e=="string"||e===null)&&(typeof i=="string"||i===null)&&(typeof t=="number"||t===null)&&(typeof n=="boolean"||n===null)&&r===void 0&&s===void 0&&a===void 0){let f=arguments,l=f[0],u=f[1],c=f[2],h=f[3];this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new Z.HMS(l,h),this.dec=new U.DMS(u),this.init(c)}else if((e!=null&&e instanceof Z.HMS||e===null)&&(i!=null&&i instanceof U.DMS||i===null)&&(typeof t=="number"||t===null)&&n===void 0&&r===void 0&&s===void 0&&a===void 0){let f=arguments,l=f[0],u=f[1],c=f[2];this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=l,this.dec=u,this.init(c)}else if((typeof e=="number"||e===null)&&(typeof i=="number"||i===null)&&(typeof t=="number"||t===null)&&n===void 0&&r===void 0&&s===void 0&&a===void 0){let f=arguments,l=f[0],u=f[1],c=f[2];this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new Z.HMS(l/15),this.dec=new U.DMS(u),this.init(c)}else if((typeof e=="string"||e===null)&&(typeof i=="string"||i===null)&&(typeof t=="number"||t===null)&&n===void 0&&r===void 0&&s===void 0&&a===void 0){let f=arguments,l=f[0],u=f[1],c=f[2];this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new Z.HMS(l),this.dec=new U.DMS(u),this.init(c)}else if((typeof e=="string"||e===null)&&(typeof i=="string"||i===null)&&(typeof t=="boolean"||t===null)&&n===void 0&&r===void 0&&s===void 0&&a===void 0){let f=arguments,l=f[0],u=f[1],c=f[2];{let h=arguments,g=2e3;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new Z.HMS(l,c),this.dec=new U.DMS(u),this.init(g)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if((typeof e=="number"||e===null)&&(typeof i=="number"||i===null)&&(typeof t=="number"||t===null)&&n===void 0&&r===void 0&&s===void 0&&a===void 0){let f=arguments,l=f[0],u=f[1],c=f[2];this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new Z.HMS(l/15),this.dec=new U.DMS(u),this.init(c)}else if((e!=null&&e instanceof Z.HMS||e===null)&&(i!=null&&i instanceof U.DMS||i===null)&&t===void 0&&n===void 0&&r===void 0&&s===void 0&&a===void 0){let f=arguments,l=f[0],u=f[1];{let c=arguments,h=2e3;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=l,this.dec=u,this.init(h)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if((typeof e=="number"||e===null)&&(typeof i=="number"||i===null)&&t===void 0&&n===void 0&&r===void 0&&s===void 0&&a===void 0){let f=arguments,l=f[0],u=f[1];{let c=arguments,h=c[0],g=c[1],d=2e3;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new Z.HMS(h/15),this.dec=new U.DMS(g),this.init(d)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if((typeof e=="string"||e===null)&&(typeof i=="string"||i===null)&&t===void 0&&n===void 0&&r===void 0&&s===void 0&&a===void 0){let f=arguments,l=f[0],u=f[1];{let c=arguments,h=2e3;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new Z.HMS(l),this.dec=new U.DMS(u),this.init(h)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if((e!=null&&e instanceof Vt.Point2D||e===null)&&(typeof i=="number"||i===null)&&t===void 0&&n===void 0&&r===void 0&&s===void 0&&a===void 0){let f=arguments,l=f[0],u=f[1];{let c=arguments,h=l.getX(),g=l.getY();this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new Z.HMS(h/15),this.dec=new U.DMS(g),this.init(u)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if((typeof e=="number"||e===null)&&(typeof i=="number"||i===null)&&t===void 0&&n===void 0&&r===void 0&&s===void 0&&a===void 0){let f=arguments,l=f[0],u=f[1];{let c=arguments,h=2e3;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new Z.HMS(l/15),this.dec=new U.DMS(u),this.init(h)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if((e!=null&&e instanceof Vt.Point2D||e===null)&&i===void 0&&t===void 0&&n===void 0&&r===void 0&&s===void 0&&a===void 0){let l=arguments[0];{let u=arguments,c=l.getX(),h=l.getY(),g=2e3;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new Z.HMS(c/15),this.dec=new U.DMS(h),this.init(g)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if(e===void 0&&i===void 0&&t===void 0&&n===void 0&&r===void 0&&s===void 0&&a===void 0){let f=arguments;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new Z.HMS,this.dec=new U.DMS}else throw new Error("invalid overload")}getRA(){return this.ra}getDec(){return this.dec}getRaDeg(){return this.ra.getVal()*15}getDecDeg(){return this.dec.getVal()}getX(){return this.ra.getVal()*15}getY(){return this.dec.getVal()}toString(){return this.ra.toString$()+", "+this.dec.toString$()+" J2000"}format$double(e){let i=[null,null];if(e===2e3)i[0]=this.ra.toString$(),i[1]=this.dec.toString$();else{let t=new Y(this.ra,this.dec);t.convertEquinox(2e3,e),i[0]=t.ra.toString$(),i[1]=t.dec.toString$()}return i}format(e){if(typeof e=="number"||e===null)return this.format$double(e);if(e===void 0)return this.format$();throw new Error("invalid overload")}format$(){return this.format$double(2e3)}getRaDec(e){let i=[0,0];if(e===2e3)i[0]=this.getRaDeg(),i[1]=this.getDecDeg();else{let t=new Y(this.ra,this.dec);t.convertEquinox(2e3,e),i[0]=t.getRaDeg(),i[1]=t.getDecDeg()}return i}static dispos(e,i,t,n){let r=[0,0],s,a,f,l,u,c,h,g,d,_,x,y,m,D,v=180/Math.PI;s=t/v,a=e/v,f=n/v,l=i/v,h=Math.sin(l),c=Math.sin(f),d=Math.cos(l),g=Math.cos(f),_=Math.cos(s-a),x=h*c+d*g*_;let S=Math.acos(x);return u=0,S>4e-7&&(y=Math.sin(S),D=(c*d-g*h*_)/y,Math.abs(D)>1&&(D=D/Math.abs(D)),m=g*Math.sin(s-a)/y,u=Math.acos(D)*v,m<0&&(u=360-u)),S*=v,S*=60,i===90&&(u=180),i===-90&&(u=0),r[0]=S,r[1]=u,r}dispos(e){return Y.dispos(this.getRaDeg(),this.getDecDeg(),e.getRaDeg(),e.getDecDeg())}static wcsdist(e,i,t,n){let r,s,a,f,l,u,c,h=[0,0,0],g=[0,0,0],d,_=Math.PI/180;for(r=e*_,a=i*_,c=Math.cos(a),h[0]=Math.cos(r)*c,h[1]=Math.sin(r)*c,h[2]=Math.sin(a),s=t*_,f=n*_,c=Math.cos(f),g[0]=Math.cos(s)*c,g[1]=Math.sin(s)*c,g[2]=Math.sin(f),l=0,d=0;d<3;d++)l=l+(h[d]-g[d])*(h[d]-g[d]);return l=l/4,l>1&&(l=1),u=2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)),u*180/Math.PI}dist$coordtxl_coords_WorldCoords(e){return Y.dispos(this.getRaDeg(),this.getDecDeg(),e.getRaDeg(),e.getDecDeg())[0]}dist(e){if(e!=null&&e instanceof Y||e===null)return this.dist$coordtxl_coords_WorldCoords(e);if(e!=null&&e.constructor!=null&&e.constructor.__interfaces!=null&&e.constructor.__interfaces.indexOf("coordtxl.coords.Coordinates")>=0||e===null)return this.dist$coordtxl_coords_Coordinates(e);throw new Error("invalid overload")}dist$coordtxl_coords_Coordinates(e){return this.dist$coordtxl_coords_WorldCoords(e)}static dist(e,i,t,n){return Y.dispos(e,i,t,n)[0]}box(e){let i=[null,null],t=this.ra.getVal(),n=this.dec.getVal();e/=60;let r=Math.sqrt(2*e*e),s,a,f,l,u;return f=n-r/2,f<=-90?(f=-90,l=n+r/2,s=0,a=24):(l=n+r/2,l>=90?(f=n-r/2,l=90,s=0,a=24):(n>0?u=Math.abs(Math.cos(f*Math.PI/180)):u=Math.abs(Math.cos(l*Math.PI/180)),s=t-r/15/2/u,a=t+r/15/2/u,s<0&&(s+=24),a>24&&(a-=24))),i[0]=new Y(s*15,f),i[1]=new Y(a*15,l),i}center(e,i){let t=[0,0,0,0,0],n=e.getRaDeg(),r=e.getDecDeg(),s=i.getRaDeg(),a=i.getDecDeg();return t[0]=(n+s)/2,t[1]=(r+a)/2,t[2]=Y.wcsdist(n,r,s,r)*60,t[3]=Y.wcsdist(n,r,n,a)*60,t[4]=Y.wcsdist(n,r,s,a)*60/2,t}getCoordinateSystemName(){return"wcs"}init(e){this.checkRange(),this.convertEquinox(e,2e3)}convertEquinox(e,i){if(e===i)return;let t=[0,0],n=[0,0];t[0]=this.ra.getVal()*15,t[1]=this.dec.getVal(),oi.JPrec.prej_q(t,n,e,i),this.ra=new Z.HMS(n[0]/15),this.dec=new U.DMS(n[1])}checkRange(){let e=this.ra.getVal(),i=this.dec.getVal();e<-.001||e>=25,i<-90||i>90}};Xe.WorldCoords=Y;Y.__class="coordtxl.coords.WorldCoords";Y.__interfaces=["coordtxl.coords.WorldCoordinates","coordtxl.coords.Coordinates"];var oi=Pt(),U=It(),Z=Ot()});var Lt=B(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.WorldCoords=ae.WCSTransform=ae.MapKeywordProvider=ae.Point2D=void 0;var fi=de();Object.defineProperty(ae,"Point2D",{enumerable:!0,get:function(){return fi.Point2D}});var di=bt();Object.defineProperty(ae,"MapKeywordProvider",{enumerable:!0,get:function(){return di.MapKeywordProvider}});var ui=$e();Object.defineProperty(ae,"WCSTransform",{enumerable:!0,get:function(){return ui.WCSTransform}});var hi=wt();Object.defineProperty(ae,"WorldCoords",{enumerable:!0,get:function(){return hi.WorldCoords}})});function ht(o){if(typeof o._casagui_id_=="undefined"){let e=null;if(typeof window=="undefined"){if(typeof crypto!="undefined"){let n=crypto.randomBytes(8);e=new Uint32Array(n.buffer.slice(-4))}}else e=new Uint32Array(1),window.crypto.getRandomValues(e);let i=new Date,t=Math.floor(i.getTime()/1e3);o._casagui_id_=`${e?e[0]:t}-${t}`}return o._casagui_id_}function ct(o,e){if(Array.isArray(e))e.map(o);else if(typeof e=="object"&&e!==null)Object.entries(e).map(i=>o(i[0],i[1]));else throw new Error(`casalib.map applied to ${typeof e}`)}function Ue(o){return Array.isArray(o)&&(o.length==0||o.every(Ue))}function gt(o){if(o.length<1)return[NaN,NaN];let e,i;e=i=o[0];for(let t=o.length-1;t>0;--t)o[t]<e&&(e=o[t]),o[t]>i&&(i=o[t]);return[e,i]}function Ce(o){if(o instanceof Set)return Array.from(o).sort((e,i)=>e-i);if(Array.isArray(o))return o.slice().sort((e,i)=>e-i);throw new Error(`unexpected parameter type (${typeof o})`)}function _t(o){let e=[],i=o.split(",");for(let t of i){let[n,r]=t.trim().split(":"),s=parseInt(n,10),a=r?parseInt(r,10):s;if(isNaN(s)||isNaN(a)||s>a)throw new Error(`Invalid range: ${t}`);e.push([s,a])}return e}function pt(o){return Ce(o).reduce((i,t)=>i[0][0]==null?[[t,t]]:t>i[0][1]+1?[[t,t],...i]:[[i[0][0],t],...i.slice(1)],[[null,-1]]).reverse().map(i=>`${i[0]}:${i[1]}`).join(", ")}function mt(o,e,i,t){let n=t;for(let r=o;r<=e;r++)n=i(n,r,r-o);return n}function yt(){this.timeout=1e3,this.retries=20,this.connected=!0,this.backoff=()=>{this.connected=!1,this.timeout+=Math.floor(ut(1.8,22-this.retries)),this.retries-=1}}function Ze(...o){let e=Math.max(...o.map(t=>t.length)),i=[];for(let t=0;t<e;t++){let n=o.map(r=>r[t]);i.push(n)}return i}function xt(o){return o.length<=0?o:o.reduce((e,i)=>e.map((t,n)=>[...t,i[n]]),o[0].map(e=>[]))}var wi=si(Lt());var Qe=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function et(o,e,i,t){o.addEventListener?o.addEventListener(e,i,t):o.attachEvent&&o.attachEvent("on".concat(e),function(){i(window.event)})}function Kt(o,e){for(var i=e.slice(0,e.length-1),t=0;t<i.length;t++)i[t]=o[i[t].toLowerCase()];return i}function Xt(o){typeof o!="string"&&(o=""),o=o.replace(/\s/g,"");for(var e=o.split(","),i=e.lastIndexOf("");i>=0;)e[i-1]+=",",e.splice(i,1),i=e.lastIndexOf("");return e}function ci(o,e){for(var i=o.length>=e.length?o:e,t=o.length>=e.length?e:o,n=!0,r=0;r<i.length;r++)t.indexOf(i[r])===-1&&(n=!1);return n}var me={backspace:8,"\u232B":8,tab:9,clear:12,enter:13,"\u21A9":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"\u21EA":20,",":188,".":190,"/":191,"`":192,"-":Qe?173:189,"=":Qe?61:187,";":Qe?59:186,"'":222,"[":219,"]":221,"\\":220},oe={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,cmd:91,command:91},nt={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},F={16:!1,18:!1,17:!1,91:!1},X={};for(pe=1;pe<20;pe++)me["f".concat(pe)]=111+pe;var pe,q=[],Wt=!1,zt="all",Rt=[],xe=function(e){return me[e.toLowerCase()]||oe[e.toLowerCase()]||e.toUpperCase().charCodeAt(0)},gi=function(e){return Object.keys(me).find(function(i){return me[i]===e})},_i=function(e){return Object.keys(oe).find(function(i){return oe[i]===e})};function Ht(o){zt=o||"all"}function ye(){return zt||"all"}function pi(){return q.slice(0)}function mi(){return q.map(function(o){return gi(o)||_i(o)||String.fromCharCode(o)})}function yi(){var o=[];return Object.keys(X).forEach(function(e){X[e].forEach(function(i){var t=i.key,n=i.scope,r=i.mods,s=i.shortcut;o.push({scope:n,shortcut:s,mods:r,keys:t.split("+").map(function(a){return xe(a)})})})}),o}function xi(o){var e=o.target||o.srcElement,i=e.tagName,t=!0;return(e.isContentEditable||(i==="INPUT"||i==="TEXTAREA"||i==="SELECT")&&!e.readOnly)&&(t=!1),t}function bi(o){return typeof o=="string"&&(o=xe(o)),q.indexOf(o)!==-1}function Mi(o,e){var i,t;o||(o=ye());for(var n in X)if(Object.prototype.hasOwnProperty.call(X,n))for(i=X[n],t=0;t<i.length;)i[t].scope===o?i.splice(t,1):t++;ye()===o&&Ht(e||"all")}function vi(o){var e=o.keyCode||o.which||o.charCode,i=q.indexOf(e);if(i>=0&&q.splice(i,1),o.key&&o.key.toLowerCase()==="meta"&&q.splice(0,q.length),(e===93||e===224)&&(e=91),e in F){F[e]=!1;for(var t in oe)oe[t]===e&&(le[t]=!1)}}function Ci(o){if(typeof o>"u")Object.keys(X).forEach(function(s){return delete X[s]});else if(Array.isArray(o))o.forEach(function(s){s.key&&tt(s)});else if(typeof o=="object")o.key&&tt(o);else if(typeof o=="string"){for(var e=arguments.length,i=new Array(e>1?e-1:0),t=1;t<e;t++)i[t-1]=arguments[t];var n=i[0],r=i[1];typeof n=="function"&&(r=n,n=""),tt({key:o,scope:n,method:r,splitKey:"+"})}}var tt=function(e){var i=e.key,t=e.scope,n=e.method,r=e.splitKey,s=r===void 0?"+":r,a=Xt(i);a.forEach(function(f){var l=f.split(s),u=l.length,c=l[u-1],h=c==="*"?"*":xe(c);if(!!X[h]){t||(t=ye());var g=u>1?Kt(oe,l):[];X[h]=X[h].filter(function(d){var _=n?d.method===n:!0;return!(_&&d.scope===t&&ci(d.mods,g))})}})};function Nt(o,e,i,t){if(e.element===t){var n;if(e.scope===i||e.scope==="all"){n=e.mods.length>0;for(var r in F)Object.prototype.hasOwnProperty.call(F,r)&&(!F[r]&&e.mods.indexOf(+r)>-1||F[r]&&e.mods.indexOf(+r)===-1)&&(n=!1);(e.mods.length===0&&!F[16]&&!F[18]&&!F[17]&&!F[91]||n||e.shortcut==="*")&&(e.keys=[],e.keys=e.keys.concat(q),e.method(o,e)===!1&&(o.preventDefault?o.preventDefault():o.returnValue=!1,o.stopPropagation&&o.stopPropagation(),o.cancelBubble&&(o.cancelBubble=!0)))}}}function qt(o,e){var i=X["*"],t=o.keyCode||o.which||o.charCode;if(!!le.filter.call(this,o)){if((t===93||t===224)&&(t=91),q.indexOf(t)===-1&&t!==229&&q.push(t),["ctrlKey","altKey","shiftKey","metaKey"].forEach(function(d){var _=nt[d];o[d]&&q.indexOf(_)===-1?q.push(_):!o[d]&&q.indexOf(_)>-1?q.splice(q.indexOf(_),1):d==="metaKey"&&o[d]&&q.length===3&&(o.ctrlKey||o.shiftKey||o.altKey||(q=q.slice(q.indexOf(_))))}),t in F){F[t]=!0;for(var n in oe)oe[n]===t&&(le[n]=!0);if(!i)return}for(var r in F)Object.prototype.hasOwnProperty.call(F,r)&&(F[r]=o[nt[r]]);o.getModifierState&&!(o.altKey&&!o.ctrlKey)&&o.getModifierState("AltGraph")&&(q.indexOf(17)===-1&&q.push(17),q.indexOf(18)===-1&&q.push(18),F[17]=!0,F[18]=!0);var s=ye();if(i)for(var a=0;a<i.length;a++)i[a].scope===s&&(o.type==="keydown"&&i[a].keydown||o.type==="keyup"&&i[a].keyup)&&Nt(o,i[a],s,e);if(t in X){for(var f=0;f<X[t].length;f++)if((o.type==="keydown"&&X[t][f].keydown||o.type==="keyup"&&X[t][f].keyup)&&X[t][f].key){for(var l=X[t][f],u=l.splitKey,c=l.key.split(u),h=[],g=0;g<c.length;g++)h.push(xe(c[g]));h.sort().join("")===q.sort().join("")&&Nt(o,l,s,e)}}}}function Di(o){return Rt.indexOf(o)>-1}function le(o,e,i){q=[];var t=Xt(o),n=[],r="all",s=document,a=0,f=!1,l=!0,u="+",c=!1;for(i===void 0&&typeof e=="function"&&(i=e),Object.prototype.toString.call(e)==="[object Object]"&&(e.scope&&(r=e.scope),e.element&&(s=e.element),e.keyup&&(f=e.keyup),e.keydown!==void 0&&(l=e.keydown),e.capture!==void 0&&(c=e.capture),typeof e.splitKey=="string"&&(u=e.splitKey)),typeof e=="string"&&(r=e);a<t.length;a++)o=t[a].split(u),n=[],o.length>1&&(n=Kt(oe,o)),o=o[o.length-1],o=o==="*"?"*":xe(o),o in X||(X[o]=[]),X[o].push({keyup:f,keydown:l,scope:r,mods:n,shortcut:t[a],method:i,key:t[a],splitKey:u,element:s});typeof s<"u"&&!Di(s)&&window&&(Rt.push(s),et(s,"keydown",function(h){qt(h,s)},c),Wt||(Wt=!0,et(window,"focus",function(){q=[]},c)),et(s,"keyup",function(h){qt(h,s),vi(h)},c))}function Si(o){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(X).forEach(function(i){var t=X[i].filter(function(n){return n.scope===e&&n.shortcut===o});t.forEach(function(n){n&&n.method&&n.method()})})}var it={getPressedKeyString:mi,setScope:Ht,getScope:ye,deleteScope:Mi,getPressedKeyCodes:pi,getAllKeyCodes:yi,isPressed:bi,filter:xi,trigger:Si,unbind:Ci,keyMap:me,modifier:oe,modifierMap:nt};for(ze in it)Object.prototype.hasOwnProperty.call(it,ze)&&(le[ze]=it[ze]);var ze;typeof window<"u"&&(kt=window.hotkeys,le.noConflict=function(o){return o&&window.hotkeys===le&&(window.hotkeys=kt),le},window.hotkeys=le);var kt;function rt(o,e){let i=0;if(e===void 0)for(let t of o)t!=null&&(t=+t)>=t&&++i;else{let t=-1;for(let n of o)(n=e(n,++t,o))!=null&&(n=+n)>=n&&++i}return i}function Re(o,e){let i,t;if(e===void 0)for(let n of o)n!=null&&(i===void 0?n>=n&&(i=t=n):(i>n&&(i=n),t<n&&(t=n)));else{let n=-1;for(let r of o)(r=e(r,++n,o))!=null&&(i===void 0?r>=r&&(i=t=r):(i>r&&(i=r),t<r&&(t=r)))}return[i,t]}var Ai=Math.sqrt(50),Ei=Math.sqrt(10),ji=Math.sqrt(2);function He(o,e,i){let t=(e-o)/Math.max(0,i),n=Math.floor(Math.log10(t)),r=t/Math.pow(10,n),s=r>=Ai?10:r>=Ei?5:r>=ji?2:1,a,f,l;return n<0?(l=Math.pow(10,-n)/s,a=Math.round(o*l),f=Math.round(e*l),a/l<o&&++a,f/l>e&&--f,l=-l):(l=Math.pow(10,n)*s,a=Math.round(o/l),f=Math.round(e/l),a*l<o&&++a,f*l>e&&--f),f<a&&.5<=i&&i<2?He(o,e,i*2):[a,f,l]}function Ye(o,e,i){if(e=+e,o=+o,i=+i,!(i>0))return[];if(o===e)return[o];let t=e<o,[n,r,s]=t?He(e,o,i):He(o,e,i);if(!(r>=n))return[];let a=r-n+1,f=new Array(a);if(t)if(s<0)for(let l=0;l<a;++l)f[l]=(r-l)/-s;else for(let l=0;l<a;++l)f[l]=(r-l)*s;else if(s<0)for(let l=0;l<a;++l)f[l]=(n+l)/-s;else for(let l=0;l<a;++l)f[l]=(n+l)*s;return f}function st(o,e,i){return e=+e,o=+o,i=+i,He(o,e,i)[2]}function Fe(o,e,i){let t;for(;;){let n=st(o,e,i);if(n===t||n===0||!isFinite(n))return[o,e];n>0?(o=Math.floor(o/n)*n,e=Math.ceil(e/n)*n):n<0&&(o=Math.ceil(o*n)/n,e=Math.floor(e*n)/n),t=n}}function Ge(o){return Math.max(1,Math.ceil(Math.log(rt(o))/Math.LN2)+1)}var $i=Array.prototype,Yt=$i.slice;function Ft(o,e){return o-e}function Gt(o){for(var e=0,i=o.length,t=o[i-1][1]*o[0][0]-o[i-1][0]*o[0][1];++e<i;)t+=o[e-1][1]*o[e][0]-o[e-1][0]*o[e][1];return t}var at=o=>()=>o;function Ut(o,e){for(var i=-1,t=e.length,n;++i<t;)if(n=Pi(o,e[i]))return n;return 0}function Pi(o,e){for(var i=e[0],t=e[1],n=-1,r=0,s=o.length,a=s-1;r<s;a=r++){var f=o[r],l=f[0],u=f[1],c=o[a],h=c[0],g=c[1];if(Ii(f,c,e))return 0;u>t!=g>t&&i<(h-l)*(t-u)/(g-u)+l&&(n=-n)}return n}function Ii(o,e,i){var t;return Ti(o,e,i)&&Oi(o[t=+(o[0]===e[0])],i[t],e[t])}function Ti(o,e,i){return(e[0]-o[0])*(i[1]-o[1])===(i[0]-o[0])*(e[1]-o[1])}function Oi(o,e,i){return o<=e&&e<=i||i<=e&&e<=o}function Zt(){}var fe=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function ot(){var o=1,e=1,i=Ge,t=f;function n(l){var u=i(l);if(Array.isArray(u))u=u.slice().sort(Ft);else{let c=Re(l,Vi);for(u=Ye(...Fe(c[0],c[1],u),u);u[u.length-1]>=c[1];)u.pop();for(;u[1]<c[0];)u.shift()}return u.map(c=>r(l,c))}function r(l,u){let c=u==null?NaN:+u;if(isNaN(c))throw new Error(`invalid value: ${u}`);var h=[],g=[];return s(l,c,function(d){t(d,l,c),Gt(d)>0?h.push([d]):g.push(d)}),g.forEach(function(d){for(var _=0,x=h.length,y;_<x;++_)if(Ut((y=h[_])[0],d)!==-1){y.push(d);return}}),{type:"MultiPolygon",value:u,coordinates:h}}function s(l,u,c){var h=new Array,g=new Array,d,_,x,y,m,D;for(d=_=-1,y=he(l[0],u),fe[y<<1].forEach(v);++d<o-1;)x=y,y=he(l[d+1],u),fe[x|y<<1].forEach(v);for(fe[y<<0].forEach(v);++_<e-1;){for(d=-1,y=he(l[_*o+o],u),m=he(l[_*o],u),fe[y<<1|m<<2].forEach(v);++d<o-1;)x=y,y=he(l[_*o+o+d+1],u),D=m,m=he(l[_*o+d+1],u),fe[x|y<<1|m<<2|D<<3].forEach(v);fe[y|m<<3].forEach(v)}for(d=-1,m=l[_*o]>=u,fe[m<<2].forEach(v);++d<o-1;)D=m,m=he(l[_*o+d+1],u),fe[m<<2|D<<3].forEach(v);fe[m<<3].forEach(v);function v(S){var I=[S[0][0]+d,S[0][1]+_],$=[S[1][0]+d,S[1][1]+_],W=a(I),O=a($),C,E;(C=g[W])?(E=h[O])?(delete g[C.end],delete h[E.start],C===E?(C.ring.push($),c(C.ring)):h[C.start]=g[E.end]={start:C.start,end:E.end,ring:C.ring.concat(E.ring)}):(delete g[C.end],C.ring.push($),g[C.end=O]=C):(C=h[O])?(E=g[W])?(delete h[C.start],delete g[E.end],C===E?(C.ring.push($),c(C.ring)):h[E.start]=g[C.end]={start:E.start,end:C.end,ring:E.ring.concat(C.ring)}):(delete h[C.start],C.ring.unshift(I),h[C.start=W]=C):h[W]=g[O]={start:W,end:O,ring:[I,$]}}}function a(l){return l[0]*2+l[1]*(o+1)*4}function f(l,u,c){l.forEach(function(h){var g=h[0],d=h[1],_=g|0,x=d|0,y=lt(u[x*o+_]);g>0&&g<o&&_===g&&(h[0]=Bt(g,lt(u[x*o+_-1]),y,c)),d>0&&d<e&&x===d&&(h[1]=Bt(d,lt(u[(x-1)*o+_]),y,c))})}return n.contour=r,n.size=function(l){if(!arguments.length)return[o,e];var u=Math.floor(l[0]),c=Math.floor(l[1]);if(!(u>=0&&c>=0))throw new Error("invalid size");return o=u,e=c,n},n.thresholds=function(l){return arguments.length?(i=typeof l=="function"?l:Array.isArray(l)?at(Yt.call(l)):at(l),n):i},n.smooth=function(l){return arguments.length?(t=l?f:Zt,n):t===f},n}function Vi(o){return isFinite(o)?o:NaN}function he(o,e){return o==null?!1:+o>=e}function lt(o){return o==null||isNaN(o=+o)?-1/0:o}function Bt(o,e,i,t){let n=t-e,r=i-e,s=isFinite(n)||isFinite(r)?n/r:Math.sign(n)/Math.sign(r);return isNaN(s)?o:o+s-.5}function be(o){for(var e=-1,i=o.length,t,n=o[i-1],r=0;++e<i;)t=n,n=o[e],r+=t[1]*n[0]-t[0]*n[1];return r/2}function ft(o,e){for(var i=o.length,t=o[i-1],n=e[0],r=e[1],s=t[0],a=t[1],f,l,u=!1,c=0;c<i;++c)t=o[c],f=t[0],l=t[1],l>r!=a>r&&n<(s-f)*(r-l)/(a-l)+f&&(u=!u),s=f,a=l;return u}function Li(o,e){return typeof o=="object"&&o&&e in o}function Wi(o){if(!Array.isArray(o))return!1;for(let e of o)if(!Array.isArray(e)||e.length!==2||typeof e[0]!="number"||typeof e[1]!="number")return!1;return!0}function Ni(o,e){return o.length<=0?0:(Wi(o)&&be(o),be(Ze(o,e)))}var Jt={is_empty:Ue,minmax:gt,sorted:Ce,strparse_intranges:_t,intlist_to_rangestr:pt,map:ct,zip:Ze,unzip:xt,forexpr:mt,object_id:ht,coordtxl:wi,hotkeys:le,ReconnectState:yt,polyArea:Ni,d3:{contours:ot,polygonContains:ft,polygonArea:be},_dummy:void 0};typeof Bokeh!="undefined"&&typeof Bokeh._dummy!="undefined"&&(Jt._dummy=Bokeh._dummy);window.casalib=Jt;window.hasprop=Li;})();
