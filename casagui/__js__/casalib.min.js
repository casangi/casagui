(()=>{var Ht=Object.create;var at=Object.defineProperty;var Yt=Object.getOwnPropertyDescriptor;var Ft=Object.getOwnPropertyNames;var Gt=Object.getPrototypeOf,Ut=Object.prototype.hasOwnProperty;var lt=Math.pow;var B=(d,e)=>()=>(e||d((e={exports:{}}).exports,e),e.exports);var Zt=(d,e,i,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Ft(e))!Ut.call(d,n)&&n!==i&&at(d,n,{get:()=>e[n],enumerable:!(t=Yt(e,n))||t.enumerable});return d};var Bt=(d,e,i)=>(i=d!=null?Ht(Gt(d)):{},Zt(e||!d||!d.__esModule?at(i,"default",{value:d,enumerable:!0}):i,d));var de=B(be=>{"use strict";Object.defineProperty(be,"__esModule",{value:!0});be.Point2D=void 0;var He=class{getX(){return this.x}setX(e){this.x=e}getY(){return this.y}setY(e){this.y=e}setLocation(e,i){this.x=e,this.y=i}constructor(e,i){if((typeof e=="number"||e===null)&&(typeof i=="number"||i===null)){let t=arguments;this.x===void 0&&(this.x=0),this.y===void 0&&(this.y=0),this.x=e,this.y=i}else if(e===void 0&&i===void 0){let t=arguments;this.x===void 0&&(this.x=0),this.y===void 0&&(this.y=0),this.x=0,this.y=0}else throw new Error("invalid overload")}};be.Point2D=He;He.__class="coordtxl.geom.Point2D"});var ut=B(ve=>{"use strict";Object.defineProperty(ve,"__esModule",{value:!0});ve.MapKeywordProvider=void 0;var Me=class{constructor(e){this.wcsMap===void 0&&(this.wcsMap=null),this.wcsMap={};{let i=Object.keys(e);for(let t=0;t<i.length;t++){let n=i[t];if(((s,r)=>s[r]===void 0?null:s[r])(e,n)!=null&&((s,r)=>s[r]===void 0?null:s[r])(e,n)instanceof Array){let s=((a,f)=>a[f]===void 0?null:a[f])(e,n);this.wcsMap[n]=(a=>{if(a.clone!=null)return a.clone();{let f=Object.create(a);for(let l in a)a.hasOwnProperty(l)&&(f[l]=a[l]);return f}})(s);let r=1;for(let a=0;a<s.length;a++){let f=s[a];this.wcsMap[n+r]=f,r+=1}}else this.wcsMap[n]=((s,r)=>s[r]===void 0?null:s[r])(e,n)}}}findKey(e){return this.wcsMap.hasOwnProperty(e)}getStringValue$java_lang_String(e){return this.getStringValue$java_lang_String$java_lang_String(e,null)}getStringValue$java_lang_String$java_lang_String(e,i){return this.wcsMap.hasOwnProperty(e)?((t,n)=>t[n]===void 0?null:t[n])(this.wcsMap,e).toString():i}getStringValue(e,i){if((typeof e=="string"||e===null)&&(typeof i=="string"||i===null))return this.getStringValue$java_lang_String$java_lang_String(e,i);if((typeof e=="string"||e===null)&&i===void 0)return this.getStringValue$java_lang_String(e);throw new Error("invalid overload")}getDoubleValue$java_lang_String(e){return this.getDoubleValue$java_lang_String$double(e,0)}getDoubleValue$java_lang_String$double(e,i){if(!this.wcsMap.hasOwnProperty(e))return i;let t=((n,s)=>n[s]===void 0?null:n[s])(this.wcsMap,e);return typeof t=="number"?t:i}getDoubleValue(e,i){if((typeof e=="string"||e===null)&&(typeof i=="number"||i===null))return this.getDoubleValue$java_lang_String$double(e,i);if((typeof e=="string"||e===null)&&i===void 0)return this.getDoubleValue$java_lang_String(e);throw new Error("invalid overload")}getFloatValue$java_lang_String(e){return this.getFloatValue$java_lang_String$float(e,Math.fround(0))}getFloatValue$java_lang_String$float(e,i){if(!this.wcsMap.hasOwnProperty(e))return i;let t=((n,s)=>n[s]===void 0?null:n[s])(this.wcsMap,e);return typeof t=="number"?t:i}getFloatValue(e,i){if((typeof e=="string"||e===null)&&(typeof i=="number"||i===null))return this.getFloatValue$java_lang_String$float(e,i);if((typeof e=="string"||e===null)&&i===void 0)return this.getFloatValue$java_lang_String(e);throw new Error("invalid overload")}getIntValue$java_lang_String(e){return this.getIntValue$java_lang_String$int(e,0)}getIntValue$java_lang_String$int(e,i){if(!this.wcsMap.hasOwnProperty(e))return i;let t=((n,s)=>n[s]===void 0?null:n[s])(this.wcsMap,e);return typeof t=="number"?t|0:i}getIntValue(e,i){if((typeof e=="string"||e===null)&&(typeof i=="number"||i===null))return this.getIntValue$java_lang_String$int(e,i);if((typeof e=="string"||e===null)&&i===void 0)return this.getIntValue$java_lang_String(e);throw new Error("invalid overload")}toString(){let e=!1,i={str:"{ ",toString:function(){return this.str}};{let t=Object.keys(this.wcsMap);for(let n=0;n<t.length;n++){let s=t[n];{e?(a=>(a.str+=", ",a))(i):e=!0,(a=>(a.str+=s,a))(i),(a=>(a.str+="=",a))(i);let r=((a,f)=>a[f]===void 0?null:a[f])(this.wcsMap,s);if(typeof r=="string")(a=>(a.str+='"',a))(i),(a=>(a.str+=r,a))(i),(a=>(a.str+='"',a))(i);else if(r!=null&&r instanceof Array){let a=r,f="[";for(let l=0;l<a.length;++l){l!==0&&(f+=", ");let h=a[l];typeof h=="string"?f+='"'+h+'"':f+=h}f+="]",(l=>(l.str+=f,l))(i)}else(a=>(a.str+=r,a))(i)}}}return(t=>(t.str+=" }",t))(i),i.str}};ve.MapKeywordProvider=Me;Me.__class="coordtxl.coords.MapKeywordProvider";Me.__interfaces=["coordtxl.coords.WCSKeywordProvider"]});var ct=B(Ce=>{"use strict";Object.defineProperty(Ce,"__esModule",{value:!0});Ce.slasubs=void 0;var Jt=de(),ie=class{static slaDcs2c(e,i){let t=Math.cos(i),n=[0,0,0];return n[0]=Math.cos(e)*t,n[1]=Math.sin(e)*t,n[2]=Math.sin(i),n}static slaDmxv(e,i){let t,n,s,r=[0,0,0],a=[0,0,0];for(n=0;n<3;n++){for(s=0,t=0;t<3;t++)s+=e[n][t]*i[t];r[n]=s}for(n=0;n<3;n++)a[n]=r[n];return a}static slaDcc2s(e){let i,t,n,s;i=e[0],t=e[1],n=e[2],s=Math.sqrt(i*i+t*t);let r=new Jt.Point2D;return r.x=s!==0?Math.atan2(t,i):0,r.y=n!==0?Math.atan2(n,s):0,r}static slaDranrm(e){let i;return i=((t,n)=>{let s=Math.abs(t%n);return isNaN(s)||s==n||s<=Math.abs(n)/2?s:(t>0?1:-1)*(s-n)})(e,ie.D2PI),i>=0?i:i+ie.D2PI}static slaDeuler(e,i,t,n){let s,r,a,f,l,h=function(y){let D=function(v){if(v.length===0)return 0;{let S=[];for(let I=0;I<v[0];I++)S.push(D(v.slice(1)));return S}};return D(y)}([3,3]),c=function(y){let D=function(v){if(v.length===0)return 0;{let S=[];for(let I=0;I<v[0];I++)S.push(D(v.slice(1)));return S}};return D(y)}([3,3]),u,g,o,_,x=function(y){let D=function(v){if(v.length===0)return 0;{let S=[];for(let I=0;I<v[0];I++)S.push(D(v.slice(1)));return S}};return D(y)}([3,3]),m;for(s=0;s<3;s++)for(r=0;r<3;r++)h[r][s]=r===s?1:0;for(a=e.length,f=0;f<3;f++)if(f<=a){for(s=0;s<3;s++)for(r=0;r<3;r++)c[r][s]=r===s?1:0;switch(f){case 0:default:u=i;break;case 1:u=t;break;case 2:u=n;break}for(g=Math.sin(u),o=Math.cos(u),m=e.charAt(f),(y=>y.charCodeAt==null?y:y.charCodeAt(0))(m)=="X".charCodeAt(0)||(y=>y.charCodeAt==null?y:y.charCodeAt(0))(m)=="x".charCodeAt(0)||(y=>y.charCodeAt==null?y:y.charCodeAt(0))(m)=="1".charCodeAt(0)?(c[1][1]=o,c[1][2]=g,c[2][1]=-g,c[2][2]=o):(y=>y.charCodeAt==null?y:y.charCodeAt(0))(m)=="Y".charCodeAt(0)||(y=>y.charCodeAt==null?y:y.charCodeAt(0))(m)=="y".charCodeAt(0)||(y=>y.charCodeAt==null?y:y.charCodeAt(0))(m)=="2".charCodeAt(0)?(c[0][0]=o,c[0][2]=-g,c[2][0]=g,c[2][2]=o):(y=>y.charCodeAt==null?y:y.charCodeAt(0))(m)=="Z".charCodeAt(0)||(y=>y.charCodeAt==null?y:y.charCodeAt(0))(m)=="z".charCodeAt(0)||(y=>y.charCodeAt==null?y:y.charCodeAt(0))(m)=="3".charCodeAt(0)?(c[0][0]=o,c[0][1]=g,c[1][0]=-g,c[1][1]=o):a=0,r=0;r<3;r++)for(s=0;s<3;s++){for(_=0,l=0;l<3;l++)_+=c[r][l]*h[l][s];x[r][s]=_}for(s=0;s<3;s++)for(r=0;r<3;r++)h[r][s]=x[r][s]}return h}static slDE2H(e,i,t){let n=[0,0],s=Math.sin(e),r=Math.cos(e),a=Math.sin(i),f=Math.cos(i),l=Math.sin(t),h=Math.cos(t),c=-r*f*l+a*h,u=-s*f,g=r*f*h+a*l,o=Math.sqrt(c*c+u*u),_;return o===0?_=0:_=Math.atan2(u,c),_<0&&(_=_+2*Math.PI),n[0]=_,n[1]=Math.atan2(g,o),n}static slDVTP(e,i){let t,n=e[0],s=e[1],r=e[2],a=i[0],f=i[1],l=i[2],h=a*a+f*f,c=Math.sqrt(h);c===0&&(c=1e-20,a=c);let u=n*a+s*f,g=u+r*l;g>ie.TINY?t=0:g>=0?(t=1,g=ie.TINY):g>-ie.TINY?(t=2,g=-ie.TINY):t=3,g=g*c;let o=(s*a-n*f)/g,_=(r*h-l*u)/g;return t!==0&&console.info("ERROR: From slDVTP, J = "+t),[o,_]}};Ce.slasubs=ie;ie.TINY=1e-6;ie.D2PI=6.283185307179586;ie.__class="coordtxl.coords.slasubs"});var gt=B(De=>{"use strict";Object.defineProperty(De,"__esModule",{value:!0});De.wcscon=void 0;var z=de(),M=class{static a_$LI$(){return M.a==null&&(M.a=[-162557e-11,-31919e-11,-13843e-11]),M.a}static ad_$LI$(){return M.ad==null&&(M.ad=[.001245,-.00158,-659e-6]),M.ad}static emi_$LI$(){return M.emi==null&&(M.emi=[[.99992567949991,-.011181482788805,-.004859004008828,-.000541640798032,-.237963047085011,.436218238658637],[.011181482840782,.999937484898031,-27155744957e-15,.237912530551179,-.00266070648897,-.008537588719453],[.004859003889183,-27177143501e-15,.999988194601879,-.436101961325347,.012258830424865,.002119065556992],[-2423898405e-15,27105439e-15,11777422e-15,.999904322043106,-.011181451601069,-.004858519608686],[-27105439e-15,-2423927017e-15,65851e-15,.011181451608968,.999916125340107,-27162614355e-15],[-11777422e-15,65846e-15,-2424049954e-15,.004858519590501,-27165866691e-15,.999966838131419]]),M.emi}static fk524(e){let i=new z.Point2D(0,0);return M.fk524m(e,i)}static fk524e(e,i){let t=new z.Point2D(0,0),n=M.fk524m(e,t);return n.x=n.x+t.x*(i-1950),n.y=n.y+t.y*(i-1950),n}static fk524m(e,i){let t,n,s,r,a,f,l,h,c,u,g,o,_,x,m,y,D,v,S=[0,0,0,0,0,0],I=[0,0,0,0,0,0],$,W,O,C,E,V,P,p,b=6.283185307179586,A,N=1e-30,j=0;for(A=100*60*60*360/b,t=T.WCSTransform.degrad(e.x),n=T.WCSTransform.degrad(e.y),s=T.WCSTransform.degrad(i.x),r=T.WCSTransform.degrad(i.y),c=s*A,u=r*A,g=Math.sin(t),o=Math.cos(t),_=Math.sin(n),x=Math.cos(n),m=o*x,y=g*x,D=_,S[0]=m,S[1]=y,S[2]=D,c!==j||u!==j?(S[3]=-(c*y)-o*_*u,S[4]=c*m-g*_*u,S[5]=x*u):(S[3]=j,S[4]=j,S[5]=j),P=0;P<6;P++){for(v=j,p=0;p<6;p++)v=v+M.emi_$LI$()[p][P]*S[p];I[P]=v}return m=I[0],y=I[1],D=I[2],$=I[3],W=I[4],O=I[5],C=Math.sqrt(m*m+y*y+D*D),m=m+M.a_$LI$()[0]*C,y=y+M.a_$LI$()[1]*C,D=D+M.a_$LI$()[2]*C,$=$+M.ad_$LI$()[0]*C,W=W+M.ad_$LI$()[1]*C,O=O+M.ad_$LI$()[2]*C,E=m*m+y*y,V=Math.sqrt(E),m===j&&y===j?a=j:(a=Math.atan2(y,m),a<j&&(a=a+b)),f=Math.atan2(D,V),V>N&&(c=(m*W-y*$)/E,u=(O*E-D*(m*$+y*W))/((E+D*D)*V)),l=c/A,h=u/A,e.x=T.WCSTransform.raddeg(a),e.y=T.WCSTransform.raddeg(f),i.x=T.WCSTransform.raddeg(l),i.y=T.WCSTransform.raddeg(h),e}static em_$LI$(){return M.em==null&&(M.em=[[.999925678186902,.011182059571766,.004857946721186,-.000541652366951,.237917612131583,-.43611127603927],[-.011182059642247,.999937478448132,-27147426498e-15,-.237968129744288,-.002660763319071,.012259092261564],[-.00485794655896,-27176441185e-15,.99998819973877,.436227555856097,-.008537771074048,.002119110818172],[2423950176e-15,27106627e-15,11776559e-15,.999947035154614,.011182506007242,.00485766994865],[-27106627e-15,2423978783e-15,-65816e-15,-.011182506121805,.999958833818833,-27137309539e-15],[-11776558e-15,-65874e-15,2424101735e-15,-.004857669684959,-27184471371e-15,1.000009560363559]]),M.em}static fk425(e){let i=new z.Point2D(0,0);return M.fk425m(e,i)}static fk425e(e,i){let t=new z.Point2D(0,0),n=M.fk425m(e,t);return n.x=n.x+t.x*(i-2e3),n.y=n.y+t.y*(i-2e3),n}static fk425m(e,i){let t,n,s,r,a,f,l,h,c,u,g,o,_,x,m,y,D,v,S,I,$,W,O,C,E,V,P,p,b=[0,0,0],A=[0,0,0],N=[0,0,0,0,0,0],j=[0,0,0,0,0,0],L=6.283185307179586,k,te=1e-30,J=0;for(k=100*60*60*360/L,t=T.WCSTransform.degrad(e.x),n=T.WCSTransform.degrad(e.y),s=T.WCSTransform.degrad(i.x),r=T.WCSTransform.degrad(i.y),c=s*k,u=r*k,g=Math.sin(t),o=Math.cos(t),_=Math.sin(n),x=Math.cos(n),b[0]=o*x,b[1]=g*x,b[2]=_,A[0]=-g*x*c-o*_*u,A[1]=o*x*c-g*_*u,A[2]=x*u,m=b[0]*M.a_$LI$()[0]+b[1]*M.a_$LI$()[1]+b[2]*M.a_$LI$()[2],y=b[0]*M.ad_$LI$()[0]+b[1]*M.ad_$LI$()[1]+b[2]*M.ad_$LI$()[2],P=0;P<3;P++)N[P]=b[P]-M.a_$LI$()[P]+m*b[P],N[P+3]=A[P]-M.ad_$LI$()[P]+y*b[P];for(P=0;P<6;P++){for(m=J,p=0;p<6;p++)m=m+M.em_$LI$()[p][P]*N[p];j[P]=m}return D=j[0],v=j[1],S=j[2],I=j[3],$=j[4],W=j[5],O=D*D+v*v,C=O+S*S,E=Math.sqrt(O),V=D*I+v*$,D===J&&v===J?a=J:(a=Math.atan2(v,D),a<J&&(a=a+L)),f=Math.atan2(S,E),E>te&&(c=(D*$-v*I)/O,u=(W*O-S*V)/(C*E)),l=c/k,h=u/k,e.x=T.WCSTransform.raddeg(a),e.y=T.WCSTransform.raddeg(f),i.x=T.WCSTransform.raddeg(l),i.y=T.WCSTransform.raddeg(h),e}static bgal_$LI$(){return M.bgal==null&&(M.bgal=[[-.066988739415,-.872755765852,-.483538914632],[.492728466075,-.45034695802,.744584633283],[-.867600811151,-.188374601723,.460199784784]]),M.bgal}static fk42gal(e){let i=[0,0,0],t=[0,0,0],n,s,r,a,f,l,h;f=e.x,l=e.y,r=T.WCSTransform.degrad(f),a=T.WCSTransform.degrad(l);let c=new z.Point2D,u=new z.Point2D;for(M.jpcop(r,a,1,c,u),i[0]=c.x,i[1]=c.y,i[2]=u.x,h=0;h<3;h++)t[h]=i[0]*M.bgal_$LI$()[h][0]+i[1]*M.bgal_$LI$()[h][1]+i[2]*M.bgal_$LI$()[h][2];let g=new z.Point2D,o=new z.Point2D;return M.jpcon(t,g,o),n=T.WCSTransform.raddeg(g.x),s=T.WCSTransform.raddeg(g.y),e.x=n,e.y=s,M.idg>0,e}static gal2fk4(e){let i=[0,0,0],t=[0,0,0],n,s,r,a,f,l,h;n=e.x,s=e.y,r=T.WCSTransform.degrad(n),a=T.WCSTransform.degrad(s);let c=new z.Point2D,u=new z.Point2D;for(M.jpcop(r,a,1,c,u),i[0]=c.x,i[1]=c.y,i[2]=u.x,h=0;h<3;h++)t[h]=i[0]*M.bgal_$LI$()[0][h]+i[1]*M.bgal_$LI$()[1][h]+i[2]*M.bgal_$LI$()[2][h];let g=new z.Point2D,o=new z.Point2D;return M.jpcon(t,g,o),f=T.WCSTransform.raddeg(g.x),l=T.WCSTransform.raddeg(g.y),e.x=f,e.y=l,M.idg>0,e}static jgal_$LI$(){return M.jgal==null&&(M.jgal=[[-.054875539726,-.87343710801,-.483834985808],[.494109453312,-.444829589425,.74698225181],[-.867666135858,-.198076386122,.455983795705]]),M.jgal}static fk52gal(e){let i=[0,0,0],t=[0,0,0],n,s,r,a,f,l,h;f=e.x,l=e.y,r=T.WCSTransform.degrad(f),a=T.WCSTransform.degrad(l);let c=new z.Point2D,u=new z.Point2D;for(M.jpcop(r,a,1,c,u),i[0]=c.x,i[1]=c.y,i[2]=u.x,h=0;h<3;h++)t[h]=i[0]*M.jgal_$LI$()[h][0]+i[1]*M.jgal_$LI$()[h][1]+i[2]*M.jgal_$LI$()[h][2];let g=new z.Point2D,o=new z.Point2D;return M.jpcon(t,g,o),n=T.WCSTransform.raddeg(g.x),s=T.WCSTransform.raddeg(g.y),e.x=n,e.y=s,M.idg>0,e}static gal2fk5(e){let i=[0,0,0],t=[0,0,0],n,s,r,a,f,l,h;n=e.x,s=e.y,r=T.WCSTransform.degrad(n),a=T.WCSTransform.degrad(s);let c=new z.Point2D,u=new z.Point2D;for(M.jpcop(r,a,1,c,u),i[0]=c.x,i[1]=c.y,i[2]=u.x,h=0;h<3;h++)t[h]=i[0]*M.jgal_$LI$()[0][h]+i[1]*M.jgal_$LI$()[1][h]+i[2]*M.jgal_$LI$()[2][h];let g=new z.Point2D,o=new z.Point2D;return M.jpcon(t,g,o),f=T.WCSTransform.raddeg(g.x),l=T.WCSTransform.raddeg(g.y),e.x=f,e.y=l,M.idg>0,e}static jpcon(e,i,t){let n,s,r,a,f,l;n=e[0],s=e[1],r=e[2],i.x=Math.atan2(s,n),i.x<0&&(i.x=i.x+6.283185307179586),f=n*n+s*s,a=Math.sqrt(f),i.y=Math.atan2(r,a),l=r*r,t.x=Math.sqrt(f+l)}static jpcop(e,i,t,n,s){n.x=t*Math.cos(e)*Math.cos(i),n.y=t*Math.sin(e)*Math.cos(i),s.x=t*Math.sin(i)}static fk4prec(e,i,t){let n=T.WCSTransform.degrad(t.x),s=T.WCSTransform.degrad(t.y),r=M.mprecfk4(e,i),a=ne.slasubs.slaDcs2c(n,s),f=ne.slasubs.slaDmxv(r,a),l=ne.slasubs.slaDcc2s(f);return n=l.x,s=l.y,n=ne.slasubs.slaDranrm(n),t.x=T.WCSTransform.raddeg(n),t.y=T.WCSTransform.raddeg(s),t}static fk5prec(e,i,t){let n=T.WCSTransform.degrad(t.x),s=T.WCSTransform.degrad(t.y),r=M.mprecfk5(e,i),a=ne.slasubs.slaDcs2c(n,s),f=ne.slasubs.slaDmxv(r,a),l=ne.slasubs.slaDcc2s(f);return n=l.x,s=l.y,n=ne.slasubs.slaDranrm(n),t.x=T.WCSTransform.raddeg(n),t.y=T.WCSTransform.raddeg(s),t}static mprecfk4(e,i){let t,n,s,r,a,f,l;return t=(e-1850)/100,n=(i-e)/100,s=n*M.DAS2R,r=2303.5548+(1.3972+59e-6*t)*t,a=(r+(.30242-269e-6*t+.017996*n)*n)*s,f=(r+(1.09478+387e-6*t+.018324*n)*n)*s,l=(2005.1125+(-.85294-365e-6*t)*t+(-.42647-365e-6*t-.041802*n)*n)*s,ne.slasubs.slaDeuler("ZYZ",-a,l,-f)}static mprecfk5(e,i){let t,n,s,r,a,f,l;return t=(e-2e3)/100,n=(i-e)/100,s=n*M.DAS2R,r=2306.2181+(1.39656-139e-6*t)*t,a=(r+(.30188-344e-6*t+.017998*n)*n)*s,f=(r+(1.09468+66e-6*t+.018203*n)*n)*s,l=(2004.3109+(-.8533-217e-6*t)*t+(-.42665-217e-6*t-.041833*n)*n)*s,ne.slasubs.slaDeuler("ZYZ",-a,l,-f)}};De.wcscon=M;M.idg=0;M.DAS2R=484813681109536e-20;M.__class="coordtxl.coords.wcscon";var ne=ct(),T=Se()});var _t=B(Ae=>{"use strict";Object.defineProperty(Ae,"__esModule",{value:!0});Ae.worldpos=void 0;var Ye=de(),Fe=class{static getPosition(e,i,t){let n,s,r,a,f,l,h,c,u=0,g=0,o,_,x,m,y,D,v,S,I,$,W,O,C,E,V,P=.01745329252,p=6.28318530717959,b=1e-5,A,N,j,L,k,te,J,me=t.pcode,ue,xe;if(A=t.xref,N=t.yref,j=t.xrefpix,L=t.yrefpix,k=t.xinc,te=t.yinc,J=w.WCSTransform.degrad(t.rot),n=Math.cos(J),s=Math.sin(J),r=e-j,a=i-L,t.rotmat>0)l=r*t.cd11+a*t.cd12,a=r*t.cd21+a*t.cd22,r=l;else{if(k===0||te===0)return null;r=r*k,a=a*te,J!==0&&(l=r*n-a*s,a=r*s+a*n,r=l)}if(ue=A+r,xe=N+a,me<0)return new Ye.Point2D(ue,xe);switch(t.coorflip>0?(I=w.WCSTransform.degrad(A),$=w.WCSTransform.degrad(N),l=r,r=a,a=l):($=w.WCSTransform.degrad(A),I=w.WCSTransform.degrad(N)),_=w.WCSTransform.degrad(r),x=w.WCSTransform.degrad(a),h=_*_+x*x,v=Math.cos(I),S=Math.sin(I),me){case-1:case 0:g=$+_,u=I+x;break;case 1:if(c=Math.sqrt(1-h),o=S*c+v*x,o>1||o<-1||(u=Math.asin(o),g=v*c-S*x,g===0&&_===0))return null;g=Math.atan2(_,g)+$;break;case 2:if(u=v-x*S,u===0)return null;g=$+Math.atan2(_,u),u=Math.atan(Math.cos(g-$)*(x*v+S)/u);break;case 3:if(h>=p*p/4||(h=Math.sqrt(h),c=Math.cos(h),h!==0?h=Math.sin(h)/h:h=1,o=x*v*h+S*c,o>1||o<-1)||(u=Math.asin(o),y=c-o*S,o=_*h*v,y===0&&o===0))return null;g=$+Math.atan2(o,y);break;case 4:if(u=v-x*S,u===0||(g=$+Math.atan2(_,u),o=Math.cos(g-$),o===0)||(u=u/o,u>1||u<-1))return null;u=Math.acos(u),I<0&&(u=-u);break;case 5:if(u=I+x,Math.abs(u)>p/4||(c=Math.cos(u),Math.abs(_)>p*c/2))return null;g=$,c>b&&(g=g+_/c);break;case 6:if(o=te*n+k*s,o===0&&(o=1),a=w.WCSTransform.degrad(N/2+45),r=a+o/2*P,a=Math.log(Math.tan(a)),r=Math.log(Math.tan(r)),E=w.WCSTransform.degrad(o)/(r-a),V=E*a,C=Math.cos(w.WCSTransform.degrad(N)),C<=0&&(C=1),g=_/C+$,Math.abs(g-$)>p)return null;o=0,E!==0&&(o=(x+V)/E),o=Math.exp(o),u=2*Math.atan(o)-p/4;break;case 7:if(o=te*n+k*s,o===0&&(o=1),o=w.WCSTransform.degrad(o),a=w.WCSTransform.degrad(N),r=Math.sin(a+o)/Math.sqrt((1+Math.cos(a+o))/2)-Math.sin(a)/Math.sqrt((1+Math.cos(a))/2),r===0&&(r=1),E=o/r,o=k*n-te*s,o===0&&(o=1),o=w.WCSTransform.degrad(o),r=2*Math.cos(a)*Math.sin(o/2),r===0&&(r=1),C=o*Math.sqrt((1+Math.cos(a)*Math.cos(o/2))/2)/r,V=E*Math.sin(a)/Math.sqrt((1+Math.cos(a))/2),g=$,u=I,_===0&&x===0)break;if(f=4-_*_/(4*C*C)-(x+V)/E*((x+V)/E),f>4||f<2||(f=.5*Math.sqrt(f),D=(x+V)*f/E,Math.abs(D)>1)||(D=Math.asin(D),Math.abs(Math.cos(D))<b)||(y=_*f/(2*C*Math.cos(D)),Math.abs(y)>1))return null;y=Math.asin(y),g=$+2*y,u=D;break;case 8:if(f=(4-h)/(4+h),Math.abs(f)>1||(u=f*S+x*v*(1+f)/2,Math.abs(u)>1)||(u=Math.asin(u),g=Math.cos(u),Math.abs(g)<b)||(g=_*(1+f)/(2*g),Math.abs(g)>1)||(g=Math.asin(g),m=1+Math.sin(u)*S+Math.cos(u)*v*Math.cos(g),Math.abs(m)<b))return null;m=2*(Math.sin(u)*v-Math.cos(u)*S*Math.cos(g))/m,Math.abs(m-x)>b&&(g=p/2-g),g=$+g;break}return O=g,W=u,O-$>p/2&&(O=O-p),O-$<-p/2&&(O=O+p),O<0&&(O+=p),ue=w.WCSTransform.raddeg(O),xe=w.WCSTransform.raddeg(W),new Ye.Point2D(ue,xe)}static getPixels(e,i,t){let n,s,r=0,a=0,f=0,l=0,h=0,c=0,u,g,o,_=0,x=0,m=0,y,D,v,S,I,$,W=.01745329252,O=1e-5,C=6.28318530717959,E,V,P,p,b,A,N,j;switch(E=t.xref,V=t.yref,P=t.xrefpix,p=t.yrefpix,b=t.xinc,A=t.yinc,N=w.WCSTransform.degrad(t.rot),I=Math.cos(N),S=Math.sin(N),j=t.pcode,j>0&&j<9&&(t.coorflip>0?(a=w.WCSTransform.degrad(E),r=w.WCSTransform.degrad(V),u=e-V):(r=w.WCSTransform.degrad(E),a=w.WCSTransform.degrad(V),u=e-E),j>=0&&(u>180&&(e-=360),u<-180&&(e+=360)),f=w.WCSTransform.degrad(e),l=w.WCSTransform.degrad(i),h=Math.cos(l),c=Math.sin(l),x=Math.sin(f-r)*h,_=c*Math.sin(a)+h*Math.cos(a)*Math.cos(f-r)),j){case 1:if(_<0)return null;m=c*Math.cos(a)-h*Math.sin(a)*Math.cos(f-r);break;case 2:if(_<=0)return null;m=c*Math.sin(a)+h*Math.cos(a)*Math.cos(f-r),x=x/m,m=(c*Math.cos(a)-h*Math.sin(a)*Math.cos(f-r))/m;break;case 3:m=c*Math.sin(a)+h*Math.cos(a)*Math.cos(f-r),m<-1&&(m=-1),m>1&&(m=1),m=Math.acos(m),m!==0?m=m/Math.sin(m):m=1,x=x*m,m=(c*Math.cos(a)-h*Math.sin(a)*Math.cos(f-r))*m;break;case 4:if(a===0)return null;m=(Math.cos(a)-h*Math.cos(f-r))/Math.sin(a);break;case 5:if(u=f-r,Math.abs(l)>C/4||Math.abs(a)>C/4)return null;m=l-a,x=u*h;break;case 6:if(u=A*I+b*S,u===0&&(u=1),s=w.WCSTransform.degrad(V/2+45),n=s+u/2*W,s=Math.log(Math.tan(s)),n=Math.log(Math.tan(n)),D=w.WCSTransform.degrad(u)/(n-s),v=D*s,y=Math.cos(w.WCSTransform.degrad(V)),y<=0&&(y=1),u=f-r,x=y*u,u=l/2+C/8,u=Math.tan(u),u<O)return null;m=D*Math.log(u)-v;break;case 7:if(g=(f-r)/2,Math.abs(g)>C/4||(u=A*I+b*S,u===0&&(u=1),u=w.WCSTransform.degrad(u),s=w.WCSTransform.degrad(V),n=Math.sin(s+u)/Math.sqrt((1+Math.cos(s+u))/2)-Math.sin(s)/Math.sqrt((1+Math.cos(s))/2),n===0&&(n=1),D=u/n,u=b*I-A*S,u===0&&(u=1),u=w.WCSTransform.degrad(u),n=2*Math.cos(s)*Math.sin(u/2),n===0&&(n=1),y=u*Math.sqrt((1+Math.cos(s)*Math.cos(u/2))/2)/n,v=D*Math.sin(s)/Math.sqrt((1+Math.cos(s))/2),u=Math.sqrt((1+Math.cos(l)*Math.cos(g))/2),Math.abs(u)<O))return null;x=2*y*Math.cos(l)*Math.sin(g)/u,m=D*Math.sin(l)/u-v;break;case 8:if(g=f-r,Math.abs(l)>C/4||(o=1+c*Math.sin(a)+h*Math.cos(a)*Math.cos(g),Math.abs(o)<O))return null;o=2/o,x=x*o,m=o*(c*Math.cos(a)-h*Math.sin(a)*Math.cos(g));break}j>0&&j<9?(n=w.WCSTransform.raddeg(x),s=w.WCSTransform.raddeg(m)):(n=e-E,s=i-V),t.coorflip>0&&($=n,n=s,s=$),t.rotmat>0?($=n*t.dc11+s*t.dc12,s=n*t.dc21+s*t.dc22,n=$):(N!==0&&($=n*I+s*S,s=s*I-n*S,n=$),b!==0&&(n=n/b),A!==0&&(s=s/A));let L=n+P,k=s+p;return new Ye.Point2D(L,k)}};Ae.worldpos=Fe;Fe.__class="coordtxl.coords.worldpos";var w=Se()});var yt=B(Ee=>{"use strict";Object.defineProperty(Ee,"__esModule",{value:!0});Ee.platepos=void 0;var pt=de(),X=class{static getPosition(e,i,t){let n,s,r,a,f,l,h,c,u,g,o,_,x,m,y,D,v,S;return n=e+t.x_pixel_offset-1+.5,s=i+t.y_pixel_offset-1+.5,r=(t.ppo_coeff[2]-n*t.x_pixel_size)/1e3,a=(s*t.y_pixel_size-t.ppo_coeff[5])/1e3,f=r*r,l=a*a,h=r*f,c=a*l,u=f+l,g=t.amd_x_coeff[0]*r+t.amd_x_coeff[1]*a+t.amd_x_coeff[2]+t.amd_x_coeff[3]*f+t.amd_x_coeff[4]*r*a+t.amd_x_coeff[5]*l+t.amd_x_coeff[6]*u+t.amd_x_coeff[7]*h+t.amd_x_coeff[8]*f*a+t.amd_x_coeff[9]*r*l+t.amd_x_coeff[10]*c+t.amd_x_coeff[11]*r*u+t.amd_x_coeff[12]*r*u*u,_=t.amd_y_coeff[0]*a+t.amd_y_coeff[1]*r+t.amd_y_coeff[2]+t.amd_y_coeff[3]*l+t.amd_y_coeff[4]*r*a+t.amd_y_coeff[5]*f+t.amd_y_coeff[6]*u+t.amd_y_coeff[7]*c+t.amd_y_coeff[8]*l*r+t.amd_y_coeff[9]*a*f+t.amd_y_coeff[10]*h+t.amd_y_coeff[11]*a*u+t.amd_y_coeff[12]*a*u*u,o=g/X.CONS2R,x=_/X.CONS2R,v=Math.tan(t.plate_dec),S=Math.cos(t.plate_dec),m=Math.atan2(o/S,1-x*v),y=m+t.plate_ra,y<0&&(y=y+X.TWOPI),D=Math.atan(Math.cos(m)/((1-x*v)/(x+v))),new pt.Point2D(y/X.COND2R,D/X.COND2R)}static getPixels(e,i,t){let n,s,r,a,f,l,h,c,u,g,o,_,x,m,y,D,v,S,I,$,W,O,C,E,V,P,p,b,A,N,j,L,k,te,J;for(te=e*X.COND2R,J=i*X.COND2R,I=Math.sin(J),$=Math.cos(J),W=Math.sin(t.plate_dec),O=Math.cos(t.plate_dec),C=Math.sin(te-t.plate_ra),E=Math.cos(te-t.plate_ra),n=I*W+$*O*E,s=$*C*X.CONR2S/n,r=(I*O-$*W*E)*X.CONR2S/n,j=s/t.plate_scale,L=r/t.plate_scale,k=0;k<X.MAX_ITERATIONS&&(l=j*L,h=j*j,c=L*L,u=h*L,g=c*j,y=h+c,D=y*y,o=h*j,_=c*L,x=h*h,m=c*c,V=t.amd_x_coeff[0]*j+t.amd_x_coeff[1]*L+t.amd_x_coeff[2]+t.amd_x_coeff[3]*h+t.amd_x_coeff[4]*l+t.amd_x_coeff[5]*c+t.amd_x_coeff[6]*y+t.amd_x_coeff[7]*o+t.amd_x_coeff[8]*u+t.amd_x_coeff[9]*g+t.amd_x_coeff[10]*_+t.amd_x_coeff[11]*j*y+t.amd_x_coeff[12]*j*D,P=t.amd_x_coeff[0]+t.amd_x_coeff[3]*2*j+t.amd_x_coeff[4]*L+t.amd_x_coeff[6]*2*j+t.amd_x_coeff[7]*3*h+t.amd_x_coeff[8]*2*l+t.amd_x_coeff[9]*c+t.amd_x_coeff[11]*(3*h+c)+t.amd_x_coeff[12]*(5*x+6*h*c+m),p=t.amd_x_coeff[1]+t.amd_x_coeff[4]*j+t.amd_x_coeff[5]*2*L+t.amd_x_coeff[6]*2*L+t.amd_x_coeff[8]*h+t.amd_x_coeff[9]*2*l+t.amd_x_coeff[10]*3*c+t.amd_x_coeff[11]*2*l+t.amd_x_coeff[12]*4*l*y,b=t.amd_y_coeff[0]*L+t.amd_y_coeff[1]*j+t.amd_y_coeff[2]+t.amd_y_coeff[3]*c+t.amd_y_coeff[4]*l+t.amd_y_coeff[5]*h+t.amd_y_coeff[6]*y+t.amd_y_coeff[7]*_+t.amd_y_coeff[8]*g+t.amd_y_coeff[9]*u+t.amd_y_coeff[10]*o+t.amd_y_coeff[11]*L*y+t.amd_y_coeff[12]*L*D,A=t.amd_y_coeff[1]+t.amd_y_coeff[4]*L+t.amd_y_coeff[5]*2*j+t.amd_y_coeff[6]*2*j+t.amd_y_coeff[8]*c+t.amd_y_coeff[9]*2*l+t.amd_y_coeff[10]*3*h+t.amd_y_coeff[11]*2*l+t.amd_y_coeff[12]*4*l*y,N=t.amd_y_coeff[0]+t.amd_y_coeff[3]*2*L+t.amd_y_coeff[4]*j+t.amd_y_coeff[6]*2*L+t.amd_y_coeff[7]*3*c+t.amd_y_coeff[8]*2*l+t.amd_y_coeff[9]*h+t.amd_y_coeff[11]*(h+3*c)+t.amd_y_coeff[12]*(5*m+6*h*c+x),V=V-s,b=b-r,v=(-V*N+b*p)/(P*N-p*A),S=(-b*P+V*A)/(P*N-p*A),j=j+v,L=L+S,!(Math.abs(v)<X.TOLERANCE&&Math.abs(S)<X.TOLERANCE));k++);a=(t.ppo_coeff[2]-j*1e3)/t.x_pixel_size,f=(t.ppo_coeff[5]+L*1e3)/t.y_pixel_size;let me=a-t.x_pixel_offset+1-.5,ue=f-t.y_pixel_offset+1-.5;return new pt.Point2D(me,ue)}};Ee.platepos=X;X.COND2R=.01745329252;X.CONS2R=206264.8062470964;X.TWOPI=6.28318530717959;X.MAX_ITERATIONS=50;X.TOLERANCE=5e-7;X.CONR2S=206264.8062470964;X.__class="coordtxl.coords.platepos"});var Se=B($e=>{"use strict";Object.defineProperty($e,"__esModule",{value:!0});$e.WCSTransform=void 0;var je=de(),q=class{static degrad(e){return e*Math.PI/180}static raddeg(e){return e*180/Math.PI}static hrdeg(e){return e*15}static deghr(e){return e/15}static hrrad(e){return q.degrad(q.hrdeg(e))}static radhr(e){return q.deghr(q.raddeg(e))}constructor(e,i,t,n,s,r,a,f,l,h,c,u){if((typeof e=="number"||e===null)&&(typeof i=="number"||i===null)&&(typeof t=="number"||t===null)&&(typeof n=="number"||n===null)&&(typeof s=="number"||s===null)&&(typeof r=="number"||r===null)&&(typeof a=="number"||a===null)&&(typeof f=="number"||f===null)&&(typeof l=="number"||l===null)&&(typeof h=="number"||h===null)&&(typeof c=="number"||c===null)&&(typeof u=="string"||u===null)){let g=arguments;this.xref===void 0&&(this.xref=0),this.yref===void 0&&(this.yref=0),this.xrefpix===void 0&&(this.xrefpix=0),this.yrefpix===void 0&&(this.yrefpix=0),this.xinc===void 0&&(this.xinc=0),this.yinc===void 0&&(this.yinc=0),this.rot===void 0&&(this.rot=0),this.crot===void 0&&(this.crot=0),this.srot===void 0&&(this.srot=0),this.cd11===void 0&&(this.cd11=0),this.cd12===void 0&&(this.cd12=0),this.cd21===void 0&&(this.cd21=0),this.cd22===void 0&&(this.cd22=0),this.dc11===void 0&&(this.dc11=0),this.dc12===void 0&&(this.dc12=0),this.dc21===void 0&&(this.dc21=0),this.dc22===void 0&&(this.dc22=0),this.mrot===void 0&&(this.mrot=0),this.cmrot===void 0&&(this.cmrot=0),this.smrot===void 0&&(this.smrot=0),this.xmpix===void 0&&(this.xmpix=0),this.ympix===void 0&&(this.ympix=0),this.equinox===void 0&&(this.equinox=0),this.epoch===void 0&&(this.epoch=0),this.nxpix===void 0&&(this.nxpix=0),this.nypix===void 0&&(this.nypix=0),this.plate_ra===void 0&&(this.plate_ra=0),this.plate_dec===void 0&&(this.plate_dec=0),this.plate_scale===void 0&&(this.plate_scale=0),this.x_pixel_offset===void 0&&(this.x_pixel_offset=0),this.y_pixel_offset===void 0&&(this.y_pixel_offset=0),this.x_pixel_size===void 0&&(this.x_pixel_size=0),this.y_pixel_size===void 0&&(this.y_pixel_size=0),this.xpix===void 0&&(this.xpix=0),this.ypix===void 0&&(this.ypix=0),this.xpos===void 0&&(this.xpos=0),this.ypos===void 0&&(this.ypos=0),this.pcode===void 0&&(this.pcode=0),this.changesys===void 0&&(this.changesys=0),this.printsys===void 0&&(this.printsys=0),this.ndec===void 0&&(this.ndec=0),this.degout===void 0&&(this.degout=0),this.tabsys===void 0&&(this.tabsys=0),this.rotmat===void 0&&(this.rotmat=0),this.coorflip===void 0&&(this.coorflip=0),this.offscl===void 0&&(this.offscl=0),this.plate_fit===void 0&&(this.plate_fit=0),this.wcson===void 0&&(this.wcson=0),this.detector===void 0&&(this.detector=0),this.fCenterRa===void 0&&(this.fCenterRa=0),this.fCenterDec===void 0&&(this.fCenterDec=0),this.fHalfWidthRa===void 0&&(this.fHalfWidthRa=0),this.fHalfWidthDec===void 0&&(this.fHalfWidthDec=0),this.fWidthDeg===void 0&&(this.fWidthDeg=0),this.fHeightDeg===void 0&&(this.fHeightDeg=0),this.degPerPixel===void 0&&(this.degPerPixel=null),this.ppo_coeff=[0,0,0,0,0,0],this.amd_x_coeff=(o=>{let _=[];for(;o-- >0;)_.push(0);return _})(20),this.amd_y_coeff=(o=>{let _=[];for(;o-- >0;)_.push(0);return _})(20),this.instrument="",this.c1type="",this.c2type="",this.ctypes=["-SIN","-TAN","-ARC","-NCP","-GLS","-MER","-AIT","-STG"],this.ptype="",this.radecsys="",this.sysout="",this.center="",this.plate_fit=0,this.nxpix=a,this.nypix=f,this.xinc=t/3600,this.yinc=n/3600,this.xrefpix=s,this.yrefpix=r,this.xref=e,this.yref=i,this.c1type="RA-",this.c2type="DEC",this.ptype=u,this.pcode=1,this.coorflip=0,this.rot=l,this.rotmat=0,this.cd11=0,this.cd21=0,this.cd12=0,this.cd22=0,this.dc11=0,this.dc21=0,this.dc12=0,this.dc22=0,this.equinox=h,h>1980?this.radecsys="FK5":this.radecsys="FK4",c>0?this.epoch=c:this.epoch=0,this.wcson=1,this.sysout=this.radecsys,this.changesys=0,this.printsys=1,this.tabsys=0,this.pcode=0;for(let o=0;o<8;o++)((_,x,m=0)=>_.substr(m,x.length)===x)(this.ptype,this.ctypes[o])&&(this.pcode=o+1);this.wcsfull()}else if((e!=null&&e.constructor!=null&&e.constructor.__interfaces!=null&&e.constructor.__interfaces.indexOf("coordtxl.coords.WCSKeywordProvider")>=0||e===null)&&i===void 0&&t===void 0&&n===void 0&&s===void 0&&r===void 0&&a===void 0&&f===void 0&&l===void 0&&h===void 0&&c===void 0&&u===void 0){let o=arguments[0];this.xref===void 0&&(this.xref=0),this.yref===void 0&&(this.yref=0),this.xrefpix===void 0&&(this.xrefpix=0),this.yrefpix===void 0&&(this.yrefpix=0),this.xinc===void 0&&(this.xinc=0),this.yinc===void 0&&(this.yinc=0),this.rot===void 0&&(this.rot=0),this.crot===void 0&&(this.crot=0),this.srot===void 0&&(this.srot=0),this.cd11===void 0&&(this.cd11=0),this.cd12===void 0&&(this.cd12=0),this.cd21===void 0&&(this.cd21=0),this.cd22===void 0&&(this.cd22=0),this.dc11===void 0&&(this.dc11=0),this.dc12===void 0&&(this.dc12=0),this.dc21===void 0&&(this.dc21=0),this.dc22===void 0&&(this.dc22=0),this.mrot===void 0&&(this.mrot=0),this.cmrot===void 0&&(this.cmrot=0),this.smrot===void 0&&(this.smrot=0),this.xmpix===void 0&&(this.xmpix=0),this.ympix===void 0&&(this.ympix=0),this.equinox===void 0&&(this.equinox=0),this.epoch===void 0&&(this.epoch=0),this.nxpix===void 0&&(this.nxpix=0),this.nypix===void 0&&(this.nypix=0),this.plate_ra===void 0&&(this.plate_ra=0),this.plate_dec===void 0&&(this.plate_dec=0),this.plate_scale===void 0&&(this.plate_scale=0),this.x_pixel_offset===void 0&&(this.x_pixel_offset=0),this.y_pixel_offset===void 0&&(this.y_pixel_offset=0),this.x_pixel_size===void 0&&(this.x_pixel_size=0),this.y_pixel_size===void 0&&(this.y_pixel_size=0),this.xpix===void 0&&(this.xpix=0),this.ypix===void 0&&(this.ypix=0),this.xpos===void 0&&(this.xpos=0),this.ypos===void 0&&(this.ypos=0),this.pcode===void 0&&(this.pcode=0),this.changesys===void 0&&(this.changesys=0),this.printsys===void 0&&(this.printsys=0),this.ndec===void 0&&(this.ndec=0),this.degout===void 0&&(this.degout=0),this.tabsys===void 0&&(this.tabsys=0),this.rotmat===void 0&&(this.rotmat=0),this.coorflip===void 0&&(this.coorflip=0),this.offscl===void 0&&(this.offscl=0),this.plate_fit===void 0&&(this.plate_fit=0),this.wcson===void 0&&(this.wcson=0),this.detector===void 0&&(this.detector=0),this.fCenterRa===void 0&&(this.fCenterRa=0),this.fCenterDec===void 0&&(this.fCenterDec=0),this.fHalfWidthRa===void 0&&(this.fHalfWidthRa=0),this.fHalfWidthDec===void 0&&(this.fHalfWidthDec=0),this.fWidthDeg===void 0&&(this.fWidthDeg=0),this.fHeightDeg===void 0&&(this.fHeightDeg=0),this.degPerPixel===void 0&&(this.degPerPixel=null),this.ppo_coeff=[0,0,0,0,0,0],this.amd_x_coeff=(P=>{let p=[];for(;P-- >0;)p.push(0);return p})(20),this.amd_y_coeff=(P=>{let p=[];for(;P-- >0;)p.push(0);return p})(20),this.instrument="",this.c1type="",this.c2type="",this.ctypes=["-SIN","-TAN","-ARC","-NCP","-GLS","-MER","-AIT","-STG"],this.ptype="",this.radecsys="",this.sysout="",this.center="";let _,x,m,y,D,v,S,I,$,W,O,C,E,V;if(this.plate_fit=0,this.nxpix=o.getDoubleValue$java_lang_String("NAXIS1"),this.nypix=o.getDoubleValue$java_lang_String("NAXIS2"),this.xmpix=.5*this.nxpix,this.ympix=.5*this.nypix,this.mrot=0,this.equinox=o.getDoubleValue$java_lang_String("EQUINOX"),o.findKey("PLTRAH")){this.plate_fit=1,m=o.getDoubleValue$java_lang_String("PLTRAH"),y=o.getDoubleValue$java_lang_String("PLTRAM"),D=o.getDoubleValue$java_lang_String("PLTRAS"),O=m+y/60+D/3600,this.plate_ra=q.hrrad(O),x="+";let P=o.getStringValue$java_lang_String("PLTDECSN");P!=null&&(x=P.charAt(0)),(p=>p.charCodeAt==null?p:p.charCodeAt(0))(x)=="-".charCodeAt(0)?v=-1:v=1,S=o.getDoubleValue$java_lang_String("PLTDECD"),I=o.getDoubleValue$java_lang_String("PLTDECM"),$=o.getDoubleValue$java_lang_String("PLTDECS"),W=v*(S+I/60+$/3600),this.plate_dec=q.degrad(W),V=this.equinox|0,V===1950?this.radecsys="FK4":this.radecsys="FK5",this.epoch=this.equinox,o.findKey("EPOCH")&&(this.epoch=o.getDoubleValue$java_lang_String("EPOCH")),this.plate_scale=o.getDoubleValue$java_lang_String("PLTSCALE"),this.x_pixel_size=o.getDoubleValue$java_lang_String("XPIXELSZ"),this.y_pixel_size=o.getDoubleValue$java_lang_String("YPIXELSZ"),this.x_pixel_offset=o.getDoubleValue$java_lang_String("CNPIX1"),this.y_pixel_offset=o.getDoubleValue$java_lang_String("CNPIX2"),this.ppo_coeff[0]=o.getDoubleValue$java_lang_String("PPO1"),this.ppo_coeff[1]=o.getDoubleValue$java_lang_String("PPO2"),this.ppo_coeff[2]=o.getDoubleValue$java_lang_String("PPO3"),this.ppo_coeff[3]=o.getDoubleValue$java_lang_String("PPO4"),this.ppo_coeff[4]=o.getDoubleValue$java_lang_String("PPO5"),this.ppo_coeff[5]=o.getDoubleValue$java_lang_String("PPO6"),this.amd_x_coeff[0]=o.getDoubleValue$java_lang_String("AMDX1"),this.amd_x_coeff[1]=o.getDoubleValue$java_lang_String("AMDX2"),this.amd_x_coeff[2]=o.getDoubleValue$java_lang_String("AMDX3"),this.amd_x_coeff[3]=o.getDoubleValue$java_lang_String("AMDX4"),this.amd_x_coeff[4]=o.getDoubleValue$java_lang_String("AMDX5"),this.amd_x_coeff[5]=o.getDoubleValue$java_lang_String("AMDX6"),this.amd_x_coeff[6]=o.getDoubleValue$java_lang_String("AMDX7"),this.amd_x_coeff[7]=o.getDoubleValue$java_lang_String("AMDX8"),this.amd_x_coeff[8]=o.getDoubleValue$java_lang_String("AMDX9"),this.amd_x_coeff[9]=o.getDoubleValue$java_lang_String("AMDX10"),this.amd_x_coeff[10]=o.getDoubleValue$java_lang_String("AMDX11"),this.amd_x_coeff[11]=o.getDoubleValue$java_lang_String("AMDX12"),this.amd_x_coeff[12]=o.getDoubleValue$java_lang_String("AMDX13"),this.amd_x_coeff[13]=o.getDoubleValue$java_lang_String("AMDX14"),this.amd_x_coeff[14]=o.getDoubleValue$java_lang_String("AMDX15"),this.amd_x_coeff[15]=o.getDoubleValue$java_lang_String("AMDX16"),this.amd_x_coeff[16]=o.getDoubleValue$java_lang_String("AMDX17"),this.amd_x_coeff[17]=o.getDoubleValue$java_lang_String("AMDX18"),this.amd_x_coeff[18]=o.getDoubleValue$java_lang_String("AMDX19"),this.amd_x_coeff[19]=o.getDoubleValue$java_lang_String("AMDX20"),this.amd_y_coeff[0]=o.getDoubleValue$java_lang_String("AMDY1"),this.amd_y_coeff[1]=o.getDoubleValue$java_lang_String("AMDY2"),this.amd_y_coeff[2]=o.getDoubleValue$java_lang_String("AMDY3"),this.amd_y_coeff[3]=o.getDoubleValue$java_lang_String("AMDY4"),this.amd_y_coeff[4]=o.getDoubleValue$java_lang_String("AMDY5"),this.amd_y_coeff[5]=o.getDoubleValue$java_lang_String("AMDY6"),this.amd_y_coeff[6]=o.getDoubleValue$java_lang_String("AMDY7"),this.amd_y_coeff[7]=o.getDoubleValue$java_lang_String("AMDY8"),this.amd_y_coeff[8]=o.getDoubleValue$java_lang_String("AMDY9"),this.amd_y_coeff[9]=o.getDoubleValue$java_lang_String("AMDY10"),this.amd_y_coeff[10]=o.getDoubleValue$java_lang_String("AMDY11"),this.amd_y_coeff[11]=o.getDoubleValue$java_lang_String("AMDY12"),this.amd_y_coeff[12]=o.getDoubleValue$java_lang_String("AMDY13"),this.amd_y_coeff[13]=o.getDoubleValue$java_lang_String("AMDY14"),this.amd_y_coeff[14]=o.getDoubleValue$java_lang_String("AMDY15"),this.amd_y_coeff[15]=o.getDoubleValue$java_lang_String("AMDY16"),this.amd_y_coeff[16]=o.getDoubleValue$java_lang_String("AMDY17"),this.amd_y_coeff[17]=o.getDoubleValue$java_lang_String("AMDY18"),this.amd_y_coeff[18]=o.getDoubleValue$java_lang_String("AMDY19"),this.amd_y_coeff[19]=o.getDoubleValue$java_lang_String("AMDY20"),this.wcson=1,this.c1type="RA-",this.c2type="DEC",this.ptype="PLATE",this.degout=0,this.ndec=3}else if((_=o.getStringValue$java_lang_String("CTYPE1"))!=null){let P=_.length;if(((p,b,A=0)=>p.substr(A,b.length)===b)(_,"LINEAR"))this.pcode=0,this.c1type=_,this.ptype=_;else if(((p,b,A=0)=>p.substr(A,b.length)===b)(_,"PIXEL"))this.pcode=-1,this.c1type=_,this.ptype=_;else if(P>1&&((p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(0))=="R".charCodeAt(0)||(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(0))=="D".charCodeAt(0)||(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(0))=="A".charCodeAt(0)||(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(1))=="L".charCodeAt(0))){this.c1type=_.substring(0,2),P>2&&(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(2))!="-".charCodeAt(0)&&(this.c1type+=_.charAt(2)),P>3&&(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(3))!="-".charCodeAt(0)&&(this.c1type+=_.charAt(3)),P>4&&(this.ptype=_.substring(3,7)),this.pcode=0;for(let p=0;p<8;p++)if(((b,A,N=0)=>b.substr(N,A.length)===A)(this.ptype,this.ctypes[p])){this.pcode=p+1;break}}else throw console.error("WCSINIT: CTYPE1 not sky coordinates or LINEAR -> no WCS"),Object.defineProperty(new Error,"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});if((_=o.getStringValue$java_lang_String("CTYPE2"))==null)throw console.error("WCSINIT: No CTYPE2 -> no WCS"),Object.defineProperty(new Error(q.NO_WCS_IN_HEADER_MESSAGE),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});if(P=_.length,((p,b,A=0)=>p.substr(A,b.length)===b)(_,"LINEAR"))this.pcode=0,this.c2type=_;else if(((p,b,A=0)=>p.substr(A,b.length)===b)(_,"PIXEL"))this.pcode=-1,this.c2type=_;else if(P>1&&((p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(0))=="R".charCodeAt(0)||(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(0))=="D".charCodeAt(0)||(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(0))=="A".charCodeAt(0)||(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(1))=="L".charCodeAt(0)))this.c2type=_.substring(0,2),P>2&&(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(2))!="-".charCodeAt(0)&&(this.c2type+=_.charAt(2)),P>3&&(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(3))!="-".charCodeAt(0)&&(this.c2type+=_.charAt(3)),((p,b,A=0)=>p.substr(A,b.length)===b)(this.c1type,"DEC")||((p,b,A=0)=>p.substr(A,b.length)===b)(this.c1type,"GLAT")?this.coorflip=1:this.coorflip=0,(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(1))=="L".charCodeAt(0)||(p=>p.charCodeAt==null?p:p.charCodeAt(0))(_.charAt(0))=="A".charCodeAt(0)?(this.degout=1,this.ndec=5):(this.degout=0,this.ndec=3);else throw console.error("WCSINIT: CTYPE2 not sky coordinates or LINEAR -> no WCS"),Object.defineProperty(new Error(q.NO_WCS_IN_HEADER_MESSAGE),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});this.xrefpix=o.getDoubleValue$java_lang_String$double("CRPIX1",1),this.yrefpix=o.getDoubleValue$java_lang_String$double("CRPIX2",1),this.xref=o.getDoubleValue$java_lang_String$double("CRVAL1",1),this.yref=o.getDoubleValue$java_lang_String$double("CRVAL2",1),(this.xinc=o.getDoubleValue$java_lang_String("CDELT1"))!==0?(this.yinc=o.getDoubleValue$java_lang_String$double("CDELT2",this.xinc),this.rot=o.getDoubleValue$java_lang_String$double("CROTA1",0),this.rot===0&&(this.rot=o.getDoubleValue$java_lang_String("CROTA2")),this.cd11=0,this.cd21=0,this.cd12=0,this.cd22=0,this.rotmat=0):(this.cd11=o.getDoubleValue$java_lang_String("CD1_1"))!==0?(this.rotmat=1,this.cd12=o.getDoubleValue$java_lang_String$double("CD1_2",0),this.cd21=o.getDoubleValue$java_lang_String$double("CD2_1",0),this.cd22=o.getDoubleValue$java_lang_String$double("CD2_2",this.cd11),E=this.cd11*this.cd22-this.cd12*this.cd21,E!==0&&(this.dc11=this.cd22/E,this.dc12=-this.cd12/E,this.dc21=-this.cd21/E,this.dc22=this.cd11/E),this.xinc=Math.sqrt(this.cd11*this.cd11+this.cd21*this.cd21),this.yinc=Math.sqrt(this.cd12*this.cd12+this.cd22*this.cd22),this.cd11*this.cd11-this.cd12*this.cd12<0?((((p,b,A=0)=>p.substr(A,b.length)===b)(this.c1type,"RA")||((p,b,A=0)=>p.substr(A,b.length)===b)(this.c1type,"GLON"))&&(this.xinc=-this.xinc),(((p,b,A=0)=>p.substr(A,b.length)===b)(this.c2type,"RA")||((p,b,A=0)=>p.substr(A,b.length)===b)(this.c2type,"GLON"))&&(this.yinc=-this.yinc),this.rot=q.raddeg(Math.atan2(-this.cd12,this.cd22))):this.rot=q.raddeg(Math.atan2(this.cd12,this.cd22))):(this.xinc=1,this.yinc=1,console.error("WCSINIT: setting CDELT to 1")),this.xmpix=o.getDoubleValue$java_lang_String("CCPIX1"),this.ympix=o.getDoubleValue$java_lang_String("CCPIX2"),this.mrot=o.getDoubleValue$java_lang_String("CCROT1"),((p,b,A=0)=>p.substr(A,b.length)===b)(this.ptype,"LINEAR")&&((p,b,A=0)=>p.substr(A,b.length)===b)(this.ptype,"PIXEL")?this.degout=-1:this.wcseq(o),this.wcson=1}else if(o.findKey("SECPIX")||o.findKey("PIXSCAL1")||o.findKey("SECPIX1")){if(C=o.getDoubleValue$java_lang_String$double("SECPIX",0),C===0?(C=o.getDoubleValue$java_lang_String$double("SECPIX1",0),C!==0?(this.xinc=-C/3600,C=o.getDoubleValue$java_lang_String$double("SECPIX2",0),this.yinc=C/3600):(C=o.getDoubleValue$java_lang_String$double("PIXSCAL1",0),this.xinc=-C/3600,C=o.getDoubleValue$java_lang_String$double("PIXSCAL2",0),this.yinc=C/3600)):(this.yinc=C/3600,this.xinc=-this.yinc),this.xrefpix=o.getDoubleValue$java_lang_String$double("CRPIX1",this.nxpix*.5),this.yrefpix=o.getDoubleValue$java_lang_String$double("CRPIX2",this.nypix*.5),this.xref=0,(this.xref=o.getDoubleValue$java_lang_String$double("RA",0))===0)throw console.error("WCSINIT: No RA with SECPIX, no WCS"),Object.defineProperty(new Error(q.NO_WCS_IN_HEADER_MESSAGE),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});if(this.yref=0,(this.yref=o.getDoubleValue$java_lang_String$double("DEC",0))===0)throw console.error("WCSINIT: No DEC with SECPIX, no WCS"),Object.defineProperty(new Error(q.NO_WCS_IN_HEADER_MESSAGE),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});this.c1type="RA--TAN",this.c2type="DEC-TAN",this.ptype="-TAN",this.pcode=1,this.coorflip=0,this.degout=0,this.ndec=3,this.rot=o.getDoubleValue$java_lang_String$double("CROTA1",0),this.rot===0&&(this.rot=o.getDoubleValue$java_lang_String$double("CROTA2",0)),this.cd11=0,this.cd21=0,this.cd12=0,this.cd22=0,this.dc11=0,this.dc21=0,this.dc12=0,this.dc22=0,this.rotmat=0,this.xmpix=o.getDoubleValue$java_lang_String("CCPIX1"),this.ympix=o.getDoubleValue$java_lang_String("CCPIX2"),this.mrot=o.getDoubleValue$java_lang_String("CCROT1"),this.wcseq(o),(this.epoch=o.getDoubleValue$java_lang_String$double("DATE-OBS",0))===0&&(this.epoch=o.getDoubleValue$java_lang_String$double("EPOCH",0))===0&&(this.epoch=this.equinox),this.wcson=1}else throw Object.defineProperty(new Error(q.NO_WCS_IN_HEADER_MESSAGE),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});this.sysout=this.radecsys,this.changesys=0,this.printsys=1,this.tabsys=0,this.wcsfull()}else throw new Error("invalid overload")}getEquinox(){return this.equinox}getWCSCenter(){if(this.isValid())return new je.Point2D(this.fCenterRa,this.fCenterDec);throw Object.defineProperty(new Error("No WCS information."),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}getImageCenter(){return new je.Point2D(.5*this.nxpix,.5*this.nypix)}isWCS(){return this.isValid()}imageToWorldCoords(e,i){if(!!this.isValid())if(i)e.x=Math.abs(e.x*this.degPerPixel.x),e.y=Math.abs(e.y*this.degPerPixel.y);else{let t=this.pix2wcs(e.x,e.y);if(t!=null)e.setLocation(t.x,t.y);else throw Object.defineProperty(new Error("Image coordinates out of WCS range: "+e),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}}worldToImageCoords(e,i){if(!!this.isValid())if(i)e.x=Math.abs(e.x/this.degPerPixel.x),e.y=Math.abs(e.y/this.degPerPixel.y);else{let t=this.wcs2pix(e.x,e.y);if(t!=null)e.setLocation(t.x,t.y);else throw Object.defineProperty(new Error("World coordinates out of range: "+e),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}}getWidthInDeg(){return this.fWidthDeg}getHeightInDeg(){return this.fHeightDeg}getWidth(){return this.nxpix}getHeight(){return this.nypix}wcseq(e){let i=0,t;e.findKey("EQUINOX")?(this.equinox=e.getDoubleValue$java_lang_String("EQUINOX"),i=2e3):e.findKey("EPOCH")?(i=e.getDoubleValue$java_lang_String$double("EPOCH",0)|0,i===0?(i=1950,this.equinox=1950):this.equinox=e.getDoubleValue$java_lang_String("EPOCH")):e.findKey("RADECSYS")&&(t=e.getStringValue$java_lang_String("RADECSYS"),((n,s,r=0)=>n.substr(r,s.length)===s)(t,"FK4")?(this.equinox=1950,i=1950):((n,s,r=0)=>n.substr(r,s.length)===s)(t,"FK5")?(this.equinox=2e3,i=2e3):((n,s,r=0)=>n.substr(r,s.length)===s)(t,"GAL")?(this.equinox=2e3,i=2e3):((n,s,r=0)=>n.substr(r,s.length)===s)(t,"ECL")&&(this.equinox=2e3,i=2e3)),i===0&&(this.equinox=2e3,i=2e3),(this.epoch=e.getDoubleValue$java_lang_String$double("DATE-OBS",0))===0&&(this.epoch=e.getDoubleValue$java_lang_String$double("EPOCH",0))===0&&(this.epoch=this.equinox),this.epoch===0&&(this.epoch=this.equinox),e.findKey("RADECSYS")?((n,s,r=0)=>n.substr(r,s.length)===s)(this.radecsys,"FK4")?this.equinox=1950:((n,s,r=0)=>n.substr(r,s.length)===s)(this.radecsys,"FK5")?this.equinox=2e3:((n,s,r=0)=>n.substr(r,s.length)===s)(this.radecsys,"GAL")&&i===0&&(this.equinox=2e3):(n=>n.charCodeAt==null?n:n.charCodeAt(0))(this.c1type.charAt(0))=="G".charCodeAt(0)?this.radecsys="GALACTIC":(n=>n.charCodeAt==null?n:n.charCodeAt(0))(this.c1type.charAt(0))=="E".charCodeAt(0)?this.radecsys="ECLIPTIC":(n=>n.charCodeAt==null?n:n.charCodeAt(0))(this.c1type.charAt(0))=="S".charCodeAt(0)?this.radecsys="SGALACTC":(n=>n.charCodeAt==null?n:n.charCodeAt(0))(this.c1type.charAt(0))=="H".charCodeAt(0)?this.radecsys="HELIOECL":(n=>n.charCodeAt==null?n:n.charCodeAt(0))(this.c1type.charAt(0))=="A".charCodeAt(0)?this.radecsys="ALTAZ":i>1980?this.radecsys="FK5":this.radecsys="FK4"}isValid(){return this.wcson>0}wcsshift(e,i,t){!this.isValid()||(this.fCenterRa=this.xref=e,this.fCenterDec=this.yref=i,this.radecsys=t,((n,s,r=0)=>n.substr(r,s.length)===s)(t,"FK4")?this.equinox=1950:this.equinox=2e3)}wcssize(){let e,i,t,n;if(this.isValid()){e=.5*this.nxpix,i=.5*this.nypix;let s=this.pix2wcs(e,i);if(s==null)return;this.fCenterRa=s.x,this.fCenterDec=s.y;let r=this.pix2wcs(1,i),a=this.pix2wcs(this.nxpix,i);if(r==null||a==null||(!((f,l,h=0)=>f.substr(h,l.length)===l)(this.ptype,"LINEAR")&&!((f,l,h=0)=>f.substr(h,l.length)===l)(this.ptype,"PIXEL")?(t=this.wcsdist(r.x,r.y,a.x,a.y),this.fHalfWidthRa=t*.5/Math.cos(q.degrad(this.fCenterDec))):this.fHalfWidthRa=Math.sqrt((a.y-r.y)*(a.y-r.y)+(a.x-r.x)*(a.x-r.x)),r=this.pix2wcs(e,1),a=this.pix2wcs(e,this.nypix),r==null||a==null))return;!((f,l,h=0)=>f.substr(h,l.length)===l)(this.ptype,"LINEAR")&&!((f,l,h=0)=>f.substr(h,l.length)===l)(this.ptype,"PIXEL")?(n=this.wcsdist(r.x,r.y,a.x,a.y),this.fHalfWidthDec=n*.5):this.fHalfWidthDec=Math.sqrt((a.y-r.y)*(a.y-r.y)+(a.x-r.x)*(a.x-r.x))}}wcsfull(){let e,i;if(this.isValid()){e=.5*this.nxpix,i=.5*this.nypix;let t=this.pix2wcs(e,i);if(t==null)return;this.fCenterRa=t.x,this.fCenterDec=t.y;let n=this.pix2wcs(0,i),s=this.pix2wcs(this.nxpix,i);if(n==null||s==null||(!((r,a,f=0)=>r.substr(f,a.length)===a)(this.ptype,"LINEAR")&&!((r,a,f=0)=>r.substr(f,a.length)===a)(this.ptype,"PIXEL")?this.fWidthDeg=this.wcsdist(n.x,n.y,s.x,s.y):this.fWidthDeg=Math.sqrt((s.y-n.y)*(s.y-n.y)+(s.x-n.x)*(s.x-n.x)),n=this.pix2wcs(e,0),s=this.pix2wcs(e,this.nypix),n==null||s==null))return;!((r,a,f=0)=>r.substr(f,a.length)===a)(this.ptype,"LINEAR")&&!((r,a,f=0)=>r.substr(f,a.length)===a)(this.ptype,"PIXEL")?this.fHeightDeg=this.wcsdist(n.x,n.y,s.x,s.y):this.fHeightDeg=Math.sqrt((s.y-n.y)*(s.y-n.y)+(s.x-n.x)*(s.x-n.x)),this.degPerPixel=new je.Point2D(this.fWidthDeg/this.nxpix,this.fHeightDeg/this.nypix)}}wcsdist(e,i,t,n){let s,r,a,f,l=[0,0,0],h=[0,0,0],c,u,g,o;for(s=q.degrad(e),a=q.degrad(i),g=Math.cos(a),l[0]=Math.cos(s)*g,l[1]=Math.sin(s)*g,l[2]=Math.sin(a),r=q.degrad(t),f=q.degrad(n),g=Math.cos(f),h[0]=Math.cos(r)*g,h[1]=Math.sin(r)*g,h[2]=Math.sin(f),c=0,o=0;o<3;o++)c=c+(l[o]-h[o])*(l[o]-h[o]);return c=c/4,c>1&&(c=1),u=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),u=q.raddeg(u),u}pix2wcs(e,i){let t;return this.isValid()?(this.xpix=e,this.ypix=i,this.offscl=0,this.plate_fit>0?(t=xt.platepos.getPosition(e,i,this))==null&&(this.offscl=1):(t=mt.worldpos.getPosition(e,i,this))==null&&(this.offscl=1),this.pcode>0&&(((n,s,r=0)=>n.substr(r,s.length)===s)(this.radecsys,"FK4")?this.equinox!==1950&&(t=se.wcscon.fk4prec(this.equinox,1950,t)):((n,s,r=0)=>n.substr(r,s.length)===s)(this.radecsys,"FK5")&&this.equinox!==2e3&&(t=se.wcscon.fk5prec(this.equinox,2e3,t)),this.changesys===1?t=se.wcscon.fk425e(t,this.epoch):this.changesys===2?t=se.wcscon.fk524e(t,this.epoch):this.changesys===3?t=se.wcscon.fk42gal(t):this.changesys===4&&(t=se.wcscon.fk52gal(t))),this.offscl===0&&t!=null&&(this.xpos=t.x,this.ypos=t.y),t):null}wcs2pix(e,i){let t;if(!this.isValid())return null;this.xpos=e,this.ypos=i;let n=new je.Point2D(e,i);return this.changesys===1?n=se.wcscon.fk524e(n,this.epoch):this.changesys===2&&(n=se.wcscon.fk425e(n,this.epoch)),((s,r,a=0)=>s.substr(a,r.length)===r)(this.radecsys,"FK4")?this.equinox!==1950&&(n=se.wcscon.fk4prec(1950,this.equinox,n)):((s,r,a=0)=>s.substr(a,r.length)===r)(this.radecsys,"FK5")&&this.equinox!==2e3&&(n=se.wcscon.fk5prec(2e3,this.equinox,n)),this.plate_fit>0?(t=xt.platepos.getPixels(n.x,n.y,this))==null&&(this.offscl=1):(t=mt.worldpos.getPixels(n.x,n.y,this))==null&&(this.offscl=1),t!=null&&(this.xpix=t.x,this.ypix=t.y),t}};$e.WCSTransform=q;q.NO_WCS_IN_HEADER_MESSAGE="The header does not contain a valid world coordinate system.";q.__class="coordtxl.coords.WCSTransform";q.__interfaces=["coordtxl.coords.WorldCoordinateConverter"];var se=gt(),mt=_t(),xt=yt()});var bt=B(Pe=>{"use strict";Object.defineProperty(Pe,"__esModule",{value:!0});Pe.Trigod=void 0;var Y=class{static DEG_$LI$(){return Y.DEG==null&&(Y.DEG=180/Math.PI),Y.DEG}static fractionalPart(e){return Math.abs(e-(e|0))}static cosd(e){let i=0,t=Y.fractionalPart(e/360);return t>.5&&(t=1-t),t>.25&&(t=.5-t,i=1),t>.125?t=Math.sin(Math.PI*2*(.25-t)):t=Math.cos(Math.PI*2*t),i!==0&&(t=-t),t}static sind(e){let i=Y.fractionalPart(e/360),t=e>=0?0:1;return i>.5&&(i=1-i,t^=1),i>.25&&(i=.5-i),i>.125?i=Math.cos(Math.PI*2*(.25-i)):i=Math.sin(Math.PI*2*i),t!==0&&(i=-i),i}static tand(e){let i=Y.fractionalPart(e/180);return i===.5?i=Y.DOUBLE_MAX:i=Math.tan(Math.PI*i),e>0?i:-i}static atand(e){return Y.DEG_$LI$()*Math.atan(e)}static atan2d(e,i){return Y.DEG_$LI$()*Math.atan2(e,i)}static acosd(e){return Y.DEG_$LI$()*Math.acos(e)}asind(e){return Y.DEG_$LI$()*Math.asin(e)}};Pe.Trigod=Y;Y.DOUBLE_MAX=17e37;Y.__class="coordtxl.coords.Trigod"});var Mt=B(Ie=>{"use strict";Object.defineProperty(Ie,"__esModule",{value:!0});Ie.Cotr=void 0;var re=class{static tr_Euler(e,i){let r;i[0][2]=F.Trigod.cosd(e[0]),i[1][2]=F.Trigod.sind(e[0]),i[2][0]=F.Trigod.cosd(e[2]),i[2][1]=F.Trigod.sind(e[2]),i[2][2]=F.Trigod.cosd(e[1]),r=F.Trigod.sind(e[1]),i[0][0]=i[2][0]*i[2][2]*i[0][2]-i[2][1]*i[1][2],i[1][0]=i[2][0]*i[2][2]*i[1][2]+i[2][1]*i[0][2],i[0][1]=-i[2][1]*i[2][2]*i[0][2]-i[2][0]*i[1][2],i[1][1]=-i[2][1]*i[2][2]*i[1][2]+i[2][0]*i[0][2],i[2][0]=i[2][0]*r,i[2][1]=-i[2][1]*r,i[0][2]=-r*i[0][2],i[1][2]=-r*i[1][2]}static tr_oo(e,i,t){let n=[0,0,0];re.tr_ou(e,n),re.tr_uu(n,n,t),re.tr_uo(n,i)}static tr_oo1(e,i,t){let n=[0,0,0];re.tr_ou(e,n),re.tr_uu1(n,n,t),re.tr_uo(n,i)}static tr_oR(e,i){let t=e[0],n=e[1];i[2][2]=F.Trigod.cosd(n),i[0][2]=F.Trigod.sind(n),i[1][1]=F.Trigod.cosd(t),i[1][0]=-F.Trigod.sind(t),i[1][2]=0,i[0][0]=i[2][2]*i[1][1],i[0][1]=-i[2][2]*i[1][0],i[2][0]=-i[0][2]*i[1][1],i[2][1]=i[0][2]*i[1][0]}static tr_ou(e,i){let t=e[0],n=e[1],s=F.Trigod.cosd(n);i[0]=s*F.Trigod.cosd(t),i[1]=s*F.Trigod.sind(t),i[2]=F.Trigod.sind(n)}static tr_uo(e,i){let t=e[0],n=e[1],s=e[2],r=t*t+n*n;if(i[0]=0,r===0){if(s===0)return;i[1]=s>0?90:-90;return}i[1]=F.Trigod.atand(s/Math.sqrt(r)),i[0]=F.Trigod.atan2d(n,t),i[0]<0&&(i[0]+=360)}static tr_uR(e,i){let t=e[0],n=e[1],s=e[2];i[0][0]=t,i[0][1]=n,i[0][2]=s,i[2][2]=Math.sqrt(t*t+n*n),i[1][0]=0,i[1][1]=1,i[1][2]=0,i[2][2]!==0&&(i[1][1]=t/i[2][2],i[1][0]=-n/i[2][2]),i[2][0]=-i[0][2]*i[1][1],i[2][1]=i[0][2]*i[1][0]}static tr_uu(e,i,t){let n,s,r,a=[0,0,0];for(n=0;n<3;n++){for(r=0,s=0;s<3;s++)r+=t[n][s]*e[s];a[n]=r}for(n=0;n<3;n++)i[n]=a[n]}static tr_uu1(e,i,t){let n,s,r,a=[0,0,0];for(n=0;n<3;n++){for(s=0,r=0;s<3;s++)r+=t[s][n]*e[s];a[n]=r}for(n=0;n<3;n++)i[n]=a[n]}static tr_RR(e,i,t){let n,s,r,a,f=function(l){let h=function(c){if(c.length===0)return 0;{let u=[];for(let g=0;g<c[0];g++)u.push(h(c.slice(1)));return u}};return h(l)}([3,3]);for(n=0;n<3;n++)for(s=0;s<3;s++){for(r=0,a=0;r<3;r++)a+=t[n][r]*e[r][s];f[n][s]=a}for(n=0;n<3;n++)for(s=0;s<3;s++)i[n][s]=f[n][s]}static tr_RR1(e,i,t){let n,s,r,a,f=function(l){let h=function(c){if(c.length===0)return 0;{let u=[];for(let g=0;g<c[0];g++)u.push(h(c.slice(1)));return u}};return h(l)}([3,3]);for(n=0;n<3;n++)for(s=0;s<3;s++){for(r=0,a=0;r<3;r++)a+=t[r][n]*e[r][s];f[n][s]=a}for(n=0;n<3;n++)for(s=0;s<3;s++)i[n][s]=f[n][s]}};Ie.Cotr=re;re.__class="coordtxl.coords.Cotr";var F=bt()});var vt=B(Oe=>{"use strict";Object.defineProperty(Oe,"__esModule",{value:!0});Oe.JPrec=void 0;var ce=class{static prej_R(e,i,t){let n,s,r,a=[0,0,0],f=0,l=1,h=2;n=(i-2e3)/100,s=(t-i)/100,r=2306.2181+(1.39656-139e-6*n)*n,a[h]=(r+(.30188-344e-6*n+.017998*s)*s)*s/3600,a[f]=(r+(1.09468+66e-6*n+.018203*s)*s)*s/3600,a[l]=(2004.3109+(-.8533-217e-6*n)*n+(-.42665-217e-6*n-.041833*s)*s)*s/3600,Te.Cotr.tr_Euler(a,e)}static prej_q(e,i,t,n){let s=[0,0,0];if(t===n){i[0]=e[0],i[1]=e[1];return}Te.Cotr.tr_ou(e,s),ce.prej_u(s,s,t,n),Te.Cotr.tr_uo(s,i)}static prej_u(e,i,t,n){let s=[[1,0,0],[0,1,0],[0,0,1]];if(t===n){i[0]=e[0],i[1]=e[1],i[2]=e[2];return}ce.prej_R(s,t,n),Te.Cotr.tr_uu(e,i,s)}};Oe.JPrec=ce;ce.__class="coordtxl.coords.JPrec";var Te=Mt()});var Ge=B(Ve=>{"use strict";Object.defineProperty(Ve,"__esModule",{value:!0});Ve.StringUtil=void 0;var ge=class{static replace(e,i,t){return e.split(i).join(t)}static split(e,i){let t=e.indexOf(String.fromCharCode(i));if(t>0){let n;return n=[null,null],n[0]=e.substring(0,t),n[1]=e.substring(t+1),n}return null}static combine(e,i){if(e==null)return"";let t={str:"",toString:function(){return this.str}};for(let n=0;n<e.length;n++)(s=>(s.str+=e[n],s))(t),n+1<e.length&&(s=>(s.str+=i,s))(t);return t.str}static equals(e,i){return e==null&&i==null||!(e==null||i==null)&&e===i}static match(e,i){let t=i.length,n=e.length;for(let s=0;;s++){for(let r=0;;s++,r++){let a=r>=t,f=s>=n||(l=>l.charCodeAt==null?l:l.charCodeAt(0))(e.charAt(s))=="|".charCodeAt(0);if(a&&!f&&(l=>l.charCodeAt==null?l:l.charCodeAt(0))(e.charAt(s))=="*".charCodeAt(0)&&(s===n-1||s<n-1&&(l=>l.charCodeAt==null?l:l.charCodeAt(0))(e.charAt(s+1))=="|".charCodeAt(0))||a&&f)return!0;if(a||f)break;if((l=>l.charCodeAt==null?l:l.charCodeAt(0))(e.charAt(s))=="?".charCodeAt(0))continue;if((l=>l.charCodeAt==null?l:l.charCodeAt(0))(e.charAt(s))=="*".charCodeAt(0)||(l=>l.charCodeAt==null?l:l.charCodeAt(0))(e.charAt(s))=="%".charCodeAt(0)){s++;for(let l=t;l>=r;--l)if(ge.match(e.substring(s),i.substring(l)))return!0;break}if((l=>l.charCodeAt==null?l:l.charCodeAt(0))(e.charAt(s).toUpperCase())!=(l=>l.charCodeAt==null?l:l.charCodeAt(0))(i.charAt(r).toUpperCase()))break}if(s=e.indexOf("|",s),s===-1)return!1}}static pad(e,i,t){let n={str:"",toString:function(){return this.str}};if(t){(r=>(r.str+=e,r))(n);let s=e.length;for(;s++<i;)(r=>(r.str+=" ",r))(n)}else{let s=e.length;for(;s++<i;)(r=>(r.str+=" ",r))(n);(r=>(r.str+=e,r))(n)}return n.str}static arrayContains(e,i){for(let t=0;t<e.length;t++){let n=e[t];if(i===n)return!0}return!1}static capitalize(e){if(e==null||e.length===0)return e;let i={str:"",toString:function(){return this.str}},t=e.split("[\\s]+");for(let n=0;n<t.length;n++){let s=t[n];{let r=s.trim();r.length!==0&&((a=>(a.str+=r.substring(1).toLowerCase(),a))((a=>(a.str+=r.substring(0,1).toUpperCase(),a))(i)),(a=>(a.str+=" ",a))(i))}}return i.str.trim()}};Ve.StringUtil=ge;ge.__class="coordtxl.util.StringUtil"});var Ct=B(we=>{"use strict";Object.defineProperty(we,"__esModule",{value:!0});we.DMS=void 0;var Qt=Ge(),Q=class{static fmt_deg_min(e){let i=Math.round(e),t=(""+i).split(".").join("@").split("@");if(t.length<1)return"00";let n="";for(let s=t[0].length;s<2;++s)n+="0";for(let s=t[0].length>2?t[0].length-2:0;s<t[0].length;++s)n+=t[0].charAt(s);return n}static fmt_sec(e){let i=Math.round(e*100)/100,t=(""+i).split(".").join("@").split("@");if(t.length===0)return"00.00";if(t.length<2)return t[0]+".00";let n="";for(let r=t[0].length;r<2;++r)n+="0";for(let r=t[0].length>2?t[0].length-2:0;r<t[0].length;++r)n+=t[0].charAt(r);n+=".";let s=0;for(;s<2&&s<t[1].length;++s)n+=t[1].charAt(s);for(;s<2;++s)n+="0";return n}constructor(e,i,t){if((typeof e=="number"||e===null)&&(typeof i=="number"||i===null)&&(typeof t=="number"||t===null)){let n=arguments;this.degrees===void 0&&(this.degrees=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,this.set(e,i,t)}else if((e!=null&&e instanceof Q||e===null)&&i===void 0&&t===void 0){let s=arguments[0];this.degrees===void 0&&(this.degrees=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,this.setVal(s.val)}else if((typeof e=="string"||e===null)&&i===void 0&&t===void 0){let s=arguments[0];this.degrees===void 0&&(this.degrees=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,s=Qt.StringUtil.replace(s,",",".");let r=[0,0,0],a=s.split(":").join("@").split(" ").join("@").split("@@").join("@").split("@"),f=0;for(;f<3&&f<a.length;)r[f]=parseFloat(a[f]),f+=1;if(f>=2)this.set(r[0],r[1]|0,r[2]);else if(f===1)this.setVal(r[0]);else throw Object.defineProperty(new Error("Expected a string of the form hh:mm:ss.sss, but got: '"+s+"'"),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}else if((typeof e=="number"||e===null)&&i===void 0&&t===void 0){let s=arguments[0];this.degrees===void 0&&(this.degrees=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,this.setVal(s)}else if(e===void 0&&i===void 0&&t===void 0){let n=arguments;this.degrees===void 0&&(this.degrees=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1}else throw new Error("invalid overload")}set(e,i,t){this.degrees=e|0,this.min=i,this.sec=t,this.val=(t/60+i)/60,e<0||e===Q.MINUS_ZERO?(this.val=e-this.val,this.degrees=-this.degrees,this.sign=-1):(this.val=this.degrees+this.val,this.sign=1),this.initialized=!0}setVal(e){this.val=e;let i=e;i<0||i===Q.MINUS_ZERO?(this.sign=-1,i=-i):this.sign=1;let t=i+1e-10;this.degrees=t|0;let n=(t-this.degrees)*60;this.min=n|0,this.sec=(n-this.min)*60,this.initialized=!0}toString$(){let e=Q.fmt_sec(this.sec),i;return this.sign===-1?i="-":i="+",i+Q.fmt_deg_min(this.degrees)+":"+Q.fmt_deg_min(this.min)+":"+e}toString$boolean(e){if(e)return this.toString$();let i;return this.sign===-1?i="-":i="+",i+Q.fmt_deg_min(this.degrees)+":"+Q.fmt_deg_min(this.min)}toString(e){if(typeof e=="boolean"||e===null)return this.toString$boolean(e);if(e===void 0)return this.toString$();throw new Error("invalid overload")}isInitialized(){return this.initialized}getDegrees(){return this.degrees}getMin(){return this.min}getSec(){return this.sec}getVal(){return this.val}getSign(){return this.sign}equals(e){return e!=null&&e instanceof Q&&this.val===e.val}};we.DMS=Q;Q.MINUS_ZERO=-0;Q.__class="coordtxl.coords.DMS"});var St=B(Le=>{"use strict";Object.defineProperty(Le,"__esModule",{value:!0});Le.HMS=void 0;var Dt=Ge(),ee=class{static fmt_hr_min(e){let i=Math.round(e),t=(""+i).split(".").join("@").split("@");if(t.length<1)return"00";let n="";for(let s=t[0].length;s<2;++s)n+="0";for(let s=t[0].length>2?t[0].length-2:0;s<t[0].length;++s)n+=t[0].charAt(s);return n}static fmt_sec(e){let i=Math.round(e*1e3)/1e3,t=(""+i).split(".").join("@").split("@");if(t.length===0)return"00.000";if(t.length<2)return t[0]+".000";let n="";for(let r=t[0].length;r<2;++r)n+="0";for(let r=t[0].length>2?t[0].length-2:0;r<t[0].length;++r)n+=t[0].charAt(r);n+=".";let s=0;for(;s<3&&s<t[1].length;++s)n+=t[1].charAt(s);for(;s<3;++s)n+="0";return n}constructor(e,i,t){if((typeof e=="number"||e===null)&&(typeof i=="number"||i===null)&&(typeof t=="number"||t===null)){let n=arguments;this.hours===void 0&&(this.hours=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,this.set(e,i,t)}else if((typeof e=="string"||e===null)&&(typeof i=="boolean"||i===null)&&t===void 0){let n=arguments,s=n[0],r=n[1];this.hours===void 0&&(this.hours=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,s=Dt.StringUtil.replace(s,",",".");let a=[0,0,0],f=s.split(":").join("@").split(" ").join("@").split("@@").join("@").split("@"),l=0;for(;l<3&&l<f.length;)a[l]=parseFloat(f[l]),l+=1;if(l>=2)this.set(a[0],a[1]|0,a[2]);else if(l===1)!r&&s.indexOf(".")!==-1?this.setVal(a[0]/15):this.setVal(a[0]);else throw Object.defineProperty(new Error("Expected a string of the form hh:mm:ss.sss, but got: '"+s+"'"),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}else if((e!=null&&e instanceof ee||e===null)&&i===void 0&&t===void 0){let s=arguments[0];this.hours===void 0&&(this.hours=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,this.setVal(s.val)}else if((typeof e=="string"||e===null)&&i===void 0&&t===void 0){let s=arguments[0];{let r=arguments,a=!1;this.hours===void 0&&(this.hours=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,s=Dt.StringUtil.replace(s,",",".");let f=[0,0,0],l=s.split(":").join("@").split(" ").join("@").split("@@").join("@").split("@"),h=0;for(;h<3&&h<l.length;)f[h]=parseFloat(l[h]),h+=1;if(h>=2)this.set(f[0],f[1]|0,f[2]);else if(h===1)!a&&s.indexOf(".")!==-1?this.setVal(f[0]/15):this.setVal(f[0]);else throw Object.defineProperty(new Error("Expected a string of the form hh:mm:ss.sss, but got: '"+s+"'"),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}this.hours===void 0&&(this.hours=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1}else if((typeof e=="number"||e===null)&&i===void 0&&t===void 0){let s=arguments[0];this.hours===void 0&&(this.hours=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,this.setVal(s)}else if(e===void 0&&i===void 0&&t===void 0){let n=arguments;this.hours===void 0&&(this.hours=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1}else throw new Error("invalid overload")}set(e,i,t){this.hours=e|0,this.min=i,this.sec=t,this.val=(t/60+i)/60,e<0||e===ee.MINUS_ZERO?(this.val=e-this.val,this.hours=-this.hours,this.sign=-1):(this.val=this.hours+this.val,this.sign=1),this.initialized=!0}setVal(e){this.val=e;let i=e;i<0||i===ee.MINUS_ZERO?(this.sign=-1,i=-i):this.sign=1;let t=i+1e-10;this.hours=t|0;let n=(t-this.hours)*60;this.min=n|0,this.sec=(n-this.min)*60,this.initialized=!0}toString$(){let e=ee.fmt_sec(this.sec),i;return this.sign===-1?i="-":i="",i+ee.fmt_hr_min(this.hours)+":"+ee.fmt_hr_min(this.min)+":"+e}toString$boolean(e){if(e)return this.toString$();let i;return this.sign===-1?i="-":i=" ",i+ee.fmt_hr_min(this.hours)+":"+ee.fmt_hr_min(this.min)}toString(e){if(typeof e=="boolean"||e===null)return this.toString$boolean(e);if(e===void 0)return this.toString$();throw new Error("invalid overload")}isInitialized(){return this.initialized}getHours(){return this.hours}getMin(){return this.min}getSec(){return this.sec}getVal(){return this.val}getSign(){return this.sign}equals(e){return e!=null&&e instanceof ee&&this.val===e.val}};Le.HMS=ee;ee.MINUS_ZERO=-0;ee.__class="coordtxl.coords.HMS"});var Et=B(We=>{"use strict";Object.defineProperty(We,"__esModule",{value:!0});We.WorldCoords=void 0;var At=de(),Z=class{constructor(e,i,t,n,s,r,a){if((typeof e=="number"||e===null)&&(typeof i=="number"||i===null)&&(typeof t=="number"||t===null)&&(typeof n=="number"||n===null)&&(typeof s=="number"||s===null)&&(typeof r=="number"||r===null)&&(typeof a=="number"||a===null)){let f=arguments;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new U.HMS(e,i,t),this.dec=new G.DMS(n,s,r),this.init(a)}else if((typeof e=="number"||e===null)&&(typeof i=="number"||i===null)&&(typeof t=="number"||t===null)&&(typeof n=="number"||n===null)&&(typeof s=="number"||s===null)&&(typeof r=="number"||r===null)&&a===void 0){let f=arguments;{let l=arguments,h=2e3;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new U.HMS(e,i,t),this.dec=new G.DMS(n,s,r),this.init(h)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if((typeof e=="string"||e===null)&&(typeof i=="string"||i===null)&&(typeof t=="number"||t===null)&&(typeof n=="boolean"||n===null)&&s===void 0&&r===void 0&&a===void 0){let f=arguments,l=f[0],h=f[1],c=f[2],u=f[3];this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new U.HMS(l,u),this.dec=new G.DMS(h),this.init(c)}else if((e!=null&&e instanceof U.HMS||e===null)&&(i!=null&&i instanceof G.DMS||i===null)&&(typeof t=="number"||t===null)&&n===void 0&&s===void 0&&r===void 0&&a===void 0){let f=arguments,l=f[0],h=f[1],c=f[2];this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=l,this.dec=h,this.init(c)}else if((typeof e=="number"||e===null)&&(typeof i=="number"||i===null)&&(typeof t=="number"||t===null)&&n===void 0&&s===void 0&&r===void 0&&a===void 0){let f=arguments,l=f[0],h=f[1],c=f[2];this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new U.HMS(l/15),this.dec=new G.DMS(h),this.init(c)}else if((typeof e=="string"||e===null)&&(typeof i=="string"||i===null)&&(typeof t=="number"||t===null)&&n===void 0&&s===void 0&&r===void 0&&a===void 0){let f=arguments,l=f[0],h=f[1],c=f[2];this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new U.HMS(l),this.dec=new G.DMS(h),this.init(c)}else if((typeof e=="string"||e===null)&&(typeof i=="string"||i===null)&&(typeof t=="boolean"||t===null)&&n===void 0&&s===void 0&&r===void 0&&a===void 0){let f=arguments,l=f[0],h=f[1],c=f[2];{let u=arguments,g=2e3;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new U.HMS(l,c),this.dec=new G.DMS(h),this.init(g)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if((typeof e=="number"||e===null)&&(typeof i=="number"||i===null)&&(typeof t=="number"||t===null)&&n===void 0&&s===void 0&&r===void 0&&a===void 0){let f=arguments,l=f[0],h=f[1],c=f[2];this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new U.HMS(l/15),this.dec=new G.DMS(h),this.init(c)}else if((e!=null&&e instanceof U.HMS||e===null)&&(i!=null&&i instanceof G.DMS||i===null)&&t===void 0&&n===void 0&&s===void 0&&r===void 0&&a===void 0){let f=arguments,l=f[0],h=f[1];{let c=arguments,u=2e3;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=l,this.dec=h,this.init(u)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if((typeof e=="number"||e===null)&&(typeof i=="number"||i===null)&&t===void 0&&n===void 0&&s===void 0&&r===void 0&&a===void 0){let f=arguments,l=f[0],h=f[1];{let c=arguments,u=c[0],g=c[1],o=2e3;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new U.HMS(u/15),this.dec=new G.DMS(g),this.init(o)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if((typeof e=="string"||e===null)&&(typeof i=="string"||i===null)&&t===void 0&&n===void 0&&s===void 0&&r===void 0&&a===void 0){let f=arguments,l=f[0],h=f[1];{let c=arguments,u=2e3;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new U.HMS(l),this.dec=new G.DMS(h),this.init(u)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if((e!=null&&e instanceof At.Point2D||e===null)&&(typeof i=="number"||i===null)&&t===void 0&&n===void 0&&s===void 0&&r===void 0&&a===void 0){let f=arguments,l=f[0],h=f[1];{let c=arguments,u=l.getX(),g=l.getY();this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new U.HMS(u/15),this.dec=new G.DMS(g),this.init(h)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if((typeof e=="number"||e===null)&&(typeof i=="number"||i===null)&&t===void 0&&n===void 0&&s===void 0&&r===void 0&&a===void 0){let f=arguments,l=f[0],h=f[1];{let c=arguments,u=2e3;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new U.HMS(l/15),this.dec=new G.DMS(h),this.init(u)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if((e!=null&&e instanceof At.Point2D||e===null)&&i===void 0&&t===void 0&&n===void 0&&s===void 0&&r===void 0&&a===void 0){let l=arguments[0];{let h=arguments,c=l.getX(),u=l.getY(),g=2e3;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new U.HMS(c/15),this.dec=new G.DMS(u),this.init(g)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if(e===void 0&&i===void 0&&t===void 0&&n===void 0&&s===void 0&&r===void 0&&a===void 0){let f=arguments;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new U.HMS,this.dec=new G.DMS}else throw new Error("invalid overload")}getRA(){return this.ra}getDec(){return this.dec}getRaDeg(){return this.ra.getVal()*15}getDecDeg(){return this.dec.getVal()}getX(){return this.ra.getVal()*15}getY(){return this.dec.getVal()}toString(){return this.ra.toString$()+", "+this.dec.toString$()+" J2000"}format$double(e){let i=[null,null];if(e===2e3)i[0]=this.ra.toString$(),i[1]=this.dec.toString$();else{let t=new Z(this.ra,this.dec);t.convertEquinox(2e3,e),i[0]=t.ra.toString$(),i[1]=t.dec.toString$()}return i}format(e){if(typeof e=="number"||e===null)return this.format$double(e);if(e===void 0)return this.format$();throw new Error("invalid overload")}format$(){return this.format$double(2e3)}getRaDec(e){let i=[0,0];if(e===2e3)i[0]=this.getRaDeg(),i[1]=this.getDecDeg();else{let t=new Z(this.ra,this.dec);t.convertEquinox(2e3,e),i[0]=t.getRaDeg(),i[1]=t.getDecDeg()}return i}static dispos(e,i,t,n){let s=[0,0],r,a,f,l,h,c,u,g,o,_,x,m,y,D,v=180/Math.PI;r=t/v,a=e/v,f=n/v,l=i/v,u=Math.sin(l),c=Math.sin(f),o=Math.cos(l),g=Math.cos(f),_=Math.cos(r-a),x=u*c+o*g*_;let S=Math.acos(x);return h=0,S>4e-7&&(m=Math.sin(S),D=(c*o-g*u*_)/m,Math.abs(D)>1&&(D=D/Math.abs(D)),y=g*Math.sin(r-a)/m,h=Math.acos(D)*v,y<0&&(h=360-h)),S*=v,S*=60,i===90&&(h=180),i===-90&&(h=0),s[0]=S,s[1]=h,s}dispos(e){return Z.dispos(this.getRaDeg(),this.getDecDeg(),e.getRaDeg(),e.getDecDeg())}static wcsdist(e,i,t,n){let s,r,a,f,l,h,c,u=[0,0,0],g=[0,0,0],o,_=Math.PI/180;for(s=e*_,a=i*_,c=Math.cos(a),u[0]=Math.cos(s)*c,u[1]=Math.sin(s)*c,u[2]=Math.sin(a),r=t*_,f=n*_,c=Math.cos(f),g[0]=Math.cos(r)*c,g[1]=Math.sin(r)*c,g[2]=Math.sin(f),l=0,o=0;o<3;o++)l=l+(u[o]-g[o])*(u[o]-g[o]);return l=l/4,l>1&&(l=1),h=2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)),h*180/Math.PI}dist$coordtxl_coords_WorldCoords(e){return Z.dispos(this.getRaDeg(),this.getDecDeg(),e.getRaDeg(),e.getDecDeg())[0]}dist(e){if(e!=null&&e instanceof Z||e===null)return this.dist$coordtxl_coords_WorldCoords(e);if(e!=null&&e.constructor!=null&&e.constructor.__interfaces!=null&&e.constructor.__interfaces.indexOf("coordtxl.coords.Coordinates")>=0||e===null)return this.dist$coordtxl_coords_Coordinates(e);throw new Error("invalid overload")}dist$coordtxl_coords_Coordinates(e){return this.dist$coordtxl_coords_WorldCoords(e)}static dist(e,i,t,n){return Z.dispos(e,i,t,n)[0]}box(e){let i=[null,null],t=this.ra.getVal(),n=this.dec.getVal();e/=60;let s=Math.sqrt(2*e*e),r,a,f,l,h;return f=n-s/2,f<=-90?(f=-90,l=n+s/2,r=0,a=24):(l=n+s/2,l>=90?(f=n-s/2,l=90,r=0,a=24):(n>0?h=Math.abs(Math.cos(f*Math.PI/180)):h=Math.abs(Math.cos(l*Math.PI/180)),r=t-s/15/2/h,a=t+s/15/2/h,r<0&&(r+=24),a>24&&(a-=24))),i[0]=new Z(r*15,f),i[1]=new Z(a*15,l),i}center(e,i){let t=[0,0,0,0,0],n=e.getRaDeg(),s=e.getDecDeg(),r=i.getRaDeg(),a=i.getDecDeg();return t[0]=(n+r)/2,t[1]=(s+a)/2,t[2]=Z.wcsdist(n,s,r,s)*60,t[3]=Z.wcsdist(n,s,n,a)*60,t[4]=Z.wcsdist(n,s,r,a)*60/2,t}getCoordinateSystemName(){return"wcs"}init(e){this.checkRange(),this.convertEquinox(e,2e3)}convertEquinox(e,i){if(e===i)return;let t=[0,0],n=[0,0];t[0]=this.ra.getVal()*15,t[1]=this.dec.getVal(),ei.JPrec.prej_q(t,n,e,i),this.ra=new U.HMS(n[0]/15),this.dec=new G.DMS(n[1])}checkRange(){let e=this.ra.getVal(),i=this.dec.getVal();e<-.001||e>=25,i<-90||i>90}};We.WorldCoords=Z;Z.__class="coordtxl.coords.WorldCoords";Z.__interfaces=["coordtxl.coords.WorldCoordinates","coordtxl.coords.Coordinates"];var ei=vt(),G=Ct(),U=St()});var jt=B(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.WorldCoords=ae.WCSTransform=ae.MapKeywordProvider=ae.Point2D=void 0;var ti=de();Object.defineProperty(ae,"Point2D",{enumerable:!0,get:function(){return ti.Point2D}});var ii=ut();Object.defineProperty(ae,"MapKeywordProvider",{enumerable:!0,get:function(){return ii.MapKeywordProvider}});var ni=Se();Object.defineProperty(ae,"WCSTransform",{enumerable:!0,get:function(){return ni.WCSTransform}});var si=Et();Object.defineProperty(ae,"WorldCoords",{enumerable:!0,get:function(){return si.WorldCoords}})});function ft(d){if(typeof d._casagui_id_=="undefined"){let e=null;if(typeof window=="undefined"){if(typeof crypto!="undefined"){let n=crypto.randomBytes(8);e=new Uint32Array(n.buffer.slice(-4))}}else e=new Uint32Array(1),window.crypto.getRandomValues(e);let i=new Date,t=Math.floor(i.getTime()/1e3);d._casagui_id_=`${e?e[0]:t}-${t}`}return d._casagui_id_}function ot(){this.timeout=1e3,this.retries=20,this.connected=!0,this.backoff=()=>{this.connected=!1,this.timeout+=Math.floor(lt(1.8,22-this.retries)),this.retries-=1}}function dt(...d){return d[0].map((e,i)=>d.map(t=>t[i]))}function ht(d){return d.length<=0?d:d.reduce((e,i)=>e.map((t,n)=>[...t,i[n]]),d[0].map(e=>[]))}var Ai=Bt(jt());var Ue=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function Ze(d,e,i,t){d.addEventListener?d.addEventListener(e,i,t):d.attachEvent&&d.attachEvent("on".concat(e),function(){i(window.event)})}function Ot(d,e){for(var i=e.slice(0,e.length-1),t=0;t<i.length;t++)i[t]=d[i[t].toLowerCase()];return i}function Vt(d){typeof d!="string"&&(d=""),d=d.replace(/\s/g,"");for(var e=d.split(","),i=e.lastIndexOf("");i>=0;)e[i-1]+=",",e.splice(i,1),i=e.lastIndexOf("");return e}function ri(d,e){for(var i=d.length>=e.length?d:e,t=d.length>=e.length?e:d,n=!0,s=0;s<i.length;s++)t.indexOf(i[s])===-1&&(n=!1);return n}var pe={backspace:8,"\u232B":8,tab:9,clear:12,enter:13,"\u21A9":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"\u21EA":20,",":188,".":190,"/":191,"`":192,"-":Ue?173:189,"=":Ue?61:187,";":Ue?59:186,"'":222,"[":219,"]":221,"\\":220},fe={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,cmd:91,command:91},Qe={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},H={16:!1,18:!1,17:!1,91:!1},R={};for(_e=1;_e<20;_e++)pe["f".concat(_e)]=111+_e;var _e,K=[],$t=!1,wt="all",Lt=[],qe=function(e){return pe[e.toLowerCase()]||fe[e.toLowerCase()]||e.toUpperCase().charCodeAt(0)},ai=function(e){return Object.keys(pe).find(function(i){return pe[i]===e})},li=function(e){return Object.keys(fe).find(function(i){return fe[i]===e})};function Wt(d){wt=d||"all"}function ye(){return wt||"all"}function fi(){return K.slice(0)}function oi(){return K.map(function(d){return ai(d)||li(d)||String.fromCharCode(d)})}function di(d){var e=d.target||d.srcElement,i=e.tagName,t=!0;return(e.isContentEditable||(i==="INPUT"||i==="TEXTAREA"||i==="SELECT")&&!e.readOnly)&&(t=!1),t}function hi(d){return typeof d=="string"&&(d=qe(d)),K.indexOf(d)!==-1}function ui(d,e){var i,t;d||(d=ye());for(var n in R)if(Object.prototype.hasOwnProperty.call(R,n))for(i=R[n],t=0;t<i.length;)i[t].scope===d?i.splice(t,1):t++;ye()===d&&Wt(e||"all")}function ci(d){var e=d.keyCode||d.which||d.charCode,i=K.indexOf(e);if(i>=0&&K.splice(i,1),d.key&&d.key.toLowerCase()==="meta"&&K.splice(0,K.length),(e===93||e===224)&&(e=91),e in H){H[e]=!1;for(var t in fe)fe[t]===e&&(le[t]=!1)}}function gi(d){if(typeof d>"u")Object.keys(R).forEach(function(r){return delete R[r]});else if(Array.isArray(d))d.forEach(function(r){r.key&&Be(r)});else if(typeof d=="object")d.key&&Be(d);else if(typeof d=="string"){for(var e=arguments.length,i=new Array(e>1?e-1:0),t=1;t<e;t++)i[t-1]=arguments[t];var n=i[0],s=i[1];typeof n=="function"&&(s=n,n=""),Be({key:d,scope:n,method:s,splitKey:"+"})}}var Be=function(e){var i=e.key,t=e.scope,n=e.method,s=e.splitKey,r=s===void 0?"+":s,a=Vt(i);a.forEach(function(f){var l=f.split(r),h=l.length,c=l[h-1],u=c==="*"?"*":qe(c);if(!!R[u]){t||(t=ye());var g=h>1?Ot(fe,l):[];R[u]=R[u].filter(function(o){var _=n?o.method===n:!0;return!(_&&o.scope===t&&ri(o.mods,g))})}})};function Pt(d,e,i,t){if(e.element===t){var n;if(e.scope===i||e.scope==="all"){n=e.mods.length>0;for(var s in H)Object.prototype.hasOwnProperty.call(H,s)&&(!H[s]&&e.mods.indexOf(+s)>-1||H[s]&&e.mods.indexOf(+s)===-1)&&(n=!1);(e.mods.length===0&&!H[16]&&!H[18]&&!H[17]&&!H[91]||n||e.shortcut==="*")&&e.method(d,e)===!1&&(d.preventDefault?d.preventDefault():d.returnValue=!1,d.stopPropagation&&d.stopPropagation(),d.cancelBubble&&(d.cancelBubble=!0))}}}function It(d,e){var i=R["*"],t=d.keyCode||d.which||d.charCode;if(!!le.filter.call(this,d)){if((t===93||t===224)&&(t=91),K.indexOf(t)===-1&&t!==229&&K.push(t),["ctrlKey","altKey","shiftKey","metaKey"].forEach(function(o){var _=Qe[o];d[o]&&K.indexOf(_)===-1?K.push(_):!d[o]&&K.indexOf(_)>-1?K.splice(K.indexOf(_),1):o==="metaKey"&&d[o]&&K.length===3&&(d.ctrlKey||d.shiftKey||d.altKey||(K=K.slice(K.indexOf(_))))}),t in H){H[t]=!0;for(var n in fe)fe[n]===t&&(le[n]=!0);if(!i)return}for(var s in H)Object.prototype.hasOwnProperty.call(H,s)&&(H[s]=d[Qe[s]]);d.getModifierState&&!(d.altKey&&!d.ctrlKey)&&d.getModifierState("AltGraph")&&(K.indexOf(17)===-1&&K.push(17),K.indexOf(18)===-1&&K.push(18),H[17]=!0,H[18]=!0);var r=ye();if(i)for(var a=0;a<i.length;a++)i[a].scope===r&&(d.type==="keydown"&&i[a].keydown||d.type==="keyup"&&i[a].keyup)&&Pt(d,i[a],r,e);if(t in R){for(var f=0;f<R[t].length;f++)if((d.type==="keydown"&&R[t][f].keydown||d.type==="keyup"&&R[t][f].keyup)&&R[t][f].key){for(var l=R[t][f],h=l.splitKey,c=l.key.split(h),u=[],g=0;g<c.length;g++)u.push(qe(c[g]));u.sort().join("")===K.sort().join("")&&Pt(d,l,r,e)}}}}function _i(d){return Lt.indexOf(d)>-1}function le(d,e,i){K=[];var t=Vt(d),n=[],s="all",r=document,a=0,f=!1,l=!0,h="+",c=!1;for(i===void 0&&typeof e=="function"&&(i=e),Object.prototype.toString.call(e)==="[object Object]"&&(e.scope&&(s=e.scope),e.element&&(r=e.element),e.keyup&&(f=e.keyup),e.keydown!==void 0&&(l=e.keydown),e.capture!==void 0&&(c=e.capture),typeof e.splitKey=="string"&&(h=e.splitKey)),typeof e=="string"&&(s=e);a<t.length;a++)d=t[a].split(h),n=[],d.length>1&&(n=Ot(fe,d)),d=d[d.length-1],d=d==="*"?"*":qe(d),d in R||(R[d]=[]),R[d].push({keyup:f,keydown:l,scope:s,mods:n,shortcut:t[a],method:i,key:t[a],splitKey:h,element:r});typeof r<"u"&&!_i(r)&&window&&(Lt.push(r),Ze(r,"keydown",function(u){It(u,r)},c),$t||($t=!0,Ze(window,"focus",function(){K=[]},c)),Ze(r,"keyup",function(u){It(u,r),ci(u)},c))}function pi(d){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(R).forEach(function(i){var t=R[i].filter(function(n){return n.scope===e&&n.shortcut===d});t.forEach(function(n){n&&n.method&&n.method()})})}var Je={getPressedKeyString:oi,setScope:Wt,getScope:ye,deleteScope:ui,getPressedKeyCodes:fi,isPressed:hi,filter:di,trigger:pi,unbind:gi,keyMap:pe,modifier:fe,modifierMap:Qe};for(Ne in Je)Object.prototype.hasOwnProperty.call(Je,Ne)&&(le[Ne]=Je[Ne]);var Ne;typeof window<"u"&&(Tt=window.hotkeys,le.noConflict=function(d){return d&&window.hotkeys===le&&(window.hotkeys=Tt),le},window.hotkeys=le);var Tt;function et(d,e){let i=0;if(e===void 0)for(let t of d)t!=null&&(t=+t)>=t&&++i;else{let t=-1;for(let n of d)(n=e(n,++t,d))!=null&&(n=+n)>=n&&++i}return i}function Ke(d,e){let i,t;if(e===void 0)for(let n of d)n!=null&&(i===void 0?n>=n&&(i=t=n):(i>n&&(i=n),t<n&&(t=n)));else{let n=-1;for(let s of d)(s=e(s,++n,d))!=null&&(i===void 0?s>=s&&(i=t=s):(i>s&&(i=s),t<s&&(t=s)))}return[i,t]}var yi=Math.sqrt(50),mi=Math.sqrt(10),xi=Math.sqrt(2);function Xe(d,e,i){let t=(e-d)/Math.max(0,i),n=Math.floor(Math.log10(t)),s=t/Math.pow(10,n),r=s>=yi?10:s>=mi?5:s>=xi?2:1,a,f,l;return n<0?(l=Math.pow(10,-n)/r,a=Math.round(d*l),f=Math.round(e*l),a/l<d&&++a,f/l>e&&--f,l=-l):(l=Math.pow(10,n)*r,a=Math.round(d/l),f=Math.round(e/l),a*l<d&&++a,f*l>e&&--f),f<a&&.5<=i&&i<2?Xe(d,e,i*2):[a,f,l]}function ze(d,e,i){if(e=+e,d=+d,i=+i,!(i>0))return[];if(d===e)return[d];let t=e<d,[n,s,r]=t?Xe(e,d,i):Xe(d,e,i);if(!(s>=n))return[];let a=s-n+1,f=new Array(a);if(t)if(r<0)for(let l=0;l<a;++l)f[l]=(s-l)/-r;else for(let l=0;l<a;++l)f[l]=(s-l)*r;else if(r<0)for(let l=0;l<a;++l)f[l]=(n+l)/-r;else for(let l=0;l<a;++l)f[l]=(n+l)*r;return f}function tt(d,e,i){return e=+e,d=+d,i=+i,Xe(d,e,i)[2]}function Re(d,e,i){let t;for(;;){let n=tt(d,e,i);if(n===t||n===0||!isFinite(n))return[d,e];n>0?(d=Math.floor(d/n)*n,e=Math.ceil(e/n)*n):n<0&&(d=Math.ceil(d*n)/n,e=Math.floor(e*n)/n),t=n}}function ke(d){return Math.max(1,Math.ceil(Math.log(et(d))/Math.LN2)+1)}var bi=Array.prototype,Nt=bi.slice;function qt(d,e){return d-e}function Kt(d){for(var e=0,i=d.length,t=d[i-1][1]*d[0][0]-d[i-1][0]*d[0][1];++e<i;)t+=d[e-1][1]*d[e][0]-d[e-1][0]*d[e][1];return t}var it=d=>()=>d;function Xt(d,e){for(var i=-1,t=e.length,n;++i<t;)if(n=Mi(d,e[i]))return n;return 0}function Mi(d,e){for(var i=e[0],t=e[1],n=-1,s=0,r=d.length,a=r-1;s<r;a=s++){var f=d[s],l=f[0],h=f[1],c=d[a],u=c[0],g=c[1];if(vi(f,c,e))return 0;h>t!=g>t&&i<(u-l)*(t-h)/(g-h)+l&&(n=-n)}return n}function vi(d,e,i){var t;return Ci(d,e,i)&&Di(d[t=+(d[0]===e[0])],i[t],e[t])}function Ci(d,e,i){return(e[0]-d[0])*(i[1]-d[1])===(i[0]-d[0])*(e[1]-d[1])}function Di(d,e,i){return d<=e&&e<=i||i<=e&&e<=d}function zt(){}var oe=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function st(){var d=1,e=1,i=ke,t=f;function n(l){var h=i(l);if(Array.isArray(h))h=h.slice().sort(qt);else{let c=Ke(l,Si);for(h=ze(...Re(c[0],c[1],h),h);h[h.length-1]>=c[1];)h.pop();for(;h[1]<c[0];)h.shift()}return h.map(c=>s(l,c))}function s(l,h){let c=h==null?NaN:+h;if(isNaN(c))throw new Error(`invalid value: ${h}`);var u=[],g=[];return r(l,c,function(o){t(o,l,c),Kt(o)>0?u.push([o]):g.push(o)}),g.forEach(function(o){for(var _=0,x=u.length,m;_<x;++_)if(Xt((m=u[_])[0],o)!==-1){m.push(o);return}}),{type:"MultiPolygon",value:h,coordinates:u}}function r(l,h,c){var u=new Array,g=new Array,o,_,x,m,y,D;for(o=_=-1,m=he(l[0],h),oe[m<<1].forEach(v);++o<d-1;)x=m,m=he(l[o+1],h),oe[x|m<<1].forEach(v);for(oe[m<<0].forEach(v);++_<e-1;){for(o=-1,m=he(l[_*d+d],h),y=he(l[_*d],h),oe[m<<1|y<<2].forEach(v);++o<d-1;)x=m,m=he(l[_*d+d+o+1],h),D=y,y=he(l[_*d+o+1],h),oe[x|m<<1|y<<2|D<<3].forEach(v);oe[m|y<<3].forEach(v)}for(o=-1,y=l[_*d]>=h,oe[y<<2].forEach(v);++o<d-1;)D=y,y=he(l[_*d+o+1],h),oe[y<<2|D<<3].forEach(v);oe[y<<3].forEach(v);function v(S){var I=[S[0][0]+o,S[0][1]+_],$=[S[1][0]+o,S[1][1]+_],W=a(I),O=a($),C,E;(C=g[W])?(E=u[O])?(delete g[C.end],delete u[E.start],C===E?(C.ring.push($),c(C.ring)):u[C.start]=g[E.end]={start:C.start,end:E.end,ring:C.ring.concat(E.ring)}):(delete g[C.end],C.ring.push($),g[C.end=O]=C):(C=u[O])?(E=g[W])?(delete u[C.start],delete g[E.end],C===E?(C.ring.push($),c(C.ring)):u[E.start]=g[C.end]={start:E.start,end:C.end,ring:E.ring.concat(C.ring)}):(delete u[C.start],C.ring.unshift(I),u[C.start=W]=C):u[W]=g[O]={start:W,end:O,ring:[I,$]}}}function a(l){return l[0]*2+l[1]*(d+1)*4}function f(l,h,c){l.forEach(function(u){var g=u[0],o=u[1],_=g|0,x=o|0,m=nt(h[x*d+_]);g>0&&g<d&&_===g&&(u[0]=Rt(g,nt(h[x*d+_-1]),m,c)),o>0&&o<e&&x===o&&(u[1]=Rt(o,nt(h[(x-1)*d+_]),m,c))})}return n.contour=s,n.size=function(l){if(!arguments.length)return[d,e];var h=Math.floor(l[0]),c=Math.floor(l[1]);if(!(h>=0&&c>=0))throw new Error("invalid size");return d=h,e=c,n},n.thresholds=function(l){return arguments.length?(i=typeof l=="function"?l:Array.isArray(l)?it(Nt.call(l)):it(l),n):i},n.smooth=function(l){return arguments.length?(t=l?f:zt,n):t===f},n}function Si(d){return isFinite(d)?d:NaN}function he(d,e){return d==null?!1:+d>=e}function nt(d){return d==null||isNaN(d=+d)?-1/0:d}function Rt(d,e,i,t){let n=t-e,s=i-e,r=isFinite(n)||isFinite(s)?n/s:Math.sign(n)/Math.sign(s);return isNaN(r)?d:d+r-.5}function rt(d,e){for(var i=d.length,t=d[i-1],n=e[0],s=e[1],r=t[0],a=t[1],f,l,h=!1,c=0;c<i;++c)t=d[c],f=t[0],l=t[1],l>s!=a>s&&n<(r-f)*(s-l)/(a-l)+f&&(h=!h),r=f,a=l;return h}var kt={zip:dt,unzip:ht,object_id:ft,coordtxl:Ai,hotkeys:le,ReconnectState:ot,d3:{contours:st,polygonContains:rt},_dummy:void 0};typeof Bokeh!="undefined"&&typeof Bokeh._dummy!="undefined"&&(kt._dummy=Bokeh._dummy);window.casalib=kt;})();
