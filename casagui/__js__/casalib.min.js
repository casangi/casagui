(()=>{var Ce=Object.create;var Gt=Object.defineProperty;var De=Object.getOwnPropertyDescriptor;var Se=Object.getOwnPropertyNames;var Ae=Object.getPrototypeOf,je=Object.prototype.hasOwnProperty;var Ut=Math.pow;var B=(_,t)=>()=>(t||_((t={exports:{}}).exports,t),t.exports);var $e=(_,t,i,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Se(t))!je.call(_,n)&&n!==i&&Gt(_,n,{get:()=>t[n],enumerable:!(e=De(t,n))||e.enumerable});return _};var Ee=(_,t,i)=>(i=_!=null?Ce(Ae(_)):{},$e(t||!_||!_.__esModule?Gt(i,"default",{value:_,enumerable:!0}):i,_));var ot=B(xt=>{"use strict";Object.defineProperty(xt,"__esModule",{value:!0});xt.Point2D=void 0;var qt=class{getX(){return this.x}setX(t){this.x=t}getY(){return this.y}setY(t){this.y=t}setLocation(t,i){this.x=t,this.y=i}constructor(t,i){if((typeof t=="number"||t===null)&&(typeof i=="number"||i===null)){let e=arguments;this.x===void 0&&(this.x=0),this.y===void 0&&(this.y=0),this.x=t,this.y=i}else if(t===void 0&&i===void 0){let e=arguments;this.x===void 0&&(this.x=0),this.y===void 0&&(this.y=0),this.x=0,this.y=0}else throw new Error("invalid overload")}};xt.Point2D=qt;qt.__class="coordtxl.geom.Point2D"});var Bt=B(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});bt.MapKeywordProvider=void 0;var mt=class{constructor(t){this.wcsMap===void 0&&(this.wcsMap=null),this.wcsMap={};{let i=Object.keys(t);for(let e=0;e<i.length;e++){let n=i[e];if(((s,a)=>s[a]===void 0?null:s[a])(t,n)!=null&&((s,a)=>s[a]===void 0?null:s[a])(t,n)instanceof Array){let s=((r,f)=>r[f]===void 0?null:r[f])(t,n);this.wcsMap[n]=(r=>{if(r.clone!=null)return r.clone();{let f=Object.create(r);for(let o in r)r.hasOwnProperty(o)&&(f[o]=r[o]);return f}})(s);let a=1;for(let r=0;r<s.length;r++){let f=s[r];this.wcsMap[n+a]=f,a+=1}}else this.wcsMap[n]=((s,a)=>s[a]===void 0?null:s[a])(t,n)}}}findKey(t){return this.wcsMap.hasOwnProperty(t)}getStringValue$java_lang_String(t){return this.getStringValue$java_lang_String$java_lang_String(t,null)}getStringValue$java_lang_String$java_lang_String(t,i){return this.wcsMap.hasOwnProperty(t)?((e,n)=>e[n]===void 0?null:e[n])(this.wcsMap,t).toString():i}getStringValue(t,i){if((typeof t=="string"||t===null)&&(typeof i=="string"||i===null))return this.getStringValue$java_lang_String$java_lang_String(t,i);if((typeof t=="string"||t===null)&&i===void 0)return this.getStringValue$java_lang_String(t);throw new Error("invalid overload")}getDoubleValue$java_lang_String(t){return this.getDoubleValue$java_lang_String$double(t,0)}getDoubleValue$java_lang_String$double(t,i){if(!this.wcsMap.hasOwnProperty(t))return i;let e=((n,s)=>n[s]===void 0?null:n[s])(this.wcsMap,t);return typeof e=="number"?e:i}getDoubleValue(t,i){if((typeof t=="string"||t===null)&&(typeof i=="number"||i===null))return this.getDoubleValue$java_lang_String$double(t,i);if((typeof t=="string"||t===null)&&i===void 0)return this.getDoubleValue$java_lang_String(t);throw new Error("invalid overload")}getFloatValue$java_lang_String(t){return this.getFloatValue$java_lang_String$float(t,Math.fround(0))}getFloatValue$java_lang_String$float(t,i){if(!this.wcsMap.hasOwnProperty(t))return i;let e=((n,s)=>n[s]===void 0?null:n[s])(this.wcsMap,t);return typeof e=="number"?e:i}getFloatValue(t,i){if((typeof t=="string"||t===null)&&(typeof i=="number"||i===null))return this.getFloatValue$java_lang_String$float(t,i);if((typeof t=="string"||t===null)&&i===void 0)return this.getFloatValue$java_lang_String(t);throw new Error("invalid overload")}getIntValue$java_lang_String(t){return this.getIntValue$java_lang_String$int(t,0)}getIntValue$java_lang_String$int(t,i){if(!this.wcsMap.hasOwnProperty(t))return i;let e=((n,s)=>n[s]===void 0?null:n[s])(this.wcsMap,t);return typeof e=="number"?e|0:i}getIntValue(t,i){if((typeof t=="string"||t===null)&&(typeof i=="number"||i===null))return this.getIntValue$java_lang_String$int(t,i);if((typeof t=="string"||t===null)&&i===void 0)return this.getIntValue$java_lang_String(t);throw new Error("invalid overload")}toString(){let t=!1,i={str:"{ ",toString:function(){return this.str}};{let e=Object.keys(this.wcsMap);for(let n=0;n<e.length;n++){let s=e[n];{t?(r=>(r.str+=", ",r))(i):t=!0,(r=>(r.str+=s,r))(i),(r=>(r.str+="=",r))(i);let a=((r,f)=>r[f]===void 0?null:r[f])(this.wcsMap,s);if(typeof a=="string")(r=>(r.str+='"',r))(i),(r=>(r.str+=a,r))(i),(r=>(r.str+='"',r))(i);else if(a!=null&&a instanceof Array){let r=a,f="[";for(let o=0;o<r.length;++o){o!==0&&(f+=", ");let d=r[o];typeof d=="string"?f+='"'+d+'"':f+=d}f+="]",(o=>(o.str+=f,o))(i)}else(r=>(r.str+=a,r))(i)}}}return(e=>(e.str+=" }",e))(i),i.str}};bt.MapKeywordProvider=mt;mt.__class="coordtxl.coords.MapKeywordProvider";mt.__interfaces=["coordtxl.coords.WCSKeywordProvider"]});var Jt=B(Mt=>{"use strict";Object.defineProperty(Mt,"__esModule",{value:!0});Mt.slasubs=void 0;var Pe=ot(),it=class{static slaDcs2c(t,i){let e=Math.cos(i),n=[0,0,0];return n[0]=Math.cos(t)*e,n[1]=Math.sin(t)*e,n[2]=Math.sin(i),n}static slaDmxv(t,i){let e,n,s,a=[0,0,0],r=[0,0,0];for(n=0;n<3;n++){for(s=0,e=0;e<3;e++)s+=t[n][e]*i[e];a[n]=s}for(n=0;n<3;n++)r[n]=a[n];return r}static slaDcc2s(t){let i,e,n,s;i=t[0],e=t[1],n=t[2],s=Math.sqrt(i*i+e*e);let a=new Pe.Point2D;return a.x=s!==0?Math.atan2(e,i):0,a.y=n!==0?Math.atan2(n,s):0,a}static slaDranrm(t){let i;return i=((e,n)=>{let s=Math.abs(e%n);return isNaN(s)||s==n||s<=Math.abs(n)/2?s:(e>0?1:-1)*(s-n)})(t,it.D2PI),i>=0?i:i+it.D2PI}static slaDeuler(t,i,e,n){let s,a,r,f,o,d=function(y){let C=function(v){if(v.length===0)return 0;{let D=[];for(let $=0;$<v[0];$++)D.push(C(v.slice(1)));return D}};return C(y)}([3,3]),u=function(y){let C=function(v){if(v.length===0)return 0;{let D=[];for(let $=0;$<v[0];$++)D.push(C(v.slice(1)));return D}};return C(y)}([3,3]),h,c,l,p,M=function(y){let C=function(v){if(v.length===0)return 0;{let D=[];for(let $=0;$<v[0];$++)D.push(C(v.slice(1)));return D}};return C(y)}([3,3]),x;for(s=0;s<3;s++)for(a=0;a<3;a++)d[a][s]=a===s?1:0;for(r=t.length,f=0;f<3;f++)if(f<=r){for(s=0;s<3;s++)for(a=0;a<3;a++)u[a][s]=a===s?1:0;switch(f){case 0:default:h=i;break;case 1:h=e;break;case 2:h=n;break}for(c=Math.sin(h),l=Math.cos(h),x=t.charAt(f),(y=>y.charCodeAt==null?y:y.charCodeAt(0))(x)=="X".charCodeAt(0)||(y=>y.charCodeAt==null?y:y.charCodeAt(0))(x)=="x".charCodeAt(0)||(y=>y.charCodeAt==null?y:y.charCodeAt(0))(x)=="1".charCodeAt(0)?(u[1][1]=l,u[1][2]=c,u[2][1]=-c,u[2][2]=l):(y=>y.charCodeAt==null?y:y.charCodeAt(0))(x)=="Y".charCodeAt(0)||(y=>y.charCodeAt==null?y:y.charCodeAt(0))(x)=="y".charCodeAt(0)||(y=>y.charCodeAt==null?y:y.charCodeAt(0))(x)=="2".charCodeAt(0)?(u[0][0]=l,u[0][2]=-c,u[2][0]=c,u[2][2]=l):(y=>y.charCodeAt==null?y:y.charCodeAt(0))(x)=="Z".charCodeAt(0)||(y=>y.charCodeAt==null?y:y.charCodeAt(0))(x)=="z".charCodeAt(0)||(y=>y.charCodeAt==null?y:y.charCodeAt(0))(x)=="3".charCodeAt(0)?(u[0][0]=l,u[0][1]=c,u[1][0]=-c,u[1][1]=l):r=0,a=0;a<3;a++)for(s=0;s<3;s++){for(p=0,o=0;o<3;o++)p+=u[a][o]*d[o][s];M[a][s]=p}for(s=0;s<3;s++)for(a=0;a<3;a++)d[a][s]=M[a][s]}return d}static slDE2H(t,i,e){let n=[0,0],s=Math.sin(t),a=Math.cos(t),r=Math.sin(i),f=Math.cos(i),o=Math.sin(e),d=Math.cos(e),u=-a*f*o+r*d,h=-s*f,c=a*f*d+r*o,l=Math.sqrt(u*u+h*h),p;return l===0?p=0:p=Math.atan2(h,u),p<0&&(p=p+2*Math.PI),n[0]=p,n[1]=Math.atan2(c,l),n}static slDVTP(t,i){let e,n=t[0],s=t[1],a=t[2],r=i[0],f=i[1],o=i[2],d=r*r+f*f,u=Math.sqrt(d);u===0&&(u=1e-20,r=u);let h=n*r+s*f,c=h+a*o;c>it.TINY?e=0:c>=0?(e=1,c=it.TINY):c>-it.TINY?(e=2,c=-it.TINY):e=3,c=c*u;let l=(s*r-n*f)/c,p=(a*d-o*h)/c;return e!==0&&console.info("ERROR: From slDVTP, J = "+e),[l,p]}};Mt.slasubs=it;it.TINY=1e-6;it.D2PI=6.283185307179586;it.__class="coordtxl.coords.slasubs"});var Qt=B(vt=>{"use strict";Object.defineProperty(vt,"__esModule",{value:!0});vt.wcscon=void 0;var z=ot(),b=class{static a_$LI$(){return b.a==null&&(b.a=[-162557e-11,-31919e-11,-13843e-11]),b.a}static ad_$LI$(){return b.ad==null&&(b.ad=[.001245,-.00158,-659e-6]),b.ad}static emi_$LI$(){return b.emi==null&&(b.emi=[[.99992567949991,-.011181482788805,-.004859004008828,-.000541640798032,-.237963047085011,.436218238658637],[.011181482840782,.999937484898031,-27155744957e-15,.237912530551179,-.00266070648897,-.008537588719453],[.004859003889183,-27177143501e-15,.999988194601879,-.436101961325347,.012258830424865,.002119065556992],[-2423898405e-15,27105439e-15,11777422e-15,.999904322043106,-.011181451601069,-.004858519608686],[-27105439e-15,-2423927017e-15,65851e-15,.011181451608968,.999916125340107,-27162614355e-15],[-11777422e-15,65846e-15,-2424049954e-15,.004858519590501,-27165866691e-15,.999966838131419]]),b.emi}static fk524(t){let i=new z.Point2D(0,0);return b.fk524m(t,i)}static fk524e(t,i){let e=new z.Point2D(0,0),n=b.fk524m(t,e);return n.x=n.x+e.x*(i-1950),n.y=n.y+e.y*(i-1950),n}static fk524m(t,i){let e,n,s,a,r,f,o,d,u,h,c,l,p,M,x,y,C,v,D=[0,0,0,0,0,0],$=[0,0,0,0,0,0],E,X,O,P,T,V,j,g,m=6.283185307179586,S,w=1e-30,A=0;for(S=100*60*60*360/m,e=I.WCSTransform.degrad(t.x),n=I.WCSTransform.degrad(t.y),s=I.WCSTransform.degrad(i.x),a=I.WCSTransform.degrad(i.y),u=s*S,h=a*S,c=Math.sin(e),l=Math.cos(e),p=Math.sin(n),M=Math.cos(n),x=l*M,y=c*M,C=p,D[0]=x,D[1]=y,D[2]=C,u!==A||h!==A?(D[3]=-(u*y)-l*p*h,D[4]=u*x-c*p*h,D[5]=M*h):(D[3]=A,D[4]=A,D[5]=A),j=0;j<6;j++){for(v=A,g=0;g<6;g++)v=v+b.emi_$LI$()[g][j]*D[g];$[j]=v}return x=$[0],y=$[1],C=$[2],E=$[3],X=$[4],O=$[5],P=Math.sqrt(x*x+y*y+C*C),x=x+b.a_$LI$()[0]*P,y=y+b.a_$LI$()[1]*P,C=C+b.a_$LI$()[2]*P,E=E+b.ad_$LI$()[0]*P,X=X+b.ad_$LI$()[1]*P,O=O+b.ad_$LI$()[2]*P,T=x*x+y*y,V=Math.sqrt(T),x===A&&y===A?r=A:(r=Math.atan2(y,x),r<A&&(r=r+m)),f=Math.atan2(C,V),V>w&&(u=(x*X-y*E)/T,h=(O*T-C*(x*E+y*X))/((T+C*C)*V)),o=u/S,d=h/S,t.x=I.WCSTransform.raddeg(r),t.y=I.WCSTransform.raddeg(f),i.x=I.WCSTransform.raddeg(o),i.y=I.WCSTransform.raddeg(d),t}static em_$LI$(){return b.em==null&&(b.em=[[.999925678186902,.011182059571766,.004857946721186,-.000541652366951,.237917612131583,-.43611127603927],[-.011182059642247,.999937478448132,-27147426498e-15,-.237968129744288,-.002660763319071,.012259092261564],[-.00485794655896,-27176441185e-15,.99998819973877,.436227555856097,-.008537771074048,.002119110818172],[2423950176e-15,27106627e-15,11776559e-15,.999947035154614,.011182506007242,.00485766994865],[-27106627e-15,2423978783e-15,-65816e-15,-.011182506121805,.999958833818833,-27137309539e-15],[-11776558e-15,-65874e-15,2424101735e-15,-.004857669684959,-27184471371e-15,1.000009560363559]]),b.em}static fk425(t){let i=new z.Point2D(0,0);return b.fk425m(t,i)}static fk425e(t,i){let e=new z.Point2D(0,0),n=b.fk425m(t,e);return n.x=n.x+e.x*(i-2e3),n.y=n.y+e.y*(i-2e3),n}static fk425m(t,i){let e,n,s,a,r,f,o,d,u,h,c,l,p,M,x,y,C,v,D,$,E,X,O,P,T,V,j,g,m=[0,0,0],S=[0,0,0],w=[0,0,0,0,0,0],A=[0,0,0,0,0,0],W=6.283185307179586,H,et=1e-30,J=0;for(H=100*60*60*360/W,e=I.WCSTransform.degrad(t.x),n=I.WCSTransform.degrad(t.y),s=I.WCSTransform.degrad(i.x),a=I.WCSTransform.degrad(i.y),u=s*H,h=a*H,c=Math.sin(e),l=Math.cos(e),p=Math.sin(n),M=Math.cos(n),m[0]=l*M,m[1]=c*M,m[2]=p,S[0]=-c*M*u-l*p*h,S[1]=l*M*u-c*p*h,S[2]=M*h,x=m[0]*b.a_$LI$()[0]+m[1]*b.a_$LI$()[1]+m[2]*b.a_$LI$()[2],y=m[0]*b.ad_$LI$()[0]+m[1]*b.ad_$LI$()[1]+m[2]*b.ad_$LI$()[2],j=0;j<3;j++)w[j]=m[j]-b.a_$LI$()[j]+x*m[j],w[j+3]=S[j]-b.ad_$LI$()[j]+y*m[j];for(j=0;j<6;j++){for(x=J,g=0;g<6;g++)x=x+b.em_$LI$()[g][j]*w[g];A[j]=x}return C=A[0],v=A[1],D=A[2],$=A[3],E=A[4],X=A[5],O=C*C+v*v,P=O+D*D,T=Math.sqrt(O),V=C*$+v*E,C===J&&v===J?r=J:(r=Math.atan2(v,C),r<J&&(r=r+W)),f=Math.atan2(D,T),T>et&&(u=(C*E-v*$)/O,h=(X*O-D*V)/(P*T)),o=u/H,d=h/H,t.x=I.WCSTransform.raddeg(r),t.y=I.WCSTransform.raddeg(f),i.x=I.WCSTransform.raddeg(o),i.y=I.WCSTransform.raddeg(d),t}static bgal_$LI$(){return b.bgal==null&&(b.bgal=[[-.066988739415,-.872755765852,-.483538914632],[.492728466075,-.45034695802,.744584633283],[-.867600811151,-.188374601723,.460199784784]]),b.bgal}static fk42gal(t){let i=[0,0,0],e=[0,0,0],n,s,a,r,f,o,d;f=t.x,o=t.y,a=I.WCSTransform.degrad(f),r=I.WCSTransform.degrad(o);let u=new z.Point2D,h=new z.Point2D;for(b.jpcop(a,r,1,u,h),i[0]=u.x,i[1]=u.y,i[2]=h.x,d=0;d<3;d++)e[d]=i[0]*b.bgal_$LI$()[d][0]+i[1]*b.bgal_$LI$()[d][1]+i[2]*b.bgal_$LI$()[d][2];let c=new z.Point2D,l=new z.Point2D;return b.jpcon(e,c,l),n=I.WCSTransform.raddeg(c.x),s=I.WCSTransform.raddeg(c.y),t.x=n,t.y=s,b.idg>0,t}static gal2fk4(t){let i=[0,0,0],e=[0,0,0],n,s,a,r,f,o,d;n=t.x,s=t.y,a=I.WCSTransform.degrad(n),r=I.WCSTransform.degrad(s);let u=new z.Point2D,h=new z.Point2D;for(b.jpcop(a,r,1,u,h),i[0]=u.x,i[1]=u.y,i[2]=h.x,d=0;d<3;d++)e[d]=i[0]*b.bgal_$LI$()[0][d]+i[1]*b.bgal_$LI$()[1][d]+i[2]*b.bgal_$LI$()[2][d];let c=new z.Point2D,l=new z.Point2D;return b.jpcon(e,c,l),f=I.WCSTransform.raddeg(c.x),o=I.WCSTransform.raddeg(c.y),t.x=f,t.y=o,b.idg>0,t}static jgal_$LI$(){return b.jgal==null&&(b.jgal=[[-.054875539726,-.87343710801,-.483834985808],[.494109453312,-.444829589425,.74698225181],[-.867666135858,-.198076386122,.455983795705]]),b.jgal}static fk52gal(t){let i=[0,0,0],e=[0,0,0],n,s,a,r,f,o,d;f=t.x,o=t.y,a=I.WCSTransform.degrad(f),r=I.WCSTransform.degrad(o);let u=new z.Point2D,h=new z.Point2D;for(b.jpcop(a,r,1,u,h),i[0]=u.x,i[1]=u.y,i[2]=h.x,d=0;d<3;d++)e[d]=i[0]*b.jgal_$LI$()[d][0]+i[1]*b.jgal_$LI$()[d][1]+i[2]*b.jgal_$LI$()[d][2];let c=new z.Point2D,l=new z.Point2D;return b.jpcon(e,c,l),n=I.WCSTransform.raddeg(c.x),s=I.WCSTransform.raddeg(c.y),t.x=n,t.y=s,b.idg>0,t}static gal2fk5(t){let i=[0,0,0],e=[0,0,0],n,s,a,r,f,o,d;n=t.x,s=t.y,a=I.WCSTransform.degrad(n),r=I.WCSTransform.degrad(s);let u=new z.Point2D,h=new z.Point2D;for(b.jpcop(a,r,1,u,h),i[0]=u.x,i[1]=u.y,i[2]=h.x,d=0;d<3;d++)e[d]=i[0]*b.jgal_$LI$()[0][d]+i[1]*b.jgal_$LI$()[1][d]+i[2]*b.jgal_$LI$()[2][d];let c=new z.Point2D,l=new z.Point2D;return b.jpcon(e,c,l),f=I.WCSTransform.raddeg(c.x),o=I.WCSTransform.raddeg(c.y),t.x=f,t.y=o,b.idg>0,t}static jpcon(t,i,e){let n,s,a,r,f,o;n=t[0],s=t[1],a=t[2],i.x=Math.atan2(s,n),i.x<0&&(i.x=i.x+6.283185307179586),f=n*n+s*s,r=Math.sqrt(f),i.y=Math.atan2(a,r),o=a*a,e.x=Math.sqrt(f+o)}static jpcop(t,i,e,n,s){n.x=e*Math.cos(t)*Math.cos(i),n.y=e*Math.sin(t)*Math.cos(i),s.x=e*Math.sin(i)}static fk4prec(t,i,e){let n=I.WCSTransform.degrad(e.x),s=I.WCSTransform.degrad(e.y),a=b.mprecfk4(t,i),r=nt.slasubs.slaDcs2c(n,s),f=nt.slasubs.slaDmxv(a,r),o=nt.slasubs.slaDcc2s(f);return n=o.x,s=o.y,n=nt.slasubs.slaDranrm(n),e.x=I.WCSTransform.raddeg(n),e.y=I.WCSTransform.raddeg(s),e}static fk5prec(t,i,e){let n=I.WCSTransform.degrad(e.x),s=I.WCSTransform.degrad(e.y),a=b.mprecfk5(t,i),r=nt.slasubs.slaDcs2c(n,s),f=nt.slasubs.slaDmxv(a,r),o=nt.slasubs.slaDcc2s(f);return n=o.x,s=o.y,n=nt.slasubs.slaDranrm(n),e.x=I.WCSTransform.raddeg(n),e.y=I.WCSTransform.raddeg(s),e}static mprecfk4(t,i){let e,n,s,a,r,f,o;return e=(t-1850)/100,n=(i-t)/100,s=n*b.DAS2R,a=2303.5548+(1.3972+59e-6*e)*e,r=(a+(.30242-269e-6*e+.017996*n)*n)*s,f=(a+(1.09478+387e-6*e+.018324*n)*n)*s,o=(2005.1125+(-.85294-365e-6*e)*e+(-.42647-365e-6*e-.041802*n)*n)*s,nt.slasubs.slaDeuler("ZYZ",-r,o,-f)}static mprecfk5(t,i){let e,n,s,a,r,f,o;return e=(t-2e3)/100,n=(i-t)/100,s=n*b.DAS2R,a=2306.2181+(1.39656-139e-6*e)*e,r=(a+(.30188-344e-6*e+.017998*n)*n)*s,f=(a+(1.09468+66e-6*e+.018203*n)*n)*s,o=(2004.3109+(-.8533-217e-6*e)*e+(-.42665-217e-6*e-.041833*n)*n)*s,nt.slasubs.slaDeuler("ZYZ",-r,o,-f)}};vt.wcscon=b;b.idg=0;b.DAS2R=484813681109536e-20;b.__class="coordtxl.coords.wcscon";var nt=Jt(),I=Ct()});var te=B(Dt=>{"use strict";Object.defineProperty(Dt,"__esModule",{value:!0});Dt.worldpos=void 0;var Nt=ot(),Kt=class{static getPosition(t,i,e){let n,s,a,r,f,o,d,u,h=0,c=0,l,p,M,x,y,C,v,D,$,E,X,O,P,T,V,j=.01745329252,g=6.28318530717959,m=1e-5,S,w,A,W,H,et,J,pt=e.pcode,dt,yt;if(S=e.xref,w=e.yref,A=e.xrefpix,W=e.yrefpix,H=e.xinc,et=e.yinc,J=L.WCSTransform.degrad(e.rot),n=Math.cos(J),s=Math.sin(J),a=t-A,r=i-W,e.rotmat>0)o=a*e.cd11+r*e.cd12,r=a*e.cd21+r*e.cd22,a=o;else{if(H===0||et===0)return null;a=a*H,r=r*et,J!==0&&(o=a*n-r*s,r=a*s+r*n,a=o)}if(dt=S+a,yt=w+r,pt<0)return new Nt.Point2D(dt,yt);switch(e.coorflip>0?($=L.WCSTransform.degrad(S),E=L.WCSTransform.degrad(w),o=a,a=r,r=o):(E=L.WCSTransform.degrad(S),$=L.WCSTransform.degrad(w)),p=L.WCSTransform.degrad(a),M=L.WCSTransform.degrad(r),d=p*p+M*M,v=Math.cos($),D=Math.sin($),pt){case-1:case 0:c=E+p,h=$+M;break;case 1:if(u=Math.sqrt(1-d),l=D*u+v*M,l>1||l<-1||(h=Math.asin(l),c=v*u-D*M,c===0&&p===0))return null;c=Math.atan2(p,c)+E;break;case 2:if(h=v-M*D,h===0)return null;c=E+Math.atan2(p,h),h=Math.atan(Math.cos(c-E)*(M*v+D)/h);break;case 3:if(d>=g*g/4||(d=Math.sqrt(d),u=Math.cos(d),d!==0?d=Math.sin(d)/d:d=1,l=M*v*d+D*u,l>1||l<-1)||(h=Math.asin(l),y=u-l*D,l=p*d*v,y===0&&l===0))return null;c=E+Math.atan2(l,y);break;case 4:if(h=v-M*D,h===0||(c=E+Math.atan2(p,h),l=Math.cos(c-E),l===0)||(h=h/l,h>1||h<-1))return null;h=Math.acos(h),$<0&&(h=-h);break;case 5:if(h=$+M,Math.abs(h)>g/4||(u=Math.cos(h),Math.abs(p)>g*u/2))return null;c=E,u>m&&(c=c+p/u);break;case 6:if(l=et*n+H*s,l===0&&(l=1),r=L.WCSTransform.degrad(w/2+45),a=r+l/2*j,r=Math.log(Math.tan(r)),a=Math.log(Math.tan(a)),T=L.WCSTransform.degrad(l)/(a-r),V=T*r,P=Math.cos(L.WCSTransform.degrad(w)),P<=0&&(P=1),c=p/P+E,Math.abs(c-E)>g)return null;l=0,T!==0&&(l=(M+V)/T),l=Math.exp(l),h=2*Math.atan(l)-g/4;break;case 7:if(l=et*n+H*s,l===0&&(l=1),l=L.WCSTransform.degrad(l),r=L.WCSTransform.degrad(w),a=Math.sin(r+l)/Math.sqrt((1+Math.cos(r+l))/2)-Math.sin(r)/Math.sqrt((1+Math.cos(r))/2),a===0&&(a=1),T=l/a,l=H*n-et*s,l===0&&(l=1),l=L.WCSTransform.degrad(l),a=2*Math.cos(r)*Math.sin(l/2),a===0&&(a=1),P=l*Math.sqrt((1+Math.cos(r)*Math.cos(l/2))/2)/a,V=T*Math.sin(r)/Math.sqrt((1+Math.cos(r))/2),c=E,h=$,p===0&&M===0)break;if(f=4-p*p/(4*P*P)-(M+V)/T*((M+V)/T),f>4||f<2||(f=.5*Math.sqrt(f),C=(M+V)*f/T,Math.abs(C)>1)||(C=Math.asin(C),Math.abs(Math.cos(C))<m)||(y=p*f/(2*P*Math.cos(C)),Math.abs(y)>1))return null;y=Math.asin(y),c=E+2*y,h=C;break;case 8:if(f=(4-d)/(4+d),Math.abs(f)>1||(h=f*D+M*v*(1+f)/2,Math.abs(h)>1)||(h=Math.asin(h),c=Math.cos(h),Math.abs(c)<m)||(c=p*(1+f)/(2*c),Math.abs(c)>1)||(c=Math.asin(c),x=1+Math.sin(h)*D+Math.cos(h)*v*Math.cos(c),Math.abs(x)<m))return null;x=2*(Math.sin(h)*v-Math.cos(h)*D*Math.cos(c))/x,Math.abs(x-M)>m&&(c=g/2-c),c=E+c;break}return O=c,X=h,O-E>g/2&&(O=O-g),O-E<-g/2&&(O=O+g),O<0&&(O+=g),dt=L.WCSTransform.raddeg(O),yt=L.WCSTransform.raddeg(X),new Nt.Point2D(dt,yt)}static getPixels(t,i,e){let n,s,a=0,r=0,f=0,o=0,d=0,u=0,h,c,l,p=0,M=0,x=0,y,C,v,D,$,E,X=.01745329252,O=1e-5,P=6.28318530717959,T,V,j,g,m,S,w,A;switch(T=e.xref,V=e.yref,j=e.xrefpix,g=e.yrefpix,m=e.xinc,S=e.yinc,w=L.WCSTransform.degrad(e.rot),$=Math.cos(w),D=Math.sin(w),A=e.pcode,A>0&&A<9&&(e.coorflip>0?(r=L.WCSTransform.degrad(T),a=L.WCSTransform.degrad(V),h=t-V):(a=L.WCSTransform.degrad(T),r=L.WCSTransform.degrad(V),h=t-T),A>=0&&(h>180&&(t-=360),h<-180&&(t+=360)),f=L.WCSTransform.degrad(t),o=L.WCSTransform.degrad(i),d=Math.cos(o),u=Math.sin(o),M=Math.sin(f-a)*d,p=u*Math.sin(r)+d*Math.cos(r)*Math.cos(f-a)),A){case 1:if(p<0)return null;x=u*Math.cos(r)-d*Math.sin(r)*Math.cos(f-a);break;case 2:if(p<=0)return null;x=u*Math.sin(r)+d*Math.cos(r)*Math.cos(f-a),M=M/x,x=(u*Math.cos(r)-d*Math.sin(r)*Math.cos(f-a))/x;break;case 3:x=u*Math.sin(r)+d*Math.cos(r)*Math.cos(f-a),x<-1&&(x=-1),x>1&&(x=1),x=Math.acos(x),x!==0?x=x/Math.sin(x):x=1,M=M*x,x=(u*Math.cos(r)-d*Math.sin(r)*Math.cos(f-a))*x;break;case 4:if(r===0)return null;x=(Math.cos(r)-d*Math.cos(f-a))/Math.sin(r);break;case 5:if(h=f-a,Math.abs(o)>P/4||Math.abs(r)>P/4)return null;x=o-r,M=h*d;break;case 6:if(h=S*$+m*D,h===0&&(h=1),s=L.WCSTransform.degrad(V/2+45),n=s+h/2*X,s=Math.log(Math.tan(s)),n=Math.log(Math.tan(n)),C=L.WCSTransform.degrad(h)/(n-s),v=C*s,y=Math.cos(L.WCSTransform.degrad(V)),y<=0&&(y=1),h=f-a,M=y*h,h=o/2+P/8,h=Math.tan(h),h<O)return null;x=C*Math.log(h)-v;break;case 7:if(c=(f-a)/2,Math.abs(c)>P/4||(h=S*$+m*D,h===0&&(h=1),h=L.WCSTransform.degrad(h),s=L.WCSTransform.degrad(V),n=Math.sin(s+h)/Math.sqrt((1+Math.cos(s+h))/2)-Math.sin(s)/Math.sqrt((1+Math.cos(s))/2),n===0&&(n=1),C=h/n,h=m*$-S*D,h===0&&(h=1),h=L.WCSTransform.degrad(h),n=2*Math.cos(s)*Math.sin(h/2),n===0&&(n=1),y=h*Math.sqrt((1+Math.cos(s)*Math.cos(h/2))/2)/n,v=C*Math.sin(s)/Math.sqrt((1+Math.cos(s))/2),h=Math.sqrt((1+Math.cos(o)*Math.cos(c))/2),Math.abs(h)<O))return null;M=2*y*Math.cos(o)*Math.sin(c)/h,x=C*Math.sin(o)/h-v;break;case 8:if(c=f-a,Math.abs(o)>P/4||(l=1+u*Math.sin(r)+d*Math.cos(r)*Math.cos(c),Math.abs(l)<O))return null;l=2/l,M=M*l,x=l*(u*Math.cos(r)-d*Math.sin(r)*Math.cos(c));break}A>0&&A<9?(n=L.WCSTransform.raddeg(M),s=L.WCSTransform.raddeg(x)):(n=t-T,s=i-V),e.coorflip>0&&(E=n,n=s,s=E),e.rotmat>0?(E=n*e.dc11+s*e.dc12,s=n*e.dc21+s*e.dc22,n=E):(w!==0&&(E=n*$+s*D,s=s*$-n*D,n=E),m!==0&&(n=n/m),S!==0&&(s=s/S));let W=n+j,H=s+g;return new Nt.Point2D(W,H)}};Dt.worldpos=Kt;Kt.__class="coordtxl.coords.worldpos";var L=Ct()});var ie=B(St=>{"use strict";Object.defineProperty(St,"__esModule",{value:!0});St.platepos=void 0;var ee=ot(),K=class{static getPosition(t,i,e){let n,s,a,r,f,o,d,u,h,c,l,p,M,x,y,C,v,D;return n=t+e.x_pixel_offset-1+.5,s=i+e.y_pixel_offset-1+.5,a=(e.ppo_coeff[2]-n*e.x_pixel_size)/1e3,r=(s*e.y_pixel_size-e.ppo_coeff[5])/1e3,f=a*a,o=r*r,d=a*f,u=r*o,h=f+o,c=e.amd_x_coeff[0]*a+e.amd_x_coeff[1]*r+e.amd_x_coeff[2]+e.amd_x_coeff[3]*f+e.amd_x_coeff[4]*a*r+e.amd_x_coeff[5]*o+e.amd_x_coeff[6]*h+e.amd_x_coeff[7]*d+e.amd_x_coeff[8]*f*r+e.amd_x_coeff[9]*a*o+e.amd_x_coeff[10]*u+e.amd_x_coeff[11]*a*h+e.amd_x_coeff[12]*a*h*h,p=e.amd_y_coeff[0]*r+e.amd_y_coeff[1]*a+e.amd_y_coeff[2]+e.amd_y_coeff[3]*o+e.amd_y_coeff[4]*a*r+e.amd_y_coeff[5]*f+e.amd_y_coeff[6]*h+e.amd_y_coeff[7]*u+e.amd_y_coeff[8]*o*a+e.amd_y_coeff[9]*r*f+e.amd_y_coeff[10]*d+e.amd_y_coeff[11]*r*h+e.amd_y_coeff[12]*r*h*h,l=c/K.CONS2R,M=p/K.CONS2R,v=Math.tan(e.plate_dec),D=Math.cos(e.plate_dec),x=Math.atan2(l/D,1-M*v),y=x+e.plate_ra,y<0&&(y=y+K.TWOPI),C=Math.atan(Math.cos(x)/((1-M*v)/(M+v))),new ee.Point2D(y/K.COND2R,C/K.COND2R)}static getPixels(t,i,e){let n,s,a,r,f,o,d,u,h,c,l,p,M,x,y,C,v,D,$,E,X,O,P,T,V,j,g,m,S,w,A,W,H,et,J;for(et=t*K.COND2R,J=i*K.COND2R,$=Math.sin(J),E=Math.cos(J),X=Math.sin(e.plate_dec),O=Math.cos(e.plate_dec),P=Math.sin(et-e.plate_ra),T=Math.cos(et-e.plate_ra),n=$*X+E*O*T,s=E*P*K.CONR2S/n,a=($*O-E*X*T)*K.CONR2S/n,A=s/e.plate_scale,W=a/e.plate_scale,H=0;H<K.MAX_ITERATIONS&&(o=A*W,d=A*A,u=W*W,h=d*W,c=u*A,y=d+u,C=y*y,l=d*A,p=u*W,M=d*d,x=u*u,V=e.amd_x_coeff[0]*A+e.amd_x_coeff[1]*W+e.amd_x_coeff[2]+e.amd_x_coeff[3]*d+e.amd_x_coeff[4]*o+e.amd_x_coeff[5]*u+e.amd_x_coeff[6]*y+e.amd_x_coeff[7]*l+e.amd_x_coeff[8]*h+e.amd_x_coeff[9]*c+e.amd_x_coeff[10]*p+e.amd_x_coeff[11]*A*y+e.amd_x_coeff[12]*A*C,j=e.amd_x_coeff[0]+e.amd_x_coeff[3]*2*A+e.amd_x_coeff[4]*W+e.amd_x_coeff[6]*2*A+e.amd_x_coeff[7]*3*d+e.amd_x_coeff[8]*2*o+e.amd_x_coeff[9]*u+e.amd_x_coeff[11]*(3*d+u)+e.amd_x_coeff[12]*(5*M+6*d*u+x),g=e.amd_x_coeff[1]+e.amd_x_coeff[4]*A+e.amd_x_coeff[5]*2*W+e.amd_x_coeff[6]*2*W+e.amd_x_coeff[8]*d+e.amd_x_coeff[9]*2*o+e.amd_x_coeff[10]*3*u+e.amd_x_coeff[11]*2*o+e.amd_x_coeff[12]*4*o*y,m=e.amd_y_coeff[0]*W+e.amd_y_coeff[1]*A+e.amd_y_coeff[2]+e.amd_y_coeff[3]*u+e.amd_y_coeff[4]*o+e.amd_y_coeff[5]*d+e.amd_y_coeff[6]*y+e.amd_y_coeff[7]*p+e.amd_y_coeff[8]*c+e.amd_y_coeff[9]*h+e.amd_y_coeff[10]*l+e.amd_y_coeff[11]*W*y+e.amd_y_coeff[12]*W*C,S=e.amd_y_coeff[1]+e.amd_y_coeff[4]*W+e.amd_y_coeff[5]*2*A+e.amd_y_coeff[6]*2*A+e.amd_y_coeff[8]*u+e.amd_y_coeff[9]*2*o+e.amd_y_coeff[10]*3*d+e.amd_y_coeff[11]*2*o+e.amd_y_coeff[12]*4*o*y,w=e.amd_y_coeff[0]+e.amd_y_coeff[3]*2*W+e.amd_y_coeff[4]*A+e.amd_y_coeff[6]*2*W+e.amd_y_coeff[7]*3*u+e.amd_y_coeff[8]*2*o+e.amd_y_coeff[9]*d+e.amd_y_coeff[11]*(d+3*u)+e.amd_y_coeff[12]*(5*x+6*d*u+M),V=V-s,m=m-a,v=(-V*w+m*g)/(j*w-g*S),D=(-m*j+V*S)/(j*w-g*S),A=A+v,W=W+D,!(Math.abs(v)<K.TOLERANCE&&Math.abs(D)<K.TOLERANCE));H++);r=(e.ppo_coeff[2]-A*1e3)/e.x_pixel_size,f=(e.ppo_coeff[5]+W*1e3)/e.y_pixel_size;let pt=r-e.x_pixel_offset+1-.5,dt=f-e.y_pixel_offset+1-.5;return new ee.Point2D(pt,dt)}};St.platepos=K;K.COND2R=.01745329252;K.CONS2R=206264.8062470964;K.TWOPI=6.28318530717959;K.MAX_ITERATIONS=50;K.TOLERANCE=5e-7;K.CONR2S=206264.8062470964;K.__class="coordtxl.coords.platepos"});var Ct=B(jt=>{"use strict";Object.defineProperty(jt,"__esModule",{value:!0});jt.WCSTransform=void 0;var At=ot(),q=class{static degrad(t){return t*Math.PI/180}static raddeg(t){return t*180/Math.PI}static hrdeg(t){return t*15}static deghr(t){return t/15}static hrrad(t){return q.degrad(q.hrdeg(t))}static radhr(t){return q.deghr(q.raddeg(t))}constructor(t,i,e,n,s,a,r,f,o,d,u,h){if((typeof t=="number"||t===null)&&(typeof i=="number"||i===null)&&(typeof e=="number"||e===null)&&(typeof n=="number"||n===null)&&(typeof s=="number"||s===null)&&(typeof a=="number"||a===null)&&(typeof r=="number"||r===null)&&(typeof f=="number"||f===null)&&(typeof o=="number"||o===null)&&(typeof d=="number"||d===null)&&(typeof u=="number"||u===null)&&(typeof h=="string"||h===null)){let c=arguments;this.xref===void 0&&(this.xref=0),this.yref===void 0&&(this.yref=0),this.xrefpix===void 0&&(this.xrefpix=0),this.yrefpix===void 0&&(this.yrefpix=0),this.xinc===void 0&&(this.xinc=0),this.yinc===void 0&&(this.yinc=0),this.rot===void 0&&(this.rot=0),this.crot===void 0&&(this.crot=0),this.srot===void 0&&(this.srot=0),this.cd11===void 0&&(this.cd11=0),this.cd12===void 0&&(this.cd12=0),this.cd21===void 0&&(this.cd21=0),this.cd22===void 0&&(this.cd22=0),this.dc11===void 0&&(this.dc11=0),this.dc12===void 0&&(this.dc12=0),this.dc21===void 0&&(this.dc21=0),this.dc22===void 0&&(this.dc22=0),this.mrot===void 0&&(this.mrot=0),this.cmrot===void 0&&(this.cmrot=0),this.smrot===void 0&&(this.smrot=0),this.xmpix===void 0&&(this.xmpix=0),this.ympix===void 0&&(this.ympix=0),this.equinox===void 0&&(this.equinox=0),this.epoch===void 0&&(this.epoch=0),this.nxpix===void 0&&(this.nxpix=0),this.nypix===void 0&&(this.nypix=0),this.plate_ra===void 0&&(this.plate_ra=0),this.plate_dec===void 0&&(this.plate_dec=0),this.plate_scale===void 0&&(this.plate_scale=0),this.x_pixel_offset===void 0&&(this.x_pixel_offset=0),this.y_pixel_offset===void 0&&(this.y_pixel_offset=0),this.x_pixel_size===void 0&&(this.x_pixel_size=0),this.y_pixel_size===void 0&&(this.y_pixel_size=0),this.xpix===void 0&&(this.xpix=0),this.ypix===void 0&&(this.ypix=0),this.xpos===void 0&&(this.xpos=0),this.ypos===void 0&&(this.ypos=0),this.pcode===void 0&&(this.pcode=0),this.changesys===void 0&&(this.changesys=0),this.printsys===void 0&&(this.printsys=0),this.ndec===void 0&&(this.ndec=0),this.degout===void 0&&(this.degout=0),this.tabsys===void 0&&(this.tabsys=0),this.rotmat===void 0&&(this.rotmat=0),this.coorflip===void 0&&(this.coorflip=0),this.offscl===void 0&&(this.offscl=0),this.plate_fit===void 0&&(this.plate_fit=0),this.wcson===void 0&&(this.wcson=0),this.detector===void 0&&(this.detector=0),this.fCenterRa===void 0&&(this.fCenterRa=0),this.fCenterDec===void 0&&(this.fCenterDec=0),this.fHalfWidthRa===void 0&&(this.fHalfWidthRa=0),this.fHalfWidthDec===void 0&&(this.fHalfWidthDec=0),this.fWidthDeg===void 0&&(this.fWidthDeg=0),this.fHeightDeg===void 0&&(this.fHeightDeg=0),this.degPerPixel===void 0&&(this.degPerPixel=null),this.ppo_coeff=[0,0,0,0,0,0],this.amd_x_coeff=(l=>{let p=[];for(;l-- >0;)p.push(0);return p})(20),this.amd_y_coeff=(l=>{let p=[];for(;l-- >0;)p.push(0);return p})(20),this.instrument="",this.c1type="",this.c2type="",this.ctypes=["-SIN","-TAN","-ARC","-NCP","-GLS","-MER","-AIT","-STG"],this.ptype="",this.radecsys="",this.sysout="",this.center="",this.plate_fit=0,this.nxpix=r,this.nypix=f,this.xinc=e/3600,this.yinc=n/3600,this.xrefpix=s,this.yrefpix=a,this.xref=t,this.yref=i,this.c1type="RA-",this.c2type="DEC",this.ptype=h,this.pcode=1,this.coorflip=0,this.rot=o,this.rotmat=0,this.cd11=0,this.cd21=0,this.cd12=0,this.cd22=0,this.dc11=0,this.dc21=0,this.dc12=0,this.dc22=0,this.equinox=d,d>1980?this.radecsys="FK5":this.radecsys="FK4",u>0?this.epoch=u:this.epoch=0,this.wcson=1,this.sysout=this.radecsys,this.changesys=0,this.printsys=1,this.tabsys=0,this.pcode=0;for(let l=0;l<8;l++)((p,M,x=0)=>p.substr(x,M.length)===M)(this.ptype,this.ctypes[l])&&(this.pcode=l+1);this.wcsfull()}else if((t!=null&&t.constructor!=null&&t.constructor.__interfaces!=null&&t.constructor.__interfaces.indexOf("coordtxl.coords.WCSKeywordProvider")>=0||t===null)&&i===void 0&&e===void 0&&n===void 0&&s===void 0&&a===void 0&&r===void 0&&f===void 0&&o===void 0&&d===void 0&&u===void 0&&h===void 0){let l=arguments[0];this.xref===void 0&&(this.xref=0),this.yref===void 0&&(this.yref=0),this.xrefpix===void 0&&(this.xrefpix=0),this.yrefpix===void 0&&(this.yrefpix=0),this.xinc===void 0&&(this.xinc=0),this.yinc===void 0&&(this.yinc=0),this.rot===void 0&&(this.rot=0),this.crot===void 0&&(this.crot=0),this.srot===void 0&&(this.srot=0),this.cd11===void 0&&(this.cd11=0),this.cd12===void 0&&(this.cd12=0),this.cd21===void 0&&(this.cd21=0),this.cd22===void 0&&(this.cd22=0),this.dc11===void 0&&(this.dc11=0),this.dc12===void 0&&(this.dc12=0),this.dc21===void 0&&(this.dc21=0),this.dc22===void 0&&(this.dc22=0),this.mrot===void 0&&(this.mrot=0),this.cmrot===void 0&&(this.cmrot=0),this.smrot===void 0&&(this.smrot=0),this.xmpix===void 0&&(this.xmpix=0),this.ympix===void 0&&(this.ympix=0),this.equinox===void 0&&(this.equinox=0),this.epoch===void 0&&(this.epoch=0),this.nxpix===void 0&&(this.nxpix=0),this.nypix===void 0&&(this.nypix=0),this.plate_ra===void 0&&(this.plate_ra=0),this.plate_dec===void 0&&(this.plate_dec=0),this.plate_scale===void 0&&(this.plate_scale=0),this.x_pixel_offset===void 0&&(this.x_pixel_offset=0),this.y_pixel_offset===void 0&&(this.y_pixel_offset=0),this.x_pixel_size===void 0&&(this.x_pixel_size=0),this.y_pixel_size===void 0&&(this.y_pixel_size=0),this.xpix===void 0&&(this.xpix=0),this.ypix===void 0&&(this.ypix=0),this.xpos===void 0&&(this.xpos=0),this.ypos===void 0&&(this.ypos=0),this.pcode===void 0&&(this.pcode=0),this.changesys===void 0&&(this.changesys=0),this.printsys===void 0&&(this.printsys=0),this.ndec===void 0&&(this.ndec=0),this.degout===void 0&&(this.degout=0),this.tabsys===void 0&&(this.tabsys=0),this.rotmat===void 0&&(this.rotmat=0),this.coorflip===void 0&&(this.coorflip=0),this.offscl===void 0&&(this.offscl=0),this.plate_fit===void 0&&(this.plate_fit=0),this.wcson===void 0&&(this.wcson=0),this.detector===void 0&&(this.detector=0),this.fCenterRa===void 0&&(this.fCenterRa=0),this.fCenterDec===void 0&&(this.fCenterDec=0),this.fHalfWidthRa===void 0&&(this.fHalfWidthRa=0),this.fHalfWidthDec===void 0&&(this.fHalfWidthDec=0),this.fWidthDeg===void 0&&(this.fWidthDeg=0),this.fHeightDeg===void 0&&(this.fHeightDeg=0),this.degPerPixel===void 0&&(this.degPerPixel=null),this.ppo_coeff=[0,0,0,0,0,0],this.amd_x_coeff=(j=>{let g=[];for(;j-- >0;)g.push(0);return g})(20),this.amd_y_coeff=(j=>{let g=[];for(;j-- >0;)g.push(0);return g})(20),this.instrument="",this.c1type="",this.c2type="",this.ctypes=["-SIN","-TAN","-ARC","-NCP","-GLS","-MER","-AIT","-STG"],this.ptype="",this.radecsys="",this.sysout="",this.center="";let p,M,x,y,C,v,D,$,E,X,O,P,T,V;if(this.plate_fit=0,this.nxpix=l.getDoubleValue$java_lang_String("NAXIS1"),this.nypix=l.getDoubleValue$java_lang_String("NAXIS2"),this.xmpix=.5*this.nxpix,this.ympix=.5*this.nypix,this.mrot=0,this.equinox=l.getDoubleValue$java_lang_String("EQUINOX"),l.findKey("PLTRAH")){this.plate_fit=1,x=l.getDoubleValue$java_lang_String("PLTRAH"),y=l.getDoubleValue$java_lang_String("PLTRAM"),C=l.getDoubleValue$java_lang_String("PLTRAS"),O=x+y/60+C/3600,this.plate_ra=q.hrrad(O),M="+";let j=l.getStringValue$java_lang_String("PLTDECSN");j!=null&&(M=j.charAt(0)),(g=>g.charCodeAt==null?g:g.charCodeAt(0))(M)=="-".charCodeAt(0)?v=-1:v=1,D=l.getDoubleValue$java_lang_String("PLTDECD"),$=l.getDoubleValue$java_lang_String("PLTDECM"),E=l.getDoubleValue$java_lang_String("PLTDECS"),X=v*(D+$/60+E/3600),this.plate_dec=q.degrad(X),V=this.equinox|0,V===1950?this.radecsys="FK4":this.radecsys="FK5",this.epoch=this.equinox,l.findKey("EPOCH")&&(this.epoch=l.getDoubleValue$java_lang_String("EPOCH")),this.plate_scale=l.getDoubleValue$java_lang_String("PLTSCALE"),this.x_pixel_size=l.getDoubleValue$java_lang_String("XPIXELSZ"),this.y_pixel_size=l.getDoubleValue$java_lang_String("YPIXELSZ"),this.x_pixel_offset=l.getDoubleValue$java_lang_String("CNPIX1"),this.y_pixel_offset=l.getDoubleValue$java_lang_String("CNPIX2"),this.ppo_coeff[0]=l.getDoubleValue$java_lang_String("PPO1"),this.ppo_coeff[1]=l.getDoubleValue$java_lang_String("PPO2"),this.ppo_coeff[2]=l.getDoubleValue$java_lang_String("PPO3"),this.ppo_coeff[3]=l.getDoubleValue$java_lang_String("PPO4"),this.ppo_coeff[4]=l.getDoubleValue$java_lang_String("PPO5"),this.ppo_coeff[5]=l.getDoubleValue$java_lang_String("PPO6"),this.amd_x_coeff[0]=l.getDoubleValue$java_lang_String("AMDX1"),this.amd_x_coeff[1]=l.getDoubleValue$java_lang_String("AMDX2"),this.amd_x_coeff[2]=l.getDoubleValue$java_lang_String("AMDX3"),this.amd_x_coeff[3]=l.getDoubleValue$java_lang_String("AMDX4"),this.amd_x_coeff[4]=l.getDoubleValue$java_lang_String("AMDX5"),this.amd_x_coeff[5]=l.getDoubleValue$java_lang_String("AMDX6"),this.amd_x_coeff[6]=l.getDoubleValue$java_lang_String("AMDX7"),this.amd_x_coeff[7]=l.getDoubleValue$java_lang_String("AMDX8"),this.amd_x_coeff[8]=l.getDoubleValue$java_lang_String("AMDX9"),this.amd_x_coeff[9]=l.getDoubleValue$java_lang_String("AMDX10"),this.amd_x_coeff[10]=l.getDoubleValue$java_lang_String("AMDX11"),this.amd_x_coeff[11]=l.getDoubleValue$java_lang_String("AMDX12"),this.amd_x_coeff[12]=l.getDoubleValue$java_lang_String("AMDX13"),this.amd_x_coeff[13]=l.getDoubleValue$java_lang_String("AMDX14"),this.amd_x_coeff[14]=l.getDoubleValue$java_lang_String("AMDX15"),this.amd_x_coeff[15]=l.getDoubleValue$java_lang_String("AMDX16"),this.amd_x_coeff[16]=l.getDoubleValue$java_lang_String("AMDX17"),this.amd_x_coeff[17]=l.getDoubleValue$java_lang_String("AMDX18"),this.amd_x_coeff[18]=l.getDoubleValue$java_lang_String("AMDX19"),this.amd_x_coeff[19]=l.getDoubleValue$java_lang_String("AMDX20"),this.amd_y_coeff[0]=l.getDoubleValue$java_lang_String("AMDY1"),this.amd_y_coeff[1]=l.getDoubleValue$java_lang_String("AMDY2"),this.amd_y_coeff[2]=l.getDoubleValue$java_lang_String("AMDY3"),this.amd_y_coeff[3]=l.getDoubleValue$java_lang_String("AMDY4"),this.amd_y_coeff[4]=l.getDoubleValue$java_lang_String("AMDY5"),this.amd_y_coeff[5]=l.getDoubleValue$java_lang_String("AMDY6"),this.amd_y_coeff[6]=l.getDoubleValue$java_lang_String("AMDY7"),this.amd_y_coeff[7]=l.getDoubleValue$java_lang_String("AMDY8"),this.amd_y_coeff[8]=l.getDoubleValue$java_lang_String("AMDY9"),this.amd_y_coeff[9]=l.getDoubleValue$java_lang_String("AMDY10"),this.amd_y_coeff[10]=l.getDoubleValue$java_lang_String("AMDY11"),this.amd_y_coeff[11]=l.getDoubleValue$java_lang_String("AMDY12"),this.amd_y_coeff[12]=l.getDoubleValue$java_lang_String("AMDY13"),this.amd_y_coeff[13]=l.getDoubleValue$java_lang_String("AMDY14"),this.amd_y_coeff[14]=l.getDoubleValue$java_lang_String("AMDY15"),this.amd_y_coeff[15]=l.getDoubleValue$java_lang_String("AMDY16"),this.amd_y_coeff[16]=l.getDoubleValue$java_lang_String("AMDY17"),this.amd_y_coeff[17]=l.getDoubleValue$java_lang_String("AMDY18"),this.amd_y_coeff[18]=l.getDoubleValue$java_lang_String("AMDY19"),this.amd_y_coeff[19]=l.getDoubleValue$java_lang_String("AMDY20"),this.wcson=1,this.c1type="RA-",this.c2type="DEC",this.ptype="PLATE",this.degout=0,this.ndec=3}else if((p=l.getStringValue$java_lang_String("CTYPE1"))!=null){let j=p.length;if(((g,m,S=0)=>g.substr(S,m.length)===m)(p,"LINEAR"))this.pcode=0,this.c1type=p,this.ptype=p;else if(((g,m,S=0)=>g.substr(S,m.length)===m)(p,"PIXEL"))this.pcode=-1,this.c1type=p,this.ptype=p;else if(j>1&&((g=>g.charCodeAt==null?g:g.charCodeAt(0))(p.charAt(0))=="R".charCodeAt(0)||(g=>g.charCodeAt==null?g:g.charCodeAt(0))(p.charAt(0))=="D".charCodeAt(0)||(g=>g.charCodeAt==null?g:g.charCodeAt(0))(p.charAt(0))=="A".charCodeAt(0)||(g=>g.charCodeAt==null?g:g.charCodeAt(0))(p.charAt(1))=="L".charCodeAt(0))){this.c1type=p.substring(0,2),j>2&&(g=>g.charCodeAt==null?g:g.charCodeAt(0))(p.charAt(2))!="-".charCodeAt(0)&&(this.c1type+=p.charAt(2)),j>3&&(g=>g.charCodeAt==null?g:g.charCodeAt(0))(p.charAt(3))!="-".charCodeAt(0)&&(this.c1type+=p.charAt(3)),j>4&&(this.ptype=p.substring(3,7)),this.pcode=0;for(let g=0;g<8;g++)if(((m,S,w=0)=>m.substr(w,S.length)===S)(this.ptype,this.ctypes[g])){this.pcode=g+1;break}}else throw console.error("WCSINIT: CTYPE1 not sky coordinates or LINEAR -> no WCS"),Object.defineProperty(new Error,"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});if((p=l.getStringValue$java_lang_String("CTYPE2"))==null)throw console.error("WCSINIT: No CTYPE2 -> no WCS"),Object.defineProperty(new Error(q.NO_WCS_IN_HEADER_MESSAGE),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});if(j=p.length,((g,m,S=0)=>g.substr(S,m.length)===m)(p,"LINEAR"))this.pcode=0,this.c2type=p;else if(((g,m,S=0)=>g.substr(S,m.length)===m)(p,"PIXEL"))this.pcode=-1,this.c2type=p;else if(j>1&&((g=>g.charCodeAt==null?g:g.charCodeAt(0))(p.charAt(0))=="R".charCodeAt(0)||(g=>g.charCodeAt==null?g:g.charCodeAt(0))(p.charAt(0))=="D".charCodeAt(0)||(g=>g.charCodeAt==null?g:g.charCodeAt(0))(p.charAt(0))=="A".charCodeAt(0)||(g=>g.charCodeAt==null?g:g.charCodeAt(0))(p.charAt(1))=="L".charCodeAt(0)))this.c2type=p.substring(0,2),j>2&&(g=>g.charCodeAt==null?g:g.charCodeAt(0))(p.charAt(2))!="-".charCodeAt(0)&&(this.c2type+=p.charAt(2)),j>3&&(g=>g.charCodeAt==null?g:g.charCodeAt(0))(p.charAt(3))!="-".charCodeAt(0)&&(this.c2type+=p.charAt(3)),((g,m,S=0)=>g.substr(S,m.length)===m)(this.c1type,"DEC")||((g,m,S=0)=>g.substr(S,m.length)===m)(this.c1type,"GLAT")?this.coorflip=1:this.coorflip=0,(g=>g.charCodeAt==null?g:g.charCodeAt(0))(p.charAt(1))=="L".charCodeAt(0)||(g=>g.charCodeAt==null?g:g.charCodeAt(0))(p.charAt(0))=="A".charCodeAt(0)?(this.degout=1,this.ndec=5):(this.degout=0,this.ndec=3);else throw console.error("WCSINIT: CTYPE2 not sky coordinates or LINEAR -> no WCS"),Object.defineProperty(new Error(q.NO_WCS_IN_HEADER_MESSAGE),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});this.xrefpix=l.getDoubleValue$java_lang_String$double("CRPIX1",1),this.yrefpix=l.getDoubleValue$java_lang_String$double("CRPIX2",1),this.xref=l.getDoubleValue$java_lang_String$double("CRVAL1",1),this.yref=l.getDoubleValue$java_lang_String$double("CRVAL2",1),(this.xinc=l.getDoubleValue$java_lang_String("CDELT1"))!==0?(this.yinc=l.getDoubleValue$java_lang_String$double("CDELT2",this.xinc),this.rot=l.getDoubleValue$java_lang_String$double("CROTA1",0),this.rot===0&&(this.rot=l.getDoubleValue$java_lang_String("CROTA2")),this.cd11=0,this.cd21=0,this.cd12=0,this.cd22=0,this.rotmat=0):(this.cd11=l.getDoubleValue$java_lang_String("CD1_1"))!==0?(this.rotmat=1,this.cd12=l.getDoubleValue$java_lang_String$double("CD1_2",0),this.cd21=l.getDoubleValue$java_lang_String$double("CD2_1",0),this.cd22=l.getDoubleValue$java_lang_String$double("CD2_2",this.cd11),T=this.cd11*this.cd22-this.cd12*this.cd21,T!==0&&(this.dc11=this.cd22/T,this.dc12=-this.cd12/T,this.dc21=-this.cd21/T,this.dc22=this.cd11/T),this.xinc=Math.sqrt(this.cd11*this.cd11+this.cd21*this.cd21),this.yinc=Math.sqrt(this.cd12*this.cd12+this.cd22*this.cd22),this.cd11*this.cd11-this.cd12*this.cd12<0?((((g,m,S=0)=>g.substr(S,m.length)===m)(this.c1type,"RA")||((g,m,S=0)=>g.substr(S,m.length)===m)(this.c1type,"GLON"))&&(this.xinc=-this.xinc),(((g,m,S=0)=>g.substr(S,m.length)===m)(this.c2type,"RA")||((g,m,S=0)=>g.substr(S,m.length)===m)(this.c2type,"GLON"))&&(this.yinc=-this.yinc),this.rot=q.raddeg(Math.atan2(-this.cd12,this.cd22))):this.rot=q.raddeg(Math.atan2(this.cd12,this.cd22))):(this.xinc=1,this.yinc=1,console.error("WCSINIT: setting CDELT to 1")),this.xmpix=l.getDoubleValue$java_lang_String("CCPIX1"),this.ympix=l.getDoubleValue$java_lang_String("CCPIX2"),this.mrot=l.getDoubleValue$java_lang_String("CCROT1"),((g,m,S=0)=>g.substr(S,m.length)===m)(this.ptype,"LINEAR")&&((g,m,S=0)=>g.substr(S,m.length)===m)(this.ptype,"PIXEL")?this.degout=-1:this.wcseq(l),this.wcson=1}else if(l.findKey("SECPIX")||l.findKey("PIXSCAL1")||l.findKey("SECPIX1")){if(P=l.getDoubleValue$java_lang_String$double("SECPIX",0),P===0?(P=l.getDoubleValue$java_lang_String$double("SECPIX1",0),P!==0?(this.xinc=-P/3600,P=l.getDoubleValue$java_lang_String$double("SECPIX2",0),this.yinc=P/3600):(P=l.getDoubleValue$java_lang_String$double("PIXSCAL1",0),this.xinc=-P/3600,P=l.getDoubleValue$java_lang_String$double("PIXSCAL2",0),this.yinc=P/3600)):(this.yinc=P/3600,this.xinc=-this.yinc),this.xrefpix=l.getDoubleValue$java_lang_String$double("CRPIX1",this.nxpix*.5),this.yrefpix=l.getDoubleValue$java_lang_String$double("CRPIX2",this.nypix*.5),this.xref=0,(this.xref=l.getDoubleValue$java_lang_String$double("RA",0))===0)throw console.error("WCSINIT: No RA with SECPIX, no WCS"),Object.defineProperty(new Error(q.NO_WCS_IN_HEADER_MESSAGE),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});if(this.yref=0,(this.yref=l.getDoubleValue$java_lang_String$double("DEC",0))===0)throw console.error("WCSINIT: No DEC with SECPIX, no WCS"),Object.defineProperty(new Error(q.NO_WCS_IN_HEADER_MESSAGE),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});this.c1type="RA--TAN",this.c2type="DEC-TAN",this.ptype="-TAN",this.pcode=1,this.coorflip=0,this.degout=0,this.ndec=3,this.rot=l.getDoubleValue$java_lang_String$double("CROTA1",0),this.rot===0&&(this.rot=l.getDoubleValue$java_lang_String$double("CROTA2",0)),this.cd11=0,this.cd21=0,this.cd12=0,this.cd22=0,this.dc11=0,this.dc21=0,this.dc12=0,this.dc22=0,this.rotmat=0,this.xmpix=l.getDoubleValue$java_lang_String("CCPIX1"),this.ympix=l.getDoubleValue$java_lang_String("CCPIX2"),this.mrot=l.getDoubleValue$java_lang_String("CCROT1"),this.wcseq(l),(this.epoch=l.getDoubleValue$java_lang_String$double("DATE-OBS",0))===0&&(this.epoch=l.getDoubleValue$java_lang_String$double("EPOCH",0))===0&&(this.epoch=this.equinox),this.wcson=1}else throw Object.defineProperty(new Error(q.NO_WCS_IN_HEADER_MESSAGE),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});this.sysout=this.radecsys,this.changesys=0,this.printsys=1,this.tabsys=0,this.wcsfull()}else throw new Error("invalid overload")}getEquinox(){return this.equinox}getWCSCenter(){if(this.isValid())return new At.Point2D(this.fCenterRa,this.fCenterDec);throw Object.defineProperty(new Error("No WCS information."),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}getImageCenter(){return new At.Point2D(.5*this.nxpix,.5*this.nypix)}isWCS(){return this.isValid()}imageToWorldCoords(t,i){if(!!this.isValid())if(i)t.x=Math.abs(t.x*this.degPerPixel.x),t.y=Math.abs(t.y*this.degPerPixel.y);else{let e=this.pix2wcs(t.x,t.y);if(e!=null)t.setLocation(e.x,e.y);else throw Object.defineProperty(new Error("Image coordinates out of WCS range: "+t),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}}worldToImageCoords(t,i){if(!!this.isValid())if(i)t.x=Math.abs(t.x/this.degPerPixel.x),t.y=Math.abs(t.y/this.degPerPixel.y);else{let e=this.wcs2pix(t.x,t.y);if(e!=null)t.setLocation(e.x,e.y);else throw Object.defineProperty(new Error("World coordinates out of range: "+t),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}}getWidthInDeg(){return this.fWidthDeg}getHeightInDeg(){return this.fHeightDeg}getWidth(){return this.nxpix}getHeight(){return this.nypix}wcseq(t){let i=0,e;t.findKey("EQUINOX")?(this.equinox=t.getDoubleValue$java_lang_String("EQUINOX"),i=2e3):t.findKey("EPOCH")?(i=t.getDoubleValue$java_lang_String$double("EPOCH",0)|0,i===0?(i=1950,this.equinox=1950):this.equinox=t.getDoubleValue$java_lang_String("EPOCH")):t.findKey("RADECSYS")&&(e=t.getStringValue$java_lang_String("RADECSYS"),((n,s,a=0)=>n.substr(a,s.length)===s)(e,"FK4")?(this.equinox=1950,i=1950):((n,s,a=0)=>n.substr(a,s.length)===s)(e,"FK5")?(this.equinox=2e3,i=2e3):((n,s,a=0)=>n.substr(a,s.length)===s)(e,"GAL")?(this.equinox=2e3,i=2e3):((n,s,a=0)=>n.substr(a,s.length)===s)(e,"ECL")&&(this.equinox=2e3,i=2e3)),i===0&&(this.equinox=2e3,i=2e3),(this.epoch=t.getDoubleValue$java_lang_String$double("DATE-OBS",0))===0&&(this.epoch=t.getDoubleValue$java_lang_String$double("EPOCH",0))===0&&(this.epoch=this.equinox),this.epoch===0&&(this.epoch=this.equinox),t.findKey("RADECSYS")?((n,s,a=0)=>n.substr(a,s.length)===s)(this.radecsys,"FK4")?this.equinox=1950:((n,s,a=0)=>n.substr(a,s.length)===s)(this.radecsys,"FK5")?this.equinox=2e3:((n,s,a=0)=>n.substr(a,s.length)===s)(this.radecsys,"GAL")&&i===0&&(this.equinox=2e3):(n=>n.charCodeAt==null?n:n.charCodeAt(0))(this.c1type.charAt(0))=="G".charCodeAt(0)?this.radecsys="GALACTIC":(n=>n.charCodeAt==null?n:n.charCodeAt(0))(this.c1type.charAt(0))=="E".charCodeAt(0)?this.radecsys="ECLIPTIC":(n=>n.charCodeAt==null?n:n.charCodeAt(0))(this.c1type.charAt(0))=="S".charCodeAt(0)?this.radecsys="SGALACTC":(n=>n.charCodeAt==null?n:n.charCodeAt(0))(this.c1type.charAt(0))=="H".charCodeAt(0)?this.radecsys="HELIOECL":(n=>n.charCodeAt==null?n:n.charCodeAt(0))(this.c1type.charAt(0))=="A".charCodeAt(0)?this.radecsys="ALTAZ":i>1980?this.radecsys="FK5":this.radecsys="FK4"}isValid(){return this.wcson>0}wcsshift(t,i,e){!this.isValid()||(this.fCenterRa=this.xref=t,this.fCenterDec=this.yref=i,this.radecsys=e,((n,s,a=0)=>n.substr(a,s.length)===s)(e,"FK4")?this.equinox=1950:this.equinox=2e3)}wcssize(){let t,i,e,n;if(this.isValid()){t=.5*this.nxpix,i=.5*this.nypix;let s=this.pix2wcs(t,i);if(s==null)return;this.fCenterRa=s.x,this.fCenterDec=s.y;let a=this.pix2wcs(1,i),r=this.pix2wcs(this.nxpix,i);if(a==null||r==null||(!((f,o,d=0)=>f.substr(d,o.length)===o)(this.ptype,"LINEAR")&&!((f,o,d=0)=>f.substr(d,o.length)===o)(this.ptype,"PIXEL")?(e=this.wcsdist(a.x,a.y,r.x,r.y),this.fHalfWidthRa=e*.5/Math.cos(q.degrad(this.fCenterDec))):this.fHalfWidthRa=Math.sqrt((r.y-a.y)*(r.y-a.y)+(r.x-a.x)*(r.x-a.x)),a=this.pix2wcs(t,1),r=this.pix2wcs(t,this.nypix),a==null||r==null))return;!((f,o,d=0)=>f.substr(d,o.length)===o)(this.ptype,"LINEAR")&&!((f,o,d=0)=>f.substr(d,o.length)===o)(this.ptype,"PIXEL")?(n=this.wcsdist(a.x,a.y,r.x,r.y),this.fHalfWidthDec=n*.5):this.fHalfWidthDec=Math.sqrt((r.y-a.y)*(r.y-a.y)+(r.x-a.x)*(r.x-a.x))}}wcsfull(){let t,i;if(this.isValid()){t=.5*this.nxpix,i=.5*this.nypix;let e=this.pix2wcs(t,i);if(e==null)return;this.fCenterRa=e.x,this.fCenterDec=e.y;let n=this.pix2wcs(0,i),s=this.pix2wcs(this.nxpix,i);if(n==null||s==null||(!((a,r,f=0)=>a.substr(f,r.length)===r)(this.ptype,"LINEAR")&&!((a,r,f=0)=>a.substr(f,r.length)===r)(this.ptype,"PIXEL")?this.fWidthDeg=this.wcsdist(n.x,n.y,s.x,s.y):this.fWidthDeg=Math.sqrt((s.y-n.y)*(s.y-n.y)+(s.x-n.x)*(s.x-n.x)),n=this.pix2wcs(t,0),s=this.pix2wcs(t,this.nypix),n==null||s==null))return;!((a,r,f=0)=>a.substr(f,r.length)===r)(this.ptype,"LINEAR")&&!((a,r,f=0)=>a.substr(f,r.length)===r)(this.ptype,"PIXEL")?this.fHeightDeg=this.wcsdist(n.x,n.y,s.x,s.y):this.fHeightDeg=Math.sqrt((s.y-n.y)*(s.y-n.y)+(s.x-n.x)*(s.x-n.x)),this.degPerPixel=new At.Point2D(this.fWidthDeg/this.nxpix,this.fHeightDeg/this.nypix)}}wcsdist(t,i,e,n){let s,a,r,f,o=[0,0,0],d=[0,0,0],u,h,c,l;for(s=q.degrad(t),r=q.degrad(i),c=Math.cos(r),o[0]=Math.cos(s)*c,o[1]=Math.sin(s)*c,o[2]=Math.sin(r),a=q.degrad(e),f=q.degrad(n),c=Math.cos(f),d[0]=Math.cos(a)*c,d[1]=Math.sin(a)*c,d[2]=Math.sin(f),u=0,l=0;l<3;l++)u=u+(o[l]-d[l])*(o[l]-d[l]);return u=u/4,u>1&&(u=1),h=2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),h=q.raddeg(h),h}pix2wcs(t,i){let e;return this.isValid()?(this.xpix=t,this.ypix=i,this.offscl=0,this.plate_fit>0?(e=se.platepos.getPosition(t,i,this))==null&&(this.offscl=1):(e=ne.worldpos.getPosition(t,i,this))==null&&(this.offscl=1),this.pcode>0&&(((n,s,a=0)=>n.substr(a,s.length)===s)(this.radecsys,"FK4")?this.equinox!==1950&&(e=st.wcscon.fk4prec(this.equinox,1950,e)):((n,s,a=0)=>n.substr(a,s.length)===s)(this.radecsys,"FK5")&&this.equinox!==2e3&&(e=st.wcscon.fk5prec(this.equinox,2e3,e)),this.changesys===1?e=st.wcscon.fk425e(e,this.epoch):this.changesys===2?e=st.wcscon.fk524e(e,this.epoch):this.changesys===3?e=st.wcscon.fk42gal(e):this.changesys===4&&(e=st.wcscon.fk52gal(e))),this.offscl===0&&e!=null&&(this.xpos=e.x,this.ypos=e.y),e):null}wcs2pix(t,i){let e;if(!this.isValid())return null;this.xpos=t,this.ypos=i;let n=new At.Point2D(t,i);return this.changesys===1?n=st.wcscon.fk524e(n,this.epoch):this.changesys===2&&(n=st.wcscon.fk425e(n,this.epoch)),((s,a,r=0)=>s.substr(r,a.length)===a)(this.radecsys,"FK4")?this.equinox!==1950&&(n=st.wcscon.fk4prec(1950,this.equinox,n)):((s,a,r=0)=>s.substr(r,a.length)===a)(this.radecsys,"FK5")&&this.equinox!==2e3&&(n=st.wcscon.fk5prec(2e3,this.equinox,n)),this.plate_fit>0?(e=se.platepos.getPixels(n.x,n.y,this))==null&&(this.offscl=1):(e=ne.worldpos.getPixels(n.x,n.y,this))==null&&(this.offscl=1),e!=null&&(this.xpix=e.x,this.ypix=e.y),e}};jt.WCSTransform=q;q.NO_WCS_IN_HEADER_MESSAGE="The header does not contain a valid world coordinate system.";q.__class="coordtxl.coords.WCSTransform";q.__interfaces=["coordtxl.coords.WorldCoordinateConverter"];var st=Qt(),ne=te(),se=ie()});var ae=B($t=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});$t.Trigod=void 0;var Y=class{static DEG_$LI$(){return Y.DEG==null&&(Y.DEG=180/Math.PI),Y.DEG}static fractionalPart(t){return Math.abs(t-(t|0))}static cosd(t){let i=0,e=Y.fractionalPart(t/360);return e>.5&&(e=1-e),e>.25&&(e=.5-e,i=1),e>.125?e=Math.sin(Math.PI*2*(.25-e)):e=Math.cos(Math.PI*2*e),i!==0&&(e=-e),e}static sind(t){let i=Y.fractionalPart(t/360),e=t>=0?0:1;return i>.5&&(i=1-i,e^=1),i>.25&&(i=.5-i),i>.125?i=Math.cos(Math.PI*2*(.25-i)):i=Math.sin(Math.PI*2*i),e!==0&&(i=-i),i}static tand(t){let i=Y.fractionalPart(t/180);return i===.5?i=Y.DOUBLE_MAX:i=Math.tan(Math.PI*i),t>0?i:-i}static atand(t){return Y.DEG_$LI$()*Math.atan(t)}static atan2d(t,i){return Y.DEG_$LI$()*Math.atan2(t,i)}static acosd(t){return Y.DEG_$LI$()*Math.acos(t)}asind(t){return Y.DEG_$LI$()*Math.asin(t)}};$t.Trigod=Y;Y.DOUBLE_MAX=17e37;Y.__class="coordtxl.coords.Trigod"});var re=B(Et=>{"use strict";Object.defineProperty(Et,"__esModule",{value:!0});Et.Cotr=void 0;var at=class{static tr_Euler(t,i){let a;i[0][2]=G.Trigod.cosd(t[0]),i[1][2]=G.Trigod.sind(t[0]),i[2][0]=G.Trigod.cosd(t[2]),i[2][1]=G.Trigod.sind(t[2]),i[2][2]=G.Trigod.cosd(t[1]),a=G.Trigod.sind(t[1]),i[0][0]=i[2][0]*i[2][2]*i[0][2]-i[2][1]*i[1][2],i[1][0]=i[2][0]*i[2][2]*i[1][2]+i[2][1]*i[0][2],i[0][1]=-i[2][1]*i[2][2]*i[0][2]-i[2][0]*i[1][2],i[1][1]=-i[2][1]*i[2][2]*i[1][2]+i[2][0]*i[0][2],i[2][0]=i[2][0]*a,i[2][1]=-i[2][1]*a,i[0][2]=-a*i[0][2],i[1][2]=-a*i[1][2]}static tr_oo(t,i,e){let n=[0,0,0];at.tr_ou(t,n),at.tr_uu(n,n,e),at.tr_uo(n,i)}static tr_oo1(t,i,e){let n=[0,0,0];at.tr_ou(t,n),at.tr_uu1(n,n,e),at.tr_uo(n,i)}static tr_oR(t,i){let e=t[0],n=t[1];i[2][2]=G.Trigod.cosd(n),i[0][2]=G.Trigod.sind(n),i[1][1]=G.Trigod.cosd(e),i[1][0]=-G.Trigod.sind(e),i[1][2]=0,i[0][0]=i[2][2]*i[1][1],i[0][1]=-i[2][2]*i[1][0],i[2][0]=-i[0][2]*i[1][1],i[2][1]=i[0][2]*i[1][0]}static tr_ou(t,i){let e=t[0],n=t[1],s=G.Trigod.cosd(n);i[0]=s*G.Trigod.cosd(e),i[1]=s*G.Trigod.sind(e),i[2]=G.Trigod.sind(n)}static tr_uo(t,i){let e=t[0],n=t[1],s=t[2],a=e*e+n*n;if(i[0]=0,a===0){if(s===0)return;i[1]=s>0?90:-90;return}i[1]=G.Trigod.atand(s/Math.sqrt(a)),i[0]=G.Trigod.atan2d(n,e),i[0]<0&&(i[0]+=360)}static tr_uR(t,i){let e=t[0],n=t[1],s=t[2];i[0][0]=e,i[0][1]=n,i[0][2]=s,i[2][2]=Math.sqrt(e*e+n*n),i[1][0]=0,i[1][1]=1,i[1][2]=0,i[2][2]!==0&&(i[1][1]=e/i[2][2],i[1][0]=-n/i[2][2]),i[2][0]=-i[0][2]*i[1][1],i[2][1]=i[0][2]*i[1][0]}static tr_uu(t,i,e){let n,s,a,r=[0,0,0];for(n=0;n<3;n++){for(a=0,s=0;s<3;s++)a+=e[n][s]*t[s];r[n]=a}for(n=0;n<3;n++)i[n]=r[n]}static tr_uu1(t,i,e){let n,s,a,r=[0,0,0];for(n=0;n<3;n++){for(s=0,a=0;s<3;s++)a+=e[s][n]*t[s];r[n]=a}for(n=0;n<3;n++)i[n]=r[n]}static tr_RR(t,i,e){let n,s,a,r,f=function(o){let d=function(u){if(u.length===0)return 0;{let h=[];for(let c=0;c<u[0];c++)h.push(d(u.slice(1)));return h}};return d(o)}([3,3]);for(n=0;n<3;n++)for(s=0;s<3;s++){for(a=0,r=0;a<3;a++)r+=e[n][a]*t[a][s];f[n][s]=r}for(n=0;n<3;n++)for(s=0;s<3;s++)i[n][s]=f[n][s]}static tr_RR1(t,i,e){let n,s,a,r,f=function(o){let d=function(u){if(u.length===0)return 0;{let h=[];for(let c=0;c<u[0];c++)h.push(d(u.slice(1)));return h}};return d(o)}([3,3]);for(n=0;n<3;n++)for(s=0;s<3;s++){for(a=0,r=0;a<3;a++)r+=e[a][n]*t[a][s];f[n][s]=r}for(n=0;n<3;n++)for(s=0;s<3;s++)i[n][s]=f[n][s]}};Et.Cotr=at;at.__class="coordtxl.coords.Cotr";var G=ae()});var le=B(It=>{"use strict";Object.defineProperty(It,"__esModule",{value:!0});It.JPrec=void 0;var ht=class{static prej_R(t,i,e){let n,s,a,r=[0,0,0],f=0,o=1,d=2;n=(i-2e3)/100,s=(e-i)/100,a=2306.2181+(1.39656-139e-6*n)*n,r[d]=(a+(.30188-344e-6*n+.017998*s)*s)*s/3600,r[f]=(a+(1.09468+66e-6*n+.018203*s)*s)*s/3600,r[o]=(2004.3109+(-.8533-217e-6*n)*n+(-.42665-217e-6*n-.041833*s)*s)*s/3600,Pt.Cotr.tr_Euler(r,t)}static prej_q(t,i,e,n){let s=[0,0,0];if(e===n){i[0]=t[0],i[1]=t[1];return}Pt.Cotr.tr_ou(t,s),ht.prej_u(s,s,e,n),Pt.Cotr.tr_uo(s,i)}static prej_u(t,i,e,n){let s=[[1,0,0],[0,1,0],[0,0,1]];if(e===n){i[0]=t[0],i[1]=t[1],i[2]=t[2];return}ht.prej_R(s,e,n),Pt.Cotr.tr_uu(t,i,s)}};It.JPrec=ht;ht.__class="coordtxl.coords.JPrec";var Pt=re()});var Xt=B(Tt=>{"use strict";Object.defineProperty(Tt,"__esModule",{value:!0});Tt.StringUtil=void 0;var ut=class{static replace(t,i,e){return t.split(i).join(e)}static split(t,i){let e=t.indexOf(String.fromCharCode(i));if(e>0){let n;return n=[null,null],n[0]=t.substring(0,e),n[1]=t.substring(e+1),n}return null}static combine(t,i){if(t==null)return"";let e={str:"",toString:function(){return this.str}};for(let n=0;n<t.length;n++)(s=>(s.str+=t[n],s))(e),n+1<t.length&&(s=>(s.str+=i,s))(e);return e.str}static equals(t,i){return t==null&&i==null||!(t==null||i==null)&&t===i}static match(t,i){let e=i.length,n=t.length;for(let s=0;;s++){for(let a=0;;s++,a++){let r=a>=e,f=s>=n||(o=>o.charCodeAt==null?o:o.charCodeAt(0))(t.charAt(s))=="|".charCodeAt(0);if(r&&!f&&(o=>o.charCodeAt==null?o:o.charCodeAt(0))(t.charAt(s))=="*".charCodeAt(0)&&(s===n-1||s<n-1&&(o=>o.charCodeAt==null?o:o.charCodeAt(0))(t.charAt(s+1))=="|".charCodeAt(0))||r&&f)return!0;if(r||f)break;if((o=>o.charCodeAt==null?o:o.charCodeAt(0))(t.charAt(s))=="?".charCodeAt(0))continue;if((o=>o.charCodeAt==null?o:o.charCodeAt(0))(t.charAt(s))=="*".charCodeAt(0)||(o=>o.charCodeAt==null?o:o.charCodeAt(0))(t.charAt(s))=="%".charCodeAt(0)){s++;for(let o=e;o>=a;--o)if(ut.match(t.substring(s),i.substring(o)))return!0;break}if((o=>o.charCodeAt==null?o:o.charCodeAt(0))(t.charAt(s).toUpperCase())!=(o=>o.charCodeAt==null?o:o.charCodeAt(0))(i.charAt(a).toUpperCase()))break}if(s=t.indexOf("|",s),s===-1)return!1}}static pad(t,i,e){let n={str:"",toString:function(){return this.str}};if(e){(a=>(a.str+=t,a))(n);let s=t.length;for(;s++<i;)(a=>(a.str+=" ",a))(n)}else{let s=t.length;for(;s++<i;)(a=>(a.str+=" ",a))(n);(a=>(a.str+=t,a))(n)}return n.str}static arrayContains(t,i){for(let e=0;e<t.length;e++){let n=t[e];if(i===n)return!0}return!1}static capitalize(t){if(t==null||t.length===0)return t;let i={str:"",toString:function(){return this.str}},e=t.split("[\\s]+");for(let n=0;n<e.length;n++){let s=e[n];{let a=s.trim();a.length!==0&&((r=>(r.str+=a.substring(1).toLowerCase(),r))((r=>(r.str+=a.substring(0,1).toUpperCase(),r))(i)),(r=>(r.str+=" ",r))(i))}}return i.str.trim()}};Tt.StringUtil=ut;ut.__class="coordtxl.util.StringUtil"});var fe=B(Ot=>{"use strict";Object.defineProperty(Ot,"__esModule",{value:!0});Ot.DMS=void 0;var Ie=Xt(),Q=class{static fmt_deg_min(t){let i=Math.round(t),e=(""+i).split(".").join("@").split("@");if(e.length<1)return"00";let n="";for(let s=e[0].length;s<2;++s)n+="0";for(let s=e[0].length>2?e[0].length-2:0;s<e[0].length;++s)n+=e[0].charAt(s);return n}static fmt_sec(t){let i=Math.round(t*100)/100,e=(""+i).split(".").join("@").split("@");if(e.length===0)return"00.00";if(e.length<2)return e[0]+".00";let n="";for(let a=e[0].length;a<2;++a)n+="0";for(let a=e[0].length>2?e[0].length-2:0;a<e[0].length;++a)n+=e[0].charAt(a);n+=".";let s=0;for(;s<2&&s<e[1].length;++s)n+=e[1].charAt(s);for(;s<2;++s)n+="0";return n}constructor(t,i,e){if((typeof t=="number"||t===null)&&(typeof i=="number"||i===null)&&(typeof e=="number"||e===null)){let n=arguments;this.degrees===void 0&&(this.degrees=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,this.set(t,i,e)}else if((t!=null&&t instanceof Q||t===null)&&i===void 0&&e===void 0){let s=arguments[0];this.degrees===void 0&&(this.degrees=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,this.setVal(s.val)}else if((typeof t=="string"||t===null)&&i===void 0&&e===void 0){let s=arguments[0];this.degrees===void 0&&(this.degrees=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,s=Ie.StringUtil.replace(s,",",".");let a=[0,0,0],r=s.split(":").join("@").split(" ").join("@").split("@@").join("@").split("@"),f=0;for(;f<3&&f<r.length;)a[f]=parseFloat(r[f]),f+=1;if(f>=2)this.set(a[0],a[1]|0,a[2]);else if(f===1)this.setVal(a[0]);else throw Object.defineProperty(new Error("Expected a string of the form hh:mm:ss.sss, but got: '"+s+"'"),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}else if((typeof t=="number"||t===null)&&i===void 0&&e===void 0){let s=arguments[0];this.degrees===void 0&&(this.degrees=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,this.setVal(s)}else if(t===void 0&&i===void 0&&e===void 0){let n=arguments;this.degrees===void 0&&(this.degrees=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1}else throw new Error("invalid overload")}set(t,i,e){this.degrees=t|0,this.min=i,this.sec=e,this.val=(e/60+i)/60,t<0||t===Q.MINUS_ZERO?(this.val=t-this.val,this.degrees=-this.degrees,this.sign=-1):(this.val=this.degrees+this.val,this.sign=1),this.initialized=!0}setVal(t){this.val=t;let i=t;i<0||i===Q.MINUS_ZERO?(this.sign=-1,i=-i):this.sign=1;let e=i+1e-10;this.degrees=e|0;let n=(e-this.degrees)*60;this.min=n|0,this.sec=(n-this.min)*60,this.initialized=!0}toString$(){let t=Q.fmt_sec(this.sec),i;return this.sign===-1?i="-":i="+",i+Q.fmt_deg_min(this.degrees)+":"+Q.fmt_deg_min(this.min)+":"+t}toString$boolean(t){if(t)return this.toString$();let i;return this.sign===-1?i="-":i="+",i+Q.fmt_deg_min(this.degrees)+":"+Q.fmt_deg_min(this.min)}toString(t){if(typeof t=="boolean"||t===null)return this.toString$boolean(t);if(t===void 0)return this.toString$();throw new Error("invalid overload")}isInitialized(){return this.initialized}getDegrees(){return this.degrees}getMin(){return this.min}getSec(){return this.sec}getVal(){return this.val}getSign(){return this.sign}equals(t){return t!=null&&t instanceof Q&&this.val===t.val}};Ot.DMS=Q;Q.MINUS_ZERO=-0;Q.__class="coordtxl.coords.DMS"});var de=B(Vt=>{"use strict";Object.defineProperty(Vt,"__esModule",{value:!0});Vt.HMS=void 0;var oe=Xt(),tt=class{static fmt_hr_min(t){let i=Math.round(t),e=(""+i).split(".").join("@").split("@");if(e.length<1)return"00";let n="";for(let s=e[0].length;s<2;++s)n+="0";for(let s=e[0].length>2?e[0].length-2:0;s<e[0].length;++s)n+=e[0].charAt(s);return n}static fmt_sec(t){let i=Math.round(t*1e3)/1e3,e=(""+i).split(".").join("@").split("@");if(e.length===0)return"00.000";if(e.length<2)return e[0]+".000";let n="";for(let a=e[0].length;a<2;++a)n+="0";for(let a=e[0].length>2?e[0].length-2:0;a<e[0].length;++a)n+=e[0].charAt(a);n+=".";let s=0;for(;s<3&&s<e[1].length;++s)n+=e[1].charAt(s);for(;s<3;++s)n+="0";return n}constructor(t,i,e){if((typeof t=="number"||t===null)&&(typeof i=="number"||i===null)&&(typeof e=="number"||e===null)){let n=arguments;this.hours===void 0&&(this.hours=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,this.set(t,i,e)}else if((typeof t=="string"||t===null)&&(typeof i=="boolean"||i===null)&&e===void 0){let n=arguments,s=n[0],a=n[1];this.hours===void 0&&(this.hours=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,s=oe.StringUtil.replace(s,",",".");let r=[0,0,0],f=s.split(":").join("@").split(" ").join("@").split("@@").join("@").split("@"),o=0;for(;o<3&&o<f.length;)r[o]=parseFloat(f[o]),o+=1;if(o>=2)this.set(r[0],r[1]|0,r[2]);else if(o===1)!a&&s.indexOf(".")!==-1?this.setVal(r[0]/15):this.setVal(r[0]);else throw Object.defineProperty(new Error("Expected a string of the form hh:mm:ss.sss, but got: '"+s+"'"),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}else if((t!=null&&t instanceof tt||t===null)&&i===void 0&&e===void 0){let s=arguments[0];this.hours===void 0&&(this.hours=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,this.setVal(s.val)}else if((typeof t=="string"||t===null)&&i===void 0&&e===void 0){let s=arguments[0];{let a=arguments,r=!1;this.hours===void 0&&(this.hours=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,s=oe.StringUtil.replace(s,",",".");let f=[0,0,0],o=s.split(":").join("@").split(" ").join("@").split("@@").join("@").split("@"),d=0;for(;d<3&&d<o.length;)f[d]=parseFloat(o[d]),d+=1;if(d>=2)this.set(f[0],f[1]|0,f[2]);else if(d===1)!r&&s.indexOf(".")!==-1?this.setVal(f[0]/15):this.setVal(f[0]);else throw Object.defineProperty(new Error("Expected a string of the form hh:mm:ss.sss, but got: '"+s+"'"),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}this.hours===void 0&&(this.hours=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1}else if((typeof t=="number"||t===null)&&i===void 0&&e===void 0){let s=arguments[0];this.hours===void 0&&(this.hours=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1,this.setVal(s)}else if(t===void 0&&i===void 0&&e===void 0){let n=arguments;this.hours===void 0&&(this.hours=0),this.min===void 0&&(this.min=0),this.sec===void 0&&(this.sec=0),this.val===void 0&&(this.val=0),this.sign=1,this.initialized=!1}else throw new Error("invalid overload")}set(t,i,e){this.hours=t|0,this.min=i,this.sec=e,this.val=(e/60+i)/60,t<0||t===tt.MINUS_ZERO?(this.val=t-this.val,this.hours=-this.hours,this.sign=-1):(this.val=this.hours+this.val,this.sign=1),this.initialized=!0}setVal(t){this.val=t;let i=t;i<0||i===tt.MINUS_ZERO?(this.sign=-1,i=-i):this.sign=1;let e=i+1e-10;this.hours=e|0;let n=(e-this.hours)*60;this.min=n|0,this.sec=(n-this.min)*60,this.initialized=!0}toString$(){let t=tt.fmt_sec(this.sec),i;return this.sign===-1?i="-":i="",i+tt.fmt_hr_min(this.hours)+":"+tt.fmt_hr_min(this.min)+":"+t}toString$boolean(t){if(t)return this.toString$();let i;return this.sign===-1?i="-":i=" ",i+tt.fmt_hr_min(this.hours)+":"+tt.fmt_hr_min(this.min)}toString(t){if(typeof t=="boolean"||t===null)return this.toString$boolean(t);if(t===void 0)return this.toString$();throw new Error("invalid overload")}isInitialized(){return this.initialized}getHours(){return this.hours}getMin(){return this.min}getSec(){return this.sec}getVal(){return this.val}getSign(){return this.sign}equals(t){return t!=null&&t instanceof tt&&this.val===t.val}};Vt.HMS=tt;tt.MINUS_ZERO=-0;tt.__class="coordtxl.coords.HMS"});var ue=B(Lt=>{"use strict";Object.defineProperty(Lt,"__esModule",{value:!0});Lt.WorldCoords=void 0;var he=ot(),Z=class{constructor(t,i,e,n,s,a,r){if((typeof t=="number"||t===null)&&(typeof i=="number"||i===null)&&(typeof e=="number"||e===null)&&(typeof n=="number"||n===null)&&(typeof s=="number"||s===null)&&(typeof a=="number"||a===null)&&(typeof r=="number"||r===null)){let f=arguments;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new F.HMS(t,i,e),this.dec=new U.DMS(n,s,a),this.init(r)}else if((typeof t=="number"||t===null)&&(typeof i=="number"||i===null)&&(typeof e=="number"||e===null)&&(typeof n=="number"||n===null)&&(typeof s=="number"||s===null)&&(typeof a=="number"||a===null)&&r===void 0){let f=arguments;{let o=arguments,d=2e3;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new F.HMS(t,i,e),this.dec=new U.DMS(n,s,a),this.init(d)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if((typeof t=="string"||t===null)&&(typeof i=="string"||i===null)&&(typeof e=="number"||e===null)&&(typeof n=="boolean"||n===null)&&s===void 0&&a===void 0&&r===void 0){let f=arguments,o=f[0],d=f[1],u=f[2],h=f[3];this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new F.HMS(o,h),this.dec=new U.DMS(d),this.init(u)}else if((t!=null&&t instanceof F.HMS||t===null)&&(i!=null&&i instanceof U.DMS||i===null)&&(typeof e=="number"||e===null)&&n===void 0&&s===void 0&&a===void 0&&r===void 0){let f=arguments,o=f[0],d=f[1],u=f[2];this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=o,this.dec=d,this.init(u)}else if((typeof t=="number"||t===null)&&(typeof i=="number"||i===null)&&(typeof e=="number"||e===null)&&n===void 0&&s===void 0&&a===void 0&&r===void 0){let f=arguments,o=f[0],d=f[1],u=f[2];this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new F.HMS(o/15),this.dec=new U.DMS(d),this.init(u)}else if((typeof t=="string"||t===null)&&(typeof i=="string"||i===null)&&(typeof e=="number"||e===null)&&n===void 0&&s===void 0&&a===void 0&&r===void 0){let f=arguments,o=f[0],d=f[1],u=f[2];this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new F.HMS(o),this.dec=new U.DMS(d),this.init(u)}else if((typeof t=="string"||t===null)&&(typeof i=="string"||i===null)&&(typeof e=="boolean"||e===null)&&n===void 0&&s===void 0&&a===void 0&&r===void 0){let f=arguments,o=f[0],d=f[1],u=f[2];{let h=arguments,c=2e3;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new F.HMS(o,u),this.dec=new U.DMS(d),this.init(c)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if((typeof t=="number"||t===null)&&(typeof i=="number"||i===null)&&(typeof e=="number"||e===null)&&n===void 0&&s===void 0&&a===void 0&&r===void 0){let f=arguments,o=f[0],d=f[1],u=f[2];this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new F.HMS(o/15),this.dec=new U.DMS(d),this.init(u)}else if((t!=null&&t instanceof F.HMS||t===null)&&(i!=null&&i instanceof U.DMS||i===null)&&e===void 0&&n===void 0&&s===void 0&&a===void 0&&r===void 0){let f=arguments,o=f[0],d=f[1];{let u=arguments,h=2e3;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=o,this.dec=d,this.init(h)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if((typeof t=="number"||t===null)&&(typeof i=="number"||i===null)&&e===void 0&&n===void 0&&s===void 0&&a===void 0&&r===void 0){let f=arguments,o=f[0],d=f[1];{let u=arguments,h=u[0],c=u[1],l=2e3;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new F.HMS(h/15),this.dec=new U.DMS(c),this.init(l)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if((typeof t=="string"||t===null)&&(typeof i=="string"||i===null)&&e===void 0&&n===void 0&&s===void 0&&a===void 0&&r===void 0){let f=arguments,o=f[0],d=f[1];{let u=arguments,h=2e3;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new F.HMS(o),this.dec=new U.DMS(d),this.init(h)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if((t!=null&&t instanceof he.Point2D||t===null)&&(typeof i=="number"||i===null)&&e===void 0&&n===void 0&&s===void 0&&a===void 0&&r===void 0){let f=arguments,o=f[0],d=f[1];{let u=arguments,h=o.getX(),c=o.getY();this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new F.HMS(h/15),this.dec=new U.DMS(c),this.init(d)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if((typeof t=="number"||t===null)&&(typeof i=="number"||i===null)&&e===void 0&&n===void 0&&s===void 0&&a===void 0&&r===void 0){let f=arguments,o=f[0],d=f[1];{let u=arguments,h=2e3;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new F.HMS(o/15),this.dec=new U.DMS(d),this.init(h)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if((t!=null&&t instanceof he.Point2D||t===null)&&i===void 0&&e===void 0&&n===void 0&&s===void 0&&a===void 0&&r===void 0){let o=arguments[0];{let d=arguments,u=o.getX(),h=o.getY(),c=2e3;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new F.HMS(u/15),this.dec=new U.DMS(h),this.init(c)}this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null)}else if(t===void 0&&i===void 0&&e===void 0&&n===void 0&&s===void 0&&a===void 0&&r===void 0){let f=arguments;this.ra===void 0&&(this.ra=null),this.dec===void 0&&(this.dec=null),this.ra=new F.HMS,this.dec=new U.DMS}else throw new Error("invalid overload")}getRA(){return this.ra}getDec(){return this.dec}getRaDeg(){return this.ra.getVal()*15}getDecDeg(){return this.dec.getVal()}getX(){return this.ra.getVal()*15}getY(){return this.dec.getVal()}toString(){return this.ra.toString$()+", "+this.dec.toString$()+" J2000"}format$double(t){let i=[null,null];if(t===2e3)i[0]=this.ra.toString$(),i[1]=this.dec.toString$();else{let e=new Z(this.ra,this.dec);e.convertEquinox(2e3,t),i[0]=e.ra.toString$(),i[1]=e.dec.toString$()}return i}format(t){if(typeof t=="number"||t===null)return this.format$double(t);if(t===void 0)return this.format$();throw new Error("invalid overload")}format$(){return this.format$double(2e3)}getRaDec(t){let i=[0,0];if(t===2e3)i[0]=this.getRaDeg(),i[1]=this.getDecDeg();else{let e=new Z(this.ra,this.dec);e.convertEquinox(2e3,t),i[0]=e.getRaDeg(),i[1]=e.getDecDeg()}return i}static dispos(t,i,e,n){let s=[0,0],a,r,f,o,d,u,h,c,l,p,M,x,y,C,v=180/Math.PI;a=e/v,r=t/v,f=n/v,o=i/v,h=Math.sin(o),u=Math.sin(f),l=Math.cos(o),c=Math.cos(f),p=Math.cos(a-r),M=h*u+l*c*p;let D=Math.acos(M);return d=0,D>4e-7&&(x=Math.sin(D),C=(u*l-c*h*p)/x,Math.abs(C)>1&&(C=C/Math.abs(C)),y=c*Math.sin(a-r)/x,d=Math.acos(C)*v,y<0&&(d=360-d)),D*=v,D*=60,i===90&&(d=180),i===-90&&(d=0),s[0]=D,s[1]=d,s}dispos(t){return Z.dispos(this.getRaDeg(),this.getDecDeg(),t.getRaDeg(),t.getDecDeg())}static wcsdist(t,i,e,n){let s,a,r,f,o,d,u,h=[0,0,0],c=[0,0,0],l,p=Math.PI/180;for(s=t*p,r=i*p,u=Math.cos(r),h[0]=Math.cos(s)*u,h[1]=Math.sin(s)*u,h[2]=Math.sin(r),a=e*p,f=n*p,u=Math.cos(f),c[0]=Math.cos(a)*u,c[1]=Math.sin(a)*u,c[2]=Math.sin(f),o=0,l=0;l<3;l++)o=o+(h[l]-c[l])*(h[l]-c[l]);return o=o/4,o>1&&(o=1),d=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)),d*180/Math.PI}dist$coordtxl_coords_WorldCoords(t){return Z.dispos(this.getRaDeg(),this.getDecDeg(),t.getRaDeg(),t.getDecDeg())[0]}dist(t){if(t!=null&&t instanceof Z||t===null)return this.dist$coordtxl_coords_WorldCoords(t);if(t!=null&&t.constructor!=null&&t.constructor.__interfaces!=null&&t.constructor.__interfaces.indexOf("coordtxl.coords.Coordinates")>=0||t===null)return this.dist$coordtxl_coords_Coordinates(t);throw new Error("invalid overload")}dist$coordtxl_coords_Coordinates(t){return this.dist$coordtxl_coords_WorldCoords(t)}static dist(t,i,e,n){return Z.dispos(t,i,e,n)[0]}box(t){let i=[null,null],e=this.ra.getVal(),n=this.dec.getVal();t/=60;let s=Math.sqrt(2*t*t),a,r,f,o,d;return f=n-s/2,f<=-90?(f=-90,o=n+s/2,a=0,r=24):(o=n+s/2,o>=90?(f=n-s/2,o=90,a=0,r=24):(n>0?d=Math.abs(Math.cos(f*Math.PI/180)):d=Math.abs(Math.cos(o*Math.PI/180)),a=e-s/15/2/d,r=e+s/15/2/d,a<0&&(a+=24),r>24&&(r-=24))),i[0]=new Z(a*15,f),i[1]=new Z(r*15,o),i}center(t,i){let e=[0,0,0,0,0],n=t.getRaDeg(),s=t.getDecDeg(),a=i.getRaDeg(),r=i.getDecDeg();return e[0]=(n+a)/2,e[1]=(s+r)/2,e[2]=Z.wcsdist(n,s,a,s)*60,e[3]=Z.wcsdist(n,s,n,r)*60,e[4]=Z.wcsdist(n,s,a,r)*60/2,e}getCoordinateSystemName(){return"wcs"}init(t){this.checkRange(),this.convertEquinox(t,2e3)}convertEquinox(t,i){if(t===i)return;let e=[0,0],n=[0,0];e[0]=this.ra.getVal()*15,e[1]=this.dec.getVal(),Te.JPrec.prej_q(e,n,t,i),this.ra=new F.HMS(n[0]/15),this.dec=new U.DMS(n[1])}checkRange(){let t=this.ra.getVal(),i=this.dec.getVal();t<-.001||t>=25,i<-90||i>90}};Lt.WorldCoords=Z;Z.__class="coordtxl.coords.WorldCoords";Z.__interfaces=["coordtxl.coords.WorldCoordinates","coordtxl.coords.Coordinates"];var Te=le(),U=fe(),F=de()});var ce=B(rt=>{"use strict";Object.defineProperty(rt,"__esModule",{value:!0});rt.WorldCoords=rt.WCSTransform=rt.MapKeywordProvider=rt.Point2D=void 0;var Oe=ot();Object.defineProperty(rt,"Point2D",{enumerable:!0,get:function(){return Oe.Point2D}});var Ve=Bt();Object.defineProperty(rt,"MapKeywordProvider",{enumerable:!0,get:function(){return Ve.MapKeywordProvider}});var Le=Ct();Object.defineProperty(rt,"WCSTransform",{enumerable:!0,get:function(){return Le.WCSTransform}});var We=ue();Object.defineProperty(rt,"WorldCoords",{enumerable:!0,get:function(){return We.WorldCoords}})});function Ft(_){if(typeof _._casagui_id_=="undefined"){let t=null;if(typeof window=="undefined"){if(typeof crypto!="undefined"){let n=crypto.randomBytes(8);t=new Uint32Array(n.buffer.slice(-4))}}else t=new Uint32Array(1),window.crypto.getRandomValues(t);let i=new Date,e=Math.floor(i.getTime()/1e3);_._casagui_id_=`${t?t[0]:e}-${e}`}return _._casagui_id_}function Zt(){this.timeout=1e3,this.retries=20,this.connected=!0,this.backoff=()=>{this.connected=!1,this.timeout+=Math.floor(Ut(1.8,22-this.retries)),this.retries-=1}}var Fe=Ee(ce());var zt=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function Rt(_,t,i,e){_.addEventListener?_.addEventListener(t,i,e):_.attachEvent&&_.attachEvent("on".concat(t),function(){i(window.event)})}function xe(_,t){for(var i=t.slice(0,t.length-1),e=0;e<i.length;e++)i[e]=_[i[e].toLowerCase()];return i}function me(_){typeof _!="string"&&(_=""),_=_.replace(/\s/g,"");for(var t=_.split(","),i=t.lastIndexOf("");i>=0;)t[i-1]+=",",t.splice(i,1),i=t.lastIndexOf("");return t}function we(_,t){for(var i=_.length>=t.length?_:t,e=_.length>=t.length?t:_,n=!0,s=0;s<i.length;s++)e.indexOf(i[s])===-1&&(n=!1);return n}var gt={backspace:8,"\u232B":8,tab:9,clear:12,enter:13,"\u21A9":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"\u21EA":20,",":188,".":190,"/":191,"`":192,"-":zt?173:189,"=":zt?61:187,";":zt?59:186,"'":222,"[":219,"]":221,"\\":220},lt={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,cmd:91,command:91},Yt={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},k={16:!1,18:!1,17:!1,91:!1},R={};for(ct=1;ct<20;ct++)gt["f".concat(ct)]=111+ct;var ct,N=[],ge=!1,be="all",Me=[],wt=function(t){return gt[t.toLowerCase()]||lt[t.toLowerCase()]||t.toUpperCase().charCodeAt(0)},qe=function(t){return Object.keys(gt).find(function(i){return gt[i]===t})},Ne=function(t){return Object.keys(lt).find(function(i){return lt[i]===t})};function ve(_){be=_||"all"}function _t(){return be||"all"}function Ke(){return N.slice(0)}function Xe(){return N.map(function(_){return qe(_)||Ne(_)||String.fromCharCode(_)})}function ze(_){var t=_.target||_.srcElement,i=t.tagName,e=!0;return(t.isContentEditable||(i==="INPUT"||i==="TEXTAREA"||i==="SELECT")&&!t.readOnly)&&(e=!1),e}function Re(_){return typeof _=="string"&&(_=wt(_)),N.indexOf(_)!==-1}function He(_,t){var i,e;_||(_=_t());for(var n in R)if(Object.prototype.hasOwnProperty.call(R,n))for(i=R[n],e=0;e<i.length;)i[e].scope===_?i.splice(e,1):e++;_t()===_&&ve(t||"all")}function ke(_){var t=_.keyCode||_.which||_.charCode,i=N.indexOf(t);if(i>=0&&N.splice(i,1),_.key&&_.key.toLowerCase()==="meta"&&N.splice(0,N.length),(t===93||t===224)&&(t=91),t in k){k[t]=!1;for(var e in lt)lt[e]===t&&(ft[e]=!1)}}function Ye(_){if(typeof _>"u")Object.keys(R).forEach(function(a){return delete R[a]});else if(Array.isArray(_))_.forEach(function(a){a.key&&Ht(a)});else if(typeof _=="object")_.key&&Ht(_);else if(typeof _=="string"){for(var t=arguments.length,i=new Array(t>1?t-1:0),e=1;e<t;e++)i[e-1]=arguments[e];var n=i[0],s=i[1];typeof n=="function"&&(s=n,n=""),Ht({key:_,scope:n,method:s,splitKey:"+"})}}var Ht=function(t){var i=t.key,e=t.scope,n=t.method,s=t.splitKey,a=s===void 0?"+":s,r=me(i);r.forEach(function(f){var o=f.split(a),d=o.length,u=o[d-1],h=u==="*"?"*":wt(u);if(!!R[h]){e||(e=_t());var c=d>1?xe(lt,o):[];R[h]=R[h].filter(function(l){var p=n?l.method===n:!0;return!(p&&l.scope===e&&we(l.mods,c))})}})};function _e(_,t,i,e){if(t.element===e){var n;if(t.scope===i||t.scope==="all"){n=t.mods.length>0;for(var s in k)Object.prototype.hasOwnProperty.call(k,s)&&(!k[s]&&t.mods.indexOf(+s)>-1||k[s]&&t.mods.indexOf(+s)===-1)&&(n=!1);(t.mods.length===0&&!k[16]&&!k[18]&&!k[17]&&!k[91]||n||t.shortcut==="*")&&t.method(_,t)===!1&&(_.preventDefault?_.preventDefault():_.returnValue=!1,_.stopPropagation&&_.stopPropagation(),_.cancelBubble&&(_.cancelBubble=!0))}}}function pe(_,t){var i=R["*"],e=_.keyCode||_.which||_.charCode;if(!!ft.filter.call(this,_)){if((e===93||e===224)&&(e=91),N.indexOf(e)===-1&&e!==229&&N.push(e),["ctrlKey","altKey","shiftKey","metaKey"].forEach(function(l){var p=Yt[l];_[l]&&N.indexOf(p)===-1?N.push(p):!_[l]&&N.indexOf(p)>-1?N.splice(N.indexOf(p),1):l==="metaKey"&&_[l]&&N.length===3&&(_.ctrlKey||_.shiftKey||_.altKey||(N=N.slice(N.indexOf(p))))}),e in k){k[e]=!0;for(var n in lt)lt[n]===e&&(ft[n]=!0);if(!i)return}for(var s in k)Object.prototype.hasOwnProperty.call(k,s)&&(k[s]=_[Yt[s]]);_.getModifierState&&!(_.altKey&&!_.ctrlKey)&&_.getModifierState("AltGraph")&&(N.indexOf(17)===-1&&N.push(17),N.indexOf(18)===-1&&N.push(18),k[17]=!0,k[18]=!0);var a=_t();if(i)for(var r=0;r<i.length;r++)i[r].scope===a&&(_.type==="keydown"&&i[r].keydown||_.type==="keyup"&&i[r].keyup)&&_e(_,i[r],a,t);if(e in R){for(var f=0;f<R[e].length;f++)if((_.type==="keydown"&&R[e][f].keydown||_.type==="keyup"&&R[e][f].keyup)&&R[e][f].key){for(var o=R[e][f],d=o.splitKey,u=o.key.split(d),h=[],c=0;c<u.length;c++)h.push(wt(u[c]));h.sort().join("")===N.sort().join("")&&_e(_,o,a,t)}}}}function Ge(_){return Me.indexOf(_)>-1}function ft(_,t,i){N=[];var e=me(_),n=[],s="all",a=document,r=0,f=!1,o=!0,d="+",u=!1;for(i===void 0&&typeof t=="function"&&(i=t),Object.prototype.toString.call(t)==="[object Object]"&&(t.scope&&(s=t.scope),t.element&&(a=t.element),t.keyup&&(f=t.keyup),t.keydown!==void 0&&(o=t.keydown),t.capture!==void 0&&(u=t.capture),typeof t.splitKey=="string"&&(d=t.splitKey)),typeof t=="string"&&(s=t);r<e.length;r++)_=e[r].split(d),n=[],_.length>1&&(n=xe(lt,_)),_=_[_.length-1],_=_==="*"?"*":wt(_),_ in R||(R[_]=[]),R[_].push({keyup:f,keydown:o,scope:s,mods:n,shortcut:e[r],method:i,key:e[r],splitKey:d,element:a});typeof a<"u"&&!Ge(a)&&window&&(Me.push(a),Rt(a,"keydown",function(h){pe(h,a)},u),ge||(ge=!0,Rt(window,"focus",function(){N=[]},u)),Rt(a,"keyup",function(h){pe(h,a),ke(h)},u))}function Ue(_){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(R).forEach(function(i){var e=R[i].filter(function(n){return n.scope===t&&n.shortcut===_});e.forEach(function(n){n&&n.method&&n.method()})})}var kt={getPressedKeyString:Xe,setScope:ve,getScope:_t,deleteScope:He,getPressedKeyCodes:Ke,isPressed:Re,filter:ze,trigger:Ue,unbind:Ye,keyMap:gt,modifier:lt,modifierMap:Yt};for(Wt in kt)Object.prototype.hasOwnProperty.call(kt,Wt)&&(ft[Wt]=kt[Wt]);var Wt;typeof window<"u"&&(ye=window.hotkeys,ft.noConflict=function(_){return _&&window.hotkeys===ft&&(window.hotkeys=ye),ft},window.hotkeys=ft);var ye;window.object_id=Ft;window.ReconnectState=Zt;window.coordtxl=Fe;})();
